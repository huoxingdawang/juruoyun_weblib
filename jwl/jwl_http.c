/* Generated by re2c 1.3 on Fri Aug 14 22:50:47 2020 */
#line 1 "jwl/jwl_http.l"
/* Copyright (c) [2019] juruoyun developer team
   Juruoyun web lib is licensed under the Mulan PSL v1.
   You can use this software according to the terms and conditions of the Mulan PSL v1.
   You may obtain a copy of Mulan PSL v1 at:
      http://license.coscl.org.cn/MulanPSL
   THIS SOFTWARE IS PROVIDED ON AN "AS IS" BASIS, WITHOUT WARRANTIES OF ANY KIND, EITHER EXPRESS OR
   IMPLIED, INCLUDING BUT NOT LIMITED TO NON-INFRINGEMENT, MERCHANTABILITY OR FIT FOR A PARTICULAR
   PURPOSE.
   See the Mulan PSL v1 for more details.*/
#include "jwl_http.h"
#if JWL_HTTP_ENABLE==1
jwl_http_head *jwl_http_head_new()
{
	return jwl_http_head_init(jbl_malloc(sizeof(jwl_http_head)));
}
jwl_http_head *jwl_http_head_init(jwl_http_head * this)
{
	if(!this)jbl_exception("NULL POINTER");		
	jbl_gc_init(this);
	jbl_gc_plus(this);
	jwl_http_head_set_response(this);
	this->status		=0;
	this->charset		=0;	

	this->method		=0;
	this->protocol		=0;
	this->connection	=0;
	
	this->cache			=0;
	this->cache_max_age	=0;	
	this->range.start	=0;	
	this->range.end		=0;	
	this->etag			=NULL;

	this->cond			=0;	
//jbl_string
	this->content_type	=NULL;
	this->filename		=NULL;

	this->url			=NULL;
	this->host			=NULL;
	this->ua			=NULL;
	this->referer		=NULL;
//jbl_ht
	this->cookie		=NULL;
	this->v				=NULL;	
	return this;
}
jwl_http_head *jwl_http_head_free(jwl_http_head * this)
{
	if(!this)return NULL;
	jbl_gc_minus(this);
	if(!jbl_gc_refcnt(this))
	{
		if(jbl_gc_is_ref(this))
			jwl_http_head_free((jwl_http_head*)(((jbl_reference*)this)->ptr));
		else
		{
			this->etag			=jbl_string_free(this->etag);
			
			this->content_type	=jbl_string_free(this->content_type);
			this->filename		=jbl_string_free(this->filename);
			
			this->url			=jbl_string_free(this->url);
			this->host			=jbl_string_free(this->host);
			this->ua			=jbl_string_free(this->ua);
			this->referer		=jbl_string_free(this->referer);
			
			this->v				=jbl_ht_free	(this->v);
			this->cookie		=jbl_ht_free	(this->v);
		}
		if(jbl_gc_is_var(this))//因为该功能依赖jbl_ht,jbl_ht强制依赖var所以不用宏判断
			jbl_free((char*)this-sizeof(jbl_var));
		else
			jbl_free(this);
	}
	return NULL;	
	
}
inline jwl_http_head *jwl_http_head_copy(jwl_http_head * this)
{
	jbl_gc_plus(this);
	return this;
}
inline jwl_http_head *jwl_http_head_extend(jwl_http_head * this,jwl_http_head **pthi)
{
	if(!this){this=jwl_http_head_new();if(pthi)*pthi=this;return this;}
	jbl_reference *ref=NULL;jwl_http_head *thi=jbl_refer_pull_keep_father(this,&ref);
	if(jbl_gc_is_pvar(thi))
	{
		jwl_http_head *ttt=((jbl_reference*)thi)->ptr;
		if(jbl_gc_refcnt(thi)==1)
			((jbl_reference*)thi)->ptr=NULL,
		jwl_http_head_free(thi);
		thi=ttt;
	}	
	if((jbl_gc_refcnt(thi)<=1)){if(pthi)*pthi=thi;return this;}

	jwl_http_head * tmp	=jwl_http_head_new();
	
	tmp->status			=this->status;
	tmp->charset		=this->charset;
	
	tmp->method			=this->method;
	tmp->protocol		=this->protocol;
	tmp->connection		=this->connection;
	
	tmp->cache			=this->cache;
	tmp->cache_max_age	=this->cache_max_age;
	tmp->range.start	=this->range.start;
	tmp->range.end		=this->range.end;
	tmp->etag			=jbl_string_copy(this->etag);
	
	
	tmp->content_type	=jbl_string_copy(this->content_type);
	tmp->filename		=jbl_string_copy(this->filename);
	
	
	tmp->url			=jbl_string_copy(this->url);
	tmp->host			=jbl_string_copy(this->host);
	tmp->ua				=jbl_string_copy(this->ua);
	tmp->referer		=jbl_string_copy(this->referer);
	
	tmp->cookie			=jbl_ht_copy(this->cookie);
	tmp->v				=jbl_ht_copy(this->v);
	
	jwl_http_head_free(this);
	if(ref)		ref->ptr=tmp;
	else		this=tmp;
	if(pthi)	*pthi=tmp;	
	return this;
}
jwl_http_head * jwl_http_head_set_status			(jwl_http_head * this,jbl_uint16 status)				{jwl_http_head *thi;this=jwl_http_head_extend(this,&thi);thi->status		=status			;return this;}
jwl_http_head * jwl_http_head_set_connection		(jwl_http_head * this,jbl_uint16 connection)			{jwl_http_head *thi;this=jwl_http_head_extend(this,&thi);thi->connection	=connection		;return this;}
jwl_http_head * jwl_http_head_set_cache				(jwl_http_head * this,jbl_uint16 cache)					{jwl_http_head *thi;this=jwl_http_head_extend(this,&thi);thi->cache			=cache  		;return this;}
jwl_http_head * jwl_http_head_set_charset			(jwl_http_head * this,jbl_uint16 charset)				{jwl_http_head *thi;this=jwl_http_head_extend(this,&thi);thi->charset		=charset  		;return this;}
jwl_http_head * jwl_http_head_set_cache_max_age		(jwl_http_head * this,jbl_uint32 cache_max_age)			{jwl_http_head *thi;this=jwl_http_head_extend(this,&thi);thi->cache_max_age	=cache_max_age	;return this;}
jwl_http_head * jwl_http_head_set_content_type		(jwl_http_head * this,jbl_string * content_type)		{jwl_http_head *thi;this=jwl_http_head_extend(this,&thi);jbl_string_free(thi->content_type)	;thi->content_type	=jbl_string_copy(content_type)	;return this;}
jwl_http_head * jwl_http_head_set_etag				(jwl_http_head * this,jbl_string * etag)				{jwl_http_head *thi;this=jwl_http_head_extend(this,&thi);jbl_string_free(thi->etag)			;thi->etag			=jbl_string_copy(etag)			;return this;}
jwl_http_head *	jwl_http_head_set_range				(jwl_http_head * this,jbl_uint64 start,jbl_uint64 end)	{jwl_http_head *thi;this=jwl_http_head_extend(this,&thi);thi->range.start=start;thi->range.end=end;return this;}
jwl_http_head * jwl_http_head_set_filename			(jwl_http_head * this,jbl_string * filename)			{jwl_http_head *thi;this=jwl_http_head_extend(this,&thi);jbl_string_free(thi->filename)		;thi->filename		=jbl_string_copy(filename)		;return this;}
//jwl_http_head * jwl_http_head_set					(jwl_http_head * this,jbl_string * k, jbl_var *v);



void jwl_http_head_encode(jbl_stream *stream,jwl_http_head *head,jbl_string_size_type size)
{
#define rn() jbl_stream_push_char(stream,'\r'),jbl_stream_push_char(stream,'\n')
	if(!head)return;
	head=jbl_refer_pull(head);
	jbl_stream_push_chars(stream,UC"HTTP/1.1 ");
	jbl_stream_push_uint(stream,head->status);
	switch(head->status)
	{
		case 200:	jbl_stream_push_chars(stream,UC" OK")				;break;
		case 206:	jbl_stream_push_chars(stream,UC" Partial Content")	;break;
		case 304:	jbl_stream_push_chars(stream,UC" Not Modified")		;break;
		case 404:	jbl_stream_push_chars(stream,UC" Not Found")		;break;
		case 416:	jbl_stream_push_chars(stream,UC" Range Not Satisfiable")		;break;
	}
	rn();
	jbl_stream_push_chars(stream,UC"Server: "JWL_HTTP_RESPONSE_SERVER_NAME)															,rn();
	if(head->status==206)
	{
		jbl_stream_push_chars(stream,UC"Content-Length: ")					,jbl_stream_push_uint(stream,(head->range.end?head->range.end:size)-head->range.start)	,rn();
		//注意，range是闭区间，而jwl,jbl要求左闭右开区间
		jbl_stream_push_chars(stream,UC"Content-Range: bytes ")				,jbl_stream_push_uint(stream,head->range.start)			,jbl_stream_push_char(stream,'-')	,jbl_stream_push_uint(stream,head->range.end?(head->range.end-1):0)	,jbl_stream_push_char(stream,'/')	,jbl_stream_push_uint(stream,size)	,rn();
	}
	else
		jbl_stream_push_chars(stream,UC"Content-Length: ")					,jbl_stream_push_uint(stream,size)						,rn();
	jbl_stream_push_chars(stream,UC"Accept-Ranges: bytes")																			,rn();
	if(head->cache==JWL_HTTP_CACHE_MAX_AGE)
	{
		jbl_stream_push_chars(stream,UC"Cache-Control: max-age=")	,jbl_stream_push_uint(stream,head->cache_max_age)				,rn();
		jbl_time * t=jbl_time_add_second(jbl_time_now(NULL),head->cache_max_age);
//		jbl_stream_push_chars(stream,UC"Date: ")	,jbl_time_to_string_format(t,stream,UC JBL_TIME_FORMAT_RFC1123)					,rn();
//		jbl_stream_push_chars(stream,UC"Expires: ")	,jbl_time_to_string_format(t,stream,UC JBL_TIME_FORMAT_RFC1123)					,rn();
		t=jbl_time_free(t);
	}
	else
	{
		jbl_stream_push_chars(stream,UC"Pragma: no-cache")																			,rn();
		jbl_stream_push_chars(stream,UC"Cache-Control: no-cache")																	,rn();
	}
	if(head->content_type)
	{
		jbl_stream_push_chars(stream,UC"Content-Type: ")					,jbl_stream_push_string(stream,head->content_type);
		char *charset[]={"","UTF-8"};
		if(head->charset)
			jbl_stream_push_chars(stream,UC"; charset=")					,jbl_stream_push_chars(stream,UC charset[head->charset]);
		rn();
	}
	if(head->connection)
	{
		char * connection[]={"","keep-alive","close","upgrade"};
		jbl_stream_push_chars(stream,UC"Connection: ")						,jbl_stream_push_chars(stream,UC connection[head->connection])	,rn();
//		jbl_stream_push_chars(stream,UC"Keep-Alive: timeout=5, max=1000"),rn();
	}
	if(head->etag)
		jbl_stream_push_chars(stream,UC"ETag: ")							,jbl_stream_push_string(stream,head->etag)				,rn();
	if(head->filename)
	{
		jbl_stream_push_chars(stream,UC"Content-Disposition: attachment; filename=\"");
		jbl_stream_push_string(stream,head->filename);
		jbl_stream_push_char(stream,'"');
		rn();
	}
	if(head->v)
		jbl_ht_foreach(head->v,i)
		{
			jbl_stream_push_string(stream,jbl_htk(i));
			jbl_stream_push_chars(stream,UC": ");
//			jbl_string_add_var(&stream,jbl_htv(i));
			rn();
		}
	
	
	
//	jbl_stream_push_chars(stream,UC"Keep-Alive: timeout=4");rn();
//	jbl_stream_push_chars(stream,UC"Proxy-Connection: keep-alive");rn();
	
	rn();
#undef rn
}
#line 228 "jwl/jwl_http.c"
enum jwl_http_scanner_condition {
	jwl_http_scanner_condition_0,
	jwl_http_scanner_condition_method,
	jwl_http_scanner_condition_url,
	jwl_http_scanner_condition_protocol,
	jwl_http_scanner_condition_head_body,
	jwl_http_scanner_condition_head_host,
	jwl_http_scanner_condition_head_ua,
	jwl_http_scanner_condition_head_refer,
	jwl_http_scanner_condition_head_etag,
	jwl_http_scanner_condition_head_conn,
	jwl_http_scanner_condition_head_range_s,
	jwl_http_scanner_condition_head_range_e,
	jwl_http_scanner_condition_head_accept,
	jwl_http_scanner_condition_head_acen,
	jwl_http_scanner_condition_head_aclan,
	jwl_http_scanner_condition_head_cookie,
	jwl_http_scanner_condition_head_checcon,
};
#line 225 "jwl/jwl_http.l"


jwl_http_head* jwl_http_head_decode(jbl_string *buf,jbl_string_size_type *start)
{	
	if(!buf)return NULL;
	buf=jbl_refer_pull(buf);
	if(!buf->len)return NULL;
	jwl_http_head * head=jwl_http_head_new();
	jwl_http_head_set_request(head);
	unsigned char *		YYMARKER;
	unsigned char *		YYCURSOR=buf->s+(start?(*start):0);
	#define YYCTYPE		unsigned char

#line 262 "jwl/jwl_http.c"
{
	YYCTYPE yych;
	switch (head->cond) {
	case jwl_http_scanner_condition_0: goto yyc_0;
	case jwl_http_scanner_condition_method: goto yyc_method;
	case jwl_http_scanner_condition_url: goto yyc_url;
	case jwl_http_scanner_condition_protocol: goto yyc_protocol;
	case jwl_http_scanner_condition_head_body: goto yyc_head_body;
	case jwl_http_scanner_condition_head_host: goto yyc_head_host;
	case jwl_http_scanner_condition_head_ua: goto yyc_head_ua;
	case jwl_http_scanner_condition_head_refer: goto yyc_head_refer;
	case jwl_http_scanner_condition_head_etag: goto yyc_head_etag;
	case jwl_http_scanner_condition_head_conn: goto yyc_head_conn;
	case jwl_http_scanner_condition_head_range_s: goto yyc_head_range_s;
	case jwl_http_scanner_condition_head_range_e: goto yyc_head_range_e;
	case jwl_http_scanner_condition_head_accept: goto yyc_head_accept;
	case jwl_http_scanner_condition_head_acen: goto yyc_head_acen;
	case jwl_http_scanner_condition_head_aclan: goto yyc_head_aclan;
	case jwl_http_scanner_condition_head_cookie: goto yyc_head_cookie;
	case jwl_http_scanner_condition_head_checcon: goto yyc_head_checcon;
	}
/* *********************************** */
yyc_0:
	head->cond = (jwl_http_scanner_condition_method);
	goto yyc_method;
/* *********************************** */
yyc_method:
	yych = *YYCURSOR;
	switch (yych) {
	case ' ':	goto yy7;
	case 'G':	goto yy9;
	case 'P':	goto yy10;
	default:	goto yy6;
	}
yy6:
yy7:
	++YYCURSOR;
	head->cond = (jwl_http_scanner_condition_url);
#line 248 "jwl/jwl_http.l"
	{head->url				=jbl_string_free    (head->url)									;goto yyc_url;}
#line 303 "jwl/jwl_http.c"
yy9:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'E':	goto yy11;
	default:	goto yy6;
	}
yy10:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'O':	goto yy12;
	default:	goto yy6;
	}
yy11:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'T':	goto yy13;
	default:	goto yy6;
	}
yy12:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'S':	goto yy15;
	default:	goto yy6;
	}
yy13:
	++YYCURSOR;
#line 247 "jwl/jwl_http.l"
	{head->method=JWL_HTTP_METHOD_GET														;goto yyc_method;}
#line 332 "jwl/jwl_http.c"
yy15:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'T':	goto yy16;
	default:	goto yy6;
	}
yy16:
	++YYCURSOR;
#line 246 "jwl/jwl_http.l"
	{head->method=JWL_HTTP_METHOD_POST														;goto yyc_method;}
#line 343 "jwl/jwl_http.c"
/* *********************************** */
yyc_url:
	yych = *YYCURSOR;
	switch (yych) {
	case ' ':	goto yy21;
	default:	goto yy20;
	}
yy20:
#line 250 "jwl/jwl_http.l"
	{head->url				=jbl_string_add_char(head->url,*YYCURSOR)						;++YYCURSOR;goto yyc_url;}
#line 354 "jwl/jwl_http.c"
yy21:
	++YYCURSOR;
	head->cond = (jwl_http_scanner_condition_protocol);
#line 251 "jwl/jwl_http.l"
	{																						;goto yyc_protocol;}
#line 360 "jwl/jwl_http.c"
/* *********************************** */
yyc_protocol:
	yych = *YYCURSOR;
	switch (yych) {
	case '\r':	goto yy26;
	case 'H':	goto yy27;
	default:	goto yy25;
	}
yy25:
yy26:
	yych = *++YYCURSOR;
	switch (yych) {
	case '\n':	goto yy28;
	default:	goto yy25;
	}
yy27:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'T':	goto yy30;
	default:	goto yy25;
	}
yy28:
	++YYCURSOR;
	head->cond = (jwl_http_scanner_condition_head_body);
#line 254 "jwl/jwl_http.l"
	{																						;goto yyc_head_body;}
#line 387 "jwl/jwl_http.c"
yy30:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'T':	goto yy31;
	default:	goto yy25;
	}
yy31:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'P':	goto yy32;
	default:	goto yy25;
	}
yy32:
	yych = *++YYCURSOR;
	switch (yych) {
	case '/':	goto yy33;
	default:	goto yy25;
	}
yy33:
	yych = *++YYCURSOR;
	switch (yych) {
	case '1':	goto yy34;
	default:	goto yy25;
	}
yy34:
	yych = *++YYCURSOR;
	switch (yych) {
	case '.':	goto yy35;
	default:	goto yy25;
	}
yy35:
	yych = *++YYCURSOR;
	switch (yych) {
	case '1':	goto yy36;
	default:	goto yy25;
	}
yy36:
	++YYCURSOR;
#line 253 "jwl/jwl_http.l"
	{head->protocol			=JWL_HTTP_PROTOCOL_HTTP_1_1										;goto yyc_protocol;}
#line 428 "jwl/jwl_http.c"
/* *********************************** */
yyc_head_body:
	yych = *(YYMARKER = YYCURSOR);
	switch (yych) {
	case 0x00:	goto yy41;
	case '\r':	goto yy43;
	case 'A':	goto yy45;
	case 'C':	goto yy46;
	case 'E':	goto yy47;
	case 'H':	goto yy48;
	case 'I':	goto yy49;
	case 'R':	goto yy50;
	case 'U':	goto yy51;
	default:	goto yy40;
	}
yy40:
#line 309 "jwl/jwl_http.l"
	{																						;++YYCURSOR;goto yyc_head_body;}
#line 447 "jwl/jwl_http.c"
yy41:
	++YYCURSOR;
#line 311 "jwl/jwl_http.l"
	{if(start)*start=YYCURSOR-buf->s;return head;}
#line 452 "jwl/jwl_http.c"
yy43:
	yych = *++YYCURSOR;
	switch (yych) {
	case '\n':	goto yy52;
	default:	goto yy44;
	}
yy44:
	YYCURSOR = YYMARKER;
	goto yy40;
yy45:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'c':	goto yy53;
	default:	goto yy44;
	}
yy46:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'a':	goto yy54;
	case 'o':	goto yy55;
	default:	goto yy44;
	}
yy47:
	yych = *++YYCURSOR;
	switch (yych) {
	case 't':	goto yy56;
	default:	goto yy44;
	}
yy48:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'o':	goto yy57;
	default:	goto yy44;
	}
yy49:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'f':	goto yy58;
	default:	goto yy44;
	}
yy50:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'a':	goto yy59;
	case 'e':	goto yy60;
	default:	goto yy44;
	}
yy51:
	yych = *++YYCURSOR;
	switch (yych) {
	case 's':	goto yy61;
	default:	goto yy44;
	}
yy52:
	yych = *++YYCURSOR;
	switch (yych) {
	case '\r':	goto yy62;
	default:	goto yy44;
	}
yy53:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'c':	goto yy63;
	default:	goto yy44;
	}
yy54:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'c':	goto yy64;
	default:	goto yy44;
	}
yy55:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'n':	goto yy65;
	case 'o':	goto yy66;
	default:	goto yy44;
	}
yy56:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'a':	goto yy67;
	default:	goto yy44;
	}
yy57:
	yych = *++YYCURSOR;
	switch (yych) {
	case 's':	goto yy68;
	default:	goto yy44;
	}
yy58:
	yych = *++YYCURSOR;
	switch (yych) {
	case '-':	goto yy69;
	default:	goto yy44;
	}
yy59:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'n':	goto yy70;
	default:	goto yy44;
	}
yy60:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'f':	goto yy71;
	default:	goto yy44;
	}
yy61:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'e':	goto yy72;
	default:	goto yy44;
	}
yy62:
	yych = *++YYCURSOR;
	switch (yych) {
	case '\n':	goto yy73;
	default:	goto yy44;
	}
yy63:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'e':	goto yy75;
	default:	goto yy44;
	}
yy64:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'h':	goto yy76;
	default:	goto yy44;
	}
yy65:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'n':	goto yy77;
	default:	goto yy44;
	}
yy66:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'k':	goto yy78;
	default:	goto yy44;
	}
yy67:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'g':	goto yy79;
	default:	goto yy44;
	}
yy68:
	yych = *++YYCURSOR;
	switch (yych) {
	case 't':	goto yy80;
	default:	goto yy44;
	}
yy69:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'N':	goto yy81;
	default:	goto yy44;
	}
yy70:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'g':	goto yy82;
	default:	goto yy44;
	}
yy71:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'e':	goto yy83;
	default:	goto yy44;
	}
yy72:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'r':	goto yy84;
	default:	goto yy44;
	}
yy73:
	++YYCURSOR;
#line 310 "jwl/jwl_http.l"
	{if(start)*start=YYCURSOR-buf->s;return head;}
#line 637 "jwl/jwl_http.c"
yy75:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'p':	goto yy85;
	default:	goto yy44;
	}
yy76:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'e':	goto yy86;
	default:	goto yy44;
	}
yy77:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'e':	goto yy87;
	default:	goto yy44;
	}
yy78:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'i':	goto yy88;
	default:	goto yy44;
	}
yy79:
	yych = *++YYCURSOR;
	switch (yych) {
	case ':':	goto yy89;
	default:	goto yy44;
	}
yy80:
	yych = *++YYCURSOR;
	switch (yych) {
	case ':':	goto yy90;
	default:	goto yy44;
	}
yy81:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'o':	goto yy91;
	default:	goto yy44;
	}
yy82:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'e':	goto yy92;
	default:	goto yy44;
	}
yy83:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'r':	goto yy93;
	default:	goto yy44;
	}
yy84:
	yych = *++YYCURSOR;
	switch (yych) {
	case '-':	goto yy94;
	default:	goto yy44;
	}
yy85:
	yych = *++YYCURSOR;
	switch (yych) {
	case 't':	goto yy95;
	default:	goto yy44;
	}
yy86:
	yych = *++YYCURSOR;
	switch (yych) {
	case '-':	goto yy96;
	default:	goto yy44;
	}
yy87:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'c':	goto yy97;
	default:	goto yy44;
	}
yy88:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'e':	goto yy98;
	default:	goto yy44;
	}
yy89:
	yych = *++YYCURSOR;
	switch (yych) {
	case ' ':	goto yy99;
	default:	goto yy44;
	}
yy90:
	yych = *++YYCURSOR;
	switch (yych) {
	case ' ':	goto yy101;
	default:	goto yy44;
	}
yy91:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'n':	goto yy103;
	default:	goto yy44;
	}
yy92:
	yych = *++YYCURSOR;
	switch (yych) {
	case ':':	goto yy104;
	default:	goto yy44;
	}
yy93:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'e':	goto yy105;
	default:	goto yy44;
	}
yy94:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'A':	goto yy106;
	default:	goto yy44;
	}
yy95:
	yych = *++YYCURSOR;
	switch (yych) {
	case '-':	goto yy107;
	case ':':	goto yy108;
	default:	goto yy44;
	}
yy96:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'C':	goto yy109;
	default:	goto yy44;
	}
yy97:
	yych = *++YYCURSOR;
	switch (yych) {
	case 't':	goto yy110;
	default:	goto yy44;
	}
yy98:
	yych = *++YYCURSOR;
	switch (yych) {
	case ':':	goto yy111;
	default:	goto yy44;
	}
yy99:
	++YYCURSOR;
	head->cond = (jwl_http_scanner_condition_head_etag);
#line 268 "jwl/jwl_http.l"
	{head->etag				=jbl_string_free    (head->etag)								;goto yyc_head_etag;}
#line 788 "jwl/jwl_http.c"
yy101:
	++YYCURSOR;
	head->cond = (jwl_http_scanner_condition_head_host);
#line 256 "jwl/jwl_http.l"
	{head->host				=jbl_string_free    (head->host)								;goto yyc_head_host;}
#line 794 "jwl/jwl_http.c"
yy103:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'e':	goto yy112;
	default:	goto yy44;
	}
yy104:
	yych = *++YYCURSOR;
	switch (yych) {
	case ' ':	goto yy113;
	default:	goto yy44;
	}
yy105:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'r':	goto yy114;
	default:	goto yy44;
	}
yy106:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'g':	goto yy115;
	default:	goto yy44;
	}
yy107:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'E':	goto yy116;
	case 'L':	goto yy117;
	default:	goto yy44;
	}
yy108:
	yych = *++YYCURSOR;
	switch (yych) {
	case ' ':	goto yy118;
	default:	goto yy44;
	}
yy109:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'o':	goto yy120;
	default:	goto yy44;
	}
yy110:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'i':	goto yy121;
	default:	goto yy44;
	}
yy111:
	yych = *++YYCURSOR;
	switch (yych) {
	case ' ':	goto yy122;
	default:	goto yy44;
	}
yy112:
	yych = *++YYCURSOR;
	switch (yych) {
	case '-':	goto yy124;
	default:	goto yy44;
	}
yy113:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'b':	goto yy125;
	default:	goto yy44;
	}
yy114:
	yych = *++YYCURSOR;
	switch (yych) {
	case ':':	goto yy126;
	default:	goto yy44;
	}
yy115:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'e':	goto yy127;
	default:	goto yy44;
	}
yy116:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'n':	goto yy128;
	default:	goto yy44;
	}
yy117:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'a':	goto yy129;
	default:	goto yy44;
	}
yy118:
	++YYCURSOR;
	head->cond = (jwl_http_scanner_condition_head_accept);
#line 285 "jwl/jwl_http.l"
	{																						;goto yyc_head_accept;}
#line 891 "jwl/jwl_http.c"
yy120:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'n':	goto yy130;
	default:	goto yy44;
	}
yy121:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'o':	goto yy131;
	default:	goto yy44;
	}
yy122:
	++YYCURSOR;
	head->cond = (jwl_http_scanner_condition_head_cookie);
#line 297 "jwl/jwl_http.l"
	{																						;goto yyc_head_cookie;}
#line 909 "jwl/jwl_http.c"
yy124:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'M':	goto yy132;
	default:	goto yy44;
	}
yy125:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'y':	goto yy133;
	default:	goto yy44;
	}
yy126:
	yych = *++YYCURSOR;
	switch (yych) {
	case ' ':	goto yy134;
	default:	goto yy44;
	}
yy127:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'n':	goto yy136;
	default:	goto yy44;
	}
yy128:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'c':	goto yy137;
	default:	goto yy44;
	}
yy129:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'n':	goto yy138;
	default:	goto yy44;
	}
yy130:
	yych = *++YYCURSOR;
	switch (yych) {
	case 't':	goto yy139;
	default:	goto yy44;
	}
yy131:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'n':	goto yy140;
	default:	goto yy44;
	}
yy132:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'a':	goto yy141;
	default:	goto yy44;
	}
yy133:
	yych = *++YYCURSOR;
	switch (yych) {
	case 't':	goto yy142;
	default:	goto yy44;
	}
yy134:
	++YYCURSOR;
	head->cond = (jwl_http_scanner_condition_head_refer);
#line 264 "jwl/jwl_http.l"
	{head->referer			=jbl_string_free    (head->referer)								;goto yyc_head_refer;}
#line 975 "jwl/jwl_http.c"
yy136:
	yych = *++YYCURSOR;
	switch (yych) {
	case 't':	goto yy143;
	default:	goto yy44;
	}
yy137:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'o':	goto yy144;
	default:	goto yy44;
	}
yy138:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'g':	goto yy145;
	default:	goto yy44;
	}
yy139:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'r':	goto yy146;
	default:	goto yy44;
	}
yy140:
	yych = *++YYCURSOR;
	switch (yych) {
	case ':':	goto yy147;
	default:	goto yy44;
	}
yy141:
	yych = *++YYCURSOR;
	switch (yych) {
	case 't':	goto yy148;
	default:	goto yy44;
	}
yy142:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'e':	goto yy149;
	default:	goto yy44;
	}
yy143:
	yych = *++YYCURSOR;
	switch (yych) {
	case ':':	goto yy150;
	default:	goto yy44;
	}
yy144:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'd':	goto yy151;
	default:	goto yy44;
	}
yy145:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'u':	goto yy152;
	default:	goto yy44;
	}
yy146:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'o':	goto yy153;
	default:	goto yy44;
	}
yy147:
	yych = *++YYCURSOR;
	switch (yych) {
	case ' ':	goto yy154;
	default:	goto yy44;
	}
yy148:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'c':	goto yy156;
	default:	goto yy44;
	}
yy149:
	yych = *++YYCURSOR;
	switch (yych) {
	case 's':	goto yy157;
	default:	goto yy44;
	}
yy150:
	yych = *++YYCURSOR;
	switch (yych) {
	case ' ':	goto yy158;
	default:	goto yy44;
	}
yy151:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'i':	goto yy160;
	default:	goto yy44;
	}
yy152:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'a':	goto yy161;
	default:	goto yy44;
	}
yy153:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'l':	goto yy162;
	default:	goto yy44;
	}
yy154:
	++YYCURSOR;
	head->cond = (jwl_http_scanner_condition_head_conn);
#line 273 "jwl/jwl_http.l"
	{																						;goto yyc_head_conn;}
#line 1089 "jwl/jwl_http.c"
yy156:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'h':	goto yy163;
	default:	goto yy44;
	}
yy157:
	yych = *++YYCURSOR;
	switch (yych) {
	case '=':	goto yy164;
	default:	goto yy44;
	}
yy158:
	++YYCURSOR;
	head->cond = (jwl_http_scanner_condition_head_ua);
#line 260 "jwl/jwl_http.l"
	{head->ua				=jbl_string_free    (head->ua)									;goto yyc_head_ua;}
#line 1107 "jwl/jwl_http.c"
yy160:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'n':	goto yy166;
	default:	goto yy44;
	}
yy161:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'g':	goto yy167;
	default:	goto yy44;
	}
yy162:
	yych = *++YYCURSOR;
	switch (yych) {
	case ':':	goto yy168;
	default:	goto yy44;
	}
yy163:
	yych = *++YYCURSOR;
	switch (yych) {
	case ':':	goto yy169;
	default:	goto yy44;
	}
yy164:
	++YYCURSOR;
	head->cond = (jwl_http_scanner_condition_head_range_s);
#line 278 "jwl/jwl_http.l"
	{head->range.start		=0																;goto yyc_head_range_s;}
#line 1137 "jwl/jwl_http.c"
yy166:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'g':	goto yy170;
	default:	goto yy44;
	}
yy167:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'e':	goto yy171;
	default:	goto yy44;
	}
yy168:
	yych = *++YYCURSOR;
	switch (yych) {
	case ' ':	goto yy172;
	default:	goto yy44;
	}
yy169:
	yych = *++YYCURSOR;
	switch (yych) {
	case ' ':	goto yy174;
	default:	goto yy44;
	}
yy170:
	yych = *++YYCURSOR;
	switch (yych) {
	case ':':	goto yy176;
	default:	goto yy44;
	}
yy171:
	yych = *++YYCURSOR;
	switch (yych) {
	case ':':	goto yy177;
	default:	goto yy44;
	}
yy172:
	++YYCURSOR;
	head->cond = (jwl_http_scanner_condition_head_checcon);
#line 301 "jwl/jwl_http.l"
	{																						;goto yyc_head_checcon;}
#line 1179 "jwl/jwl_http.c"
yy174:
	++YYCURSOR;
	head->cond = (jwl_http_scanner_condition_head_etag);
#line 269 "jwl/jwl_http.l"
	{head->etag				=jbl_string_free    (head->etag)								;goto yyc_head_etag;}
#line 1185 "jwl/jwl_http.c"
yy176:
	yych = *++YYCURSOR;
	switch (yych) {
	case ' ':	goto yy178;
	default:	goto yy44;
	}
yy177:
	yych = *++YYCURSOR;
	switch (yych) {
	case ' ':	goto yy180;
	default:	goto yy44;
	}
yy178:
	++YYCURSOR;
	head->cond = (jwl_http_scanner_condition_head_acen);
#line 289 "jwl/jwl_http.l"
	{																						;goto yyc_head_acen;}
#line 1203 "jwl/jwl_http.c"
yy180:
	++YYCURSOR;
	head->cond = (jwl_http_scanner_condition_head_aclan);
#line 293 "jwl/jwl_http.l"
	{																						;goto yyc_head_aclan;}
#line 1209 "jwl/jwl_http.c"
/* *********************************** */
yyc_head_host:
	yych = *(YYMARKER = YYCURSOR);
	switch (yych) {
	case '\r':	goto yy185;
	default:	goto yy184;
	}
yy184:
#line 257 "jwl/jwl_http.l"
	{head->host				=jbl_string_add_char(head->host,*YYCURSOR)						;++YYCURSOR;goto yyc_head_host;}
#line 1220 "jwl/jwl_http.c"
yy185:
	yych = *++YYCURSOR;
	switch (yych) {
	case '\n':	goto yy187;
	default:	goto yy186;
	}
yy186:
	YYCURSOR = YYMARKER;
	goto yy184;
yy187:
	++YYCURSOR;
	head->cond = (jwl_http_scanner_condition_head_body);
#line 258 "jwl/jwl_http.l"
	{																						;goto yyc_head_body;}
#line 1235 "jwl/jwl_http.c"
/* *********************************** */
yyc_head_ua:
	yych = *(YYMARKER = YYCURSOR);
	switch (yych) {
	case '\r':	goto yy192;
	default:	goto yy191;
	}
yy191:
#line 261 "jwl/jwl_http.l"
	{head->ua				=jbl_string_add_char(head->ua,*YYCURSOR)						;++YYCURSOR;goto yyc_head_ua;}
#line 1246 "jwl/jwl_http.c"
yy192:
	yych = *++YYCURSOR;
	switch (yych) {
	case '\n':	goto yy194;
	default:	goto yy193;
	}
yy193:
	YYCURSOR = YYMARKER;
	goto yy191;
yy194:
	++YYCURSOR;
	head->cond = (jwl_http_scanner_condition_head_body);
#line 262 "jwl/jwl_http.l"
	{																						;goto yyc_head_body;}
#line 1261 "jwl/jwl_http.c"
/* *********************************** */
yyc_head_refer:
	yych = *(YYMARKER = YYCURSOR);
	switch (yych) {
	case '\r':	goto yy199;
	default:	goto yy198;
	}
yy198:
#line 265 "jwl/jwl_http.l"
	{head->referer			=jbl_string_add_char(head->referer,*YYCURSOR)					;++YYCURSOR;goto yyc_head_refer;}
#line 1272 "jwl/jwl_http.c"
yy199:
	yych = *++YYCURSOR;
	switch (yych) {
	case '\n':	goto yy201;
	default:	goto yy200;
	}
yy200:
	YYCURSOR = YYMARKER;
	goto yy198;
yy201:
	++YYCURSOR;
	head->cond = (jwl_http_scanner_condition_head_body);
#line 266 "jwl/jwl_http.l"
	{																						;goto yyc_head_body;}
#line 1287 "jwl/jwl_http.c"
/* *********************************** */
yyc_head_etag:
	yych = *(YYMARKER = YYCURSOR);
	switch (yych) {
	case '\r':	goto yy206;
	default:	goto yy205;
	}
yy205:
#line 270 "jwl/jwl_http.l"
	{head->etag				=jbl_string_add_char(head->etag,*YYCURSOR)						;++YYCURSOR;goto yyc_head_etag;}
#line 1298 "jwl/jwl_http.c"
yy206:
	yych = *++YYCURSOR;
	switch (yych) {
	case '\n':	goto yy208;
	default:	goto yy207;
	}
yy207:
	YYCURSOR = YYMARKER;
	goto yy205;
yy208:
	++YYCURSOR;
	head->cond = (jwl_http_scanner_condition_head_body);
#line 271 "jwl/jwl_http.l"
	{																						;goto yyc_head_body;}
#line 1313 "jwl/jwl_http.c"
/* *********************************** */
yyc_head_conn:
	yych = *YYCURSOR;
	switch (yych) {
	case '\r':	goto yy213;
	case 'c':	goto yy214;
	case 'k':	goto yy215;
	default:	goto yy212;
	}
yy212:
yy213:
	yych = *++YYCURSOR;
	switch (yych) {
	case '\n':	goto yy216;
	default:	goto yy212;
	}
yy214:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'l':	goto yy218;
	default:	goto yy212;
	}
yy215:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'e':	goto yy219;
	default:	goto yy212;
	}
yy216:
	++YYCURSOR;
	head->cond = (jwl_http_scanner_condition_head_body);
#line 276 "jwl/jwl_http.l"
	{																						;goto yyc_head_body;}
#line 1347 "jwl/jwl_http.c"
yy218:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'o':	goto yy220;
	default:	goto yy212;
	}
yy219:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'e':	goto yy221;
	default:	goto yy212;
	}
yy220:
	yych = *++YYCURSOR;
	switch (yych) {
	case 's':	goto yy222;
	default:	goto yy212;
	}
yy221:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'p':	goto yy223;
	default:	goto yy212;
	}
yy222:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'e':	goto yy224;
	default:	goto yy212;
	}
yy223:
	yych = *++YYCURSOR;
	switch (yych) {
	case '-':	goto yy226;
	default:	goto yy212;
	}
yy224:
	++YYCURSOR;
#line 275 "jwl/jwl_http.l"
	{head->connection		=JWL_HTTP_CONNECTION_CLOSE										;goto yyc_head_conn;}
#line 1388 "jwl/jwl_http.c"
yy226:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'a':	goto yy227;
	default:	goto yy212;
	}
yy227:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'l':	goto yy228;
	default:	goto yy212;
	}
yy228:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'i':	goto yy229;
	default:	goto yy212;
	}
yy229:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'v':	goto yy230;
	default:	goto yy212;
	}
yy230:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'e':	goto yy231;
	default:	goto yy212;
	}
yy231:
	++YYCURSOR;
#line 274 "jwl/jwl_http.l"
	{head->connection		=JWL_HTTP_CONNECTION_KEEP_ALIVE									;goto yyc_head_conn;}
#line 1423 "jwl/jwl_http.c"
/* *********************************** */
yyc_head_range_s:
	yych = *YYCURSOR;
	switch (yych) {
	case '\r':	goto yy236;
	case '-':	goto yy237;
	case '0':
	case '1':
	case '2':
	case '3':
	case '4':
	case '5':
	case '6':
	case '7':
	case '8':
	case '9':	goto yy239;
	default:	goto yy235;
	}
yy235:
yy236:
	yych = *++YYCURSOR;
	switch (yych) {
	case '\n':	goto yy241;
	default:	goto yy235;
	}
yy237:
	++YYCURSOR;
	head->cond = (jwl_http_scanner_condition_head_range_e);
#line 279 "jwl/jwl_http.l"
	{head->range.end		=0																;goto yyc_head_range_e;}
#line 1454 "jwl/jwl_http.c"
yy239:
	++YYCURSOR;
#line 280 "jwl/jwl_http.l"
	{head->range.start		=(head->range.start<<3)+(head->range.start<<1)+*(YYCURSOR-1)-'0';goto yyc_head_range_s;}
#line 1459 "jwl/jwl_http.c"
yy241:
	++YYCURSOR;
	head->cond = (jwl_http_scanner_condition_head_body);
#line 281 "jwl/jwl_http.l"
	{																						;goto yyc_head_body;}
#line 1465 "jwl/jwl_http.c"
/* *********************************** */
yyc_head_range_e:
	yych = *YYCURSOR;
	switch (yych) {
	case '\r':	goto yy246;
	case '0':
	case '1':
	case '2':
	case '3':
	case '4':
	case '5':
	case '6':
	case '7':
	case '8':
	case '9':	goto yy247;
	default:	goto yy245;
	}
yy245:
yy246:
	yych = *++YYCURSOR;
	switch (yych) {
	case '\n':	goto yy249;
	default:	goto yy245;
	}
yy247:
	++YYCURSOR;
#line 282 "jwl/jwl_http.l"
	{head->range.end		=(head->range.end<<3)+(head->range.end<<1)+*(YYCURSOR-1)-'0'	;goto yyc_head_range_e;}
#line 1494 "jwl/jwl_http.c"
yy249:
	++YYCURSOR;
	head->cond = (jwl_http_scanner_condition_head_body);
#line 283 "jwl/jwl_http.l"
	{head->range.end		=(head->range.end)?(head->range.end+1):0						;goto yyc_head_body;}
#line 1500 "jwl/jwl_http.c"
/* *********************************** */
yyc_head_accept:
	yych = *(YYMARKER = YYCURSOR);
	switch (yych) {
	case '\r':	goto yy254;
	default:	goto yy253;
	}
yy253:
#line 286 "jwl/jwl_http.l"
	{																						;++YYCURSOR;goto yyc_head_accept;}
#line 1511 "jwl/jwl_http.c"
yy254:
	yych = *++YYCURSOR;
	switch (yych) {
	case '\n':	goto yy256;
	default:	goto yy255;
	}
yy255:
	YYCURSOR = YYMARKER;
	goto yy253;
yy256:
	++YYCURSOR;
	head->cond = (jwl_http_scanner_condition_head_body);
#line 287 "jwl/jwl_http.l"
	{																						;goto yyc_head_body;}
#line 1526 "jwl/jwl_http.c"
/* *********************************** */
yyc_head_acen:
	yych = *(YYMARKER = YYCURSOR);
	switch (yych) {
	case '\r':	goto yy261;
	default:	goto yy260;
	}
yy260:
#line 290 "jwl/jwl_http.l"
	{																						;++YYCURSOR;goto yyc_head_acen;}
#line 1537 "jwl/jwl_http.c"
yy261:
	yych = *++YYCURSOR;
	switch (yych) {
	case '\n':	goto yy263;
	default:	goto yy262;
	}
yy262:
	YYCURSOR = YYMARKER;
	goto yy260;
yy263:
	++YYCURSOR;
	head->cond = (jwl_http_scanner_condition_head_body);
#line 291 "jwl/jwl_http.l"
	{																						;goto yyc_head_body;}
#line 1552 "jwl/jwl_http.c"
/* *********************************** */
yyc_head_aclan:
	yych = *(YYMARKER = YYCURSOR);
	switch (yych) {
	case '\r':	goto yy268;
	default:	goto yy267;
	}
yy267:
#line 294 "jwl/jwl_http.l"
	{																						;++YYCURSOR;goto yyc_head_aclan;}
#line 1563 "jwl/jwl_http.c"
yy268:
	yych = *++YYCURSOR;
	switch (yych) {
	case '\n':	goto yy270;
	default:	goto yy269;
	}
yy269:
	YYCURSOR = YYMARKER;
	goto yy267;
yy270:
	++YYCURSOR;
	head->cond = (jwl_http_scanner_condition_head_body);
#line 295 "jwl/jwl_http.l"
	{																						;goto yyc_head_body;}
#line 1578 "jwl/jwl_http.c"
/* *********************************** */
yyc_head_cookie:
	yych = *(YYMARKER = YYCURSOR);
	switch (yych) {
	case '\r':	goto yy275;
	default:	goto yy274;
	}
yy274:
#line 298 "jwl/jwl_http.l"
	{																						;++YYCURSOR;goto yyc_head_cookie;}
#line 1589 "jwl/jwl_http.c"
yy275:
	yych = *++YYCURSOR;
	switch (yych) {
	case '\n':	goto yy277;
	default:	goto yy276;
	}
yy276:
	YYCURSOR = YYMARKER;
	goto yy274;
yy277:
	++YYCURSOR;
	head->cond = (jwl_http_scanner_condition_head_body);
#line 299 "jwl/jwl_http.l"
	{																						;goto yyc_head_body;}
#line 1604 "jwl/jwl_http.c"
/* *********************************** */
yyc_head_checcon:
	yych = *(YYMARKER = YYCURSOR);
	switch (yych) {
	case '\r':	goto yy282;
	default:	goto yy281;
	}
yy281:
#line 302 "jwl/jwl_http.l"
	{																						;++YYCURSOR;goto yyc_head_checcon;}
#line 1615 "jwl/jwl_http.c"
yy282:
	yych = *++YYCURSOR;
	switch (yych) {
	case '\n':	goto yy284;
	default:	goto yy283;
	}
yy283:
	YYCURSOR = YYMARKER;
	goto yy281;
yy284:
	++YYCURSOR;
	head->cond = (jwl_http_scanner_condition_head_body);
#line 303 "jwl/jwl_http.l"
	{																						;goto yyc_head_body;}
#line 1630 "jwl/jwl_http.c"
}
#line 313 "jwl/jwl_http.l"

	#undef YYCTYPE	


	return head;
}


#if JBL_STREAM_ENABLE==1
jwl_http_head* jwl_http_head_view_put(jwl_http_head* this,jbl_stream *out,jbl_uint8 format,jbl_uint32 tabs,jbl_uint32 line,unsigned char * varname,unsigned char * func,unsigned char * file)
{
	jwl_http_head* thi;if(jbl_stream_view_put_format(thi=jbl_refer_pull(this),out,format,tabs,UC"jwl_http_head",line,varname,func,file)){jbl_stream_push_char(out,'\n');return this;}
	jbl_stream_push_char(out,'\n');
	++tabs;
	char * charset		[]={"unknow","UTF-8"};
	char * method		[]={"unknow","get","post"};
	char * protocol		[]={"unknow","HTTP/1.1"};
	char * connection	[]={"unknow","keep alive","close","upgrade"};
	char * cache		[]={"unknow","no","max age,"};
	char * type			[]={"response","request"};
	if(1)
		for(jbl_int32 j=0;j<tabs;jbl_stream_push_char(out,'\t'),++j);	jbl_stream_push_chars(out,UC"type         :");jbl_stream_push_chars(out,UC type			[jwl_http_head_is_request(this)?1:0])	;jbl_stream_push_char(out,'\n');
	if(jwl_http_head_is_response(this))
	{
		for(jbl_int32 j=0;j<tabs;jbl_stream_push_char(out,'\t'),++j);	jbl_stream_push_chars(out,UC"status       :");jbl_stream_push_uint(out,thi->status)								;jbl_stream_push_char(out,'\n');
		for(jbl_int32 j=0;j<tabs;jbl_stream_push_char(out,'\t'),++j);	jbl_stream_push_chars(out,UC"charset      :");jbl_stream_push_chars(out,UC charset		[thi->charset])			;jbl_stream_push_char(out,'\n');
	}
	if(jwl_http_head_is_request(this))
	{
		for(jbl_int32 j=0;j<tabs;jbl_stream_push_char(out,'\t'),++j);	jbl_stream_push_chars(out,UC"method       :");jbl_stream_push_chars(out,UC method		[thi->method])			;jbl_stream_push_char(out,'\n');	
		for(jbl_int32 j=0;j<tabs;jbl_stream_push_char(out,'\t'),++j);	jbl_stream_push_chars(out,UC"protocol     :");jbl_stream_push_chars(out,UC protocol		[thi->protocol])		;jbl_stream_push_char(out,'\n');	
	}
	if(1)
	{
		for(jbl_int32 j=0;j<tabs;jbl_stream_push_char(out,'\t'),++j);	jbl_stream_push_chars(out,UC"connection   :");jbl_stream_push_chars(out,UC connection	[thi->connection])		;jbl_stream_push_char(out,'\n');	
		for(jbl_int32 j=0;j<tabs;jbl_stream_push_char(out,'\t'),++j);	jbl_stream_push_chars(out,UC"cache        :");jbl_stream_push_chars(out,UC cache		[thi->cache])			;if(thi->cache==JWL_HTTP_CACHE_MAX_AGE){jbl_stream_push_uint(out,thi->cache_max_age);}	;jbl_stream_push_char(out,'\n');	
		for(jbl_int32 j=0;j<tabs;jbl_stream_push_char(out,'\t'),++j);	jbl_stream_push_chars(out,UC"range        :");jbl_stream_push_uint(out,thi->range.start)						;jbl_stream_push_char(out,'-' );	jbl_stream_push_uint(out,thi->range.end)			;jbl_stream_push_char(out,'\n');	
		for(jbl_int32 j=0;j<tabs;jbl_stream_push_char(out,'\t'),++j);	jbl_stream_push_chars(out,UC"etag         :");jbl_stream_push_string(out,thi->etag)								;jbl_stream_push_char(out,'\n');
	}
	if(jwl_http_head_is_response(this))
	{
		for(jbl_int32 j=0;j<tabs;jbl_stream_push_char(out,'\t'),++j);	jbl_stream_push_chars(out,UC"content type :");jbl_stream_push_string(out,thi->content_type)						;jbl_stream_push_char(out,'\n');
		for(jbl_int32 j=0;j<tabs;jbl_stream_push_char(out,'\t'),++j);	jbl_stream_push_chars(out,UC"filename     :");jbl_stream_push_string(out,thi->filename)							;jbl_stream_push_char(out,'\n');
	}
	if(jwl_http_head_is_request(this))
	{
		for(jbl_int32 j=0;j<tabs;jbl_stream_push_char(out,'\t'),++j);	jbl_stream_push_chars(out,UC"url          :");jbl_stream_push_string(out,thi->url)								;jbl_stream_push_char(out,'\n');	
		for(jbl_int32 j=0;j<tabs;jbl_stream_push_char(out,'\t'),++j);	jbl_stream_push_chars(out,UC"host         :");jbl_stream_push_string(out,thi->host)								;jbl_stream_push_char(out,'\n');	
		for(jbl_int32 j=0;j<tabs;jbl_stream_push_char(out,'\t'),++j);	jbl_stream_push_chars(out,UC"user agent   :");jbl_stream_push_string(out,thi->ua)								;jbl_stream_push_char(out,'\n');	
		for(jbl_int32 j=0;j<tabs;jbl_stream_push_char(out,'\t'),++j);	jbl_stream_push_chars(out,UC"referer      :");jbl_stream_push_string(out,thi->referer)							;jbl_stream_push_char(out,'\n');	
	}	
	if(thi->v)
		jbl_ht_foreach(thi->v,i)
		{
			for(jbl_int32 j=0;j<tabs;jbl_stream_push_char(out,'\t'),++j);//格式化的\t
			jbl_stream_push_char(out,'"'),jbl_stream_push_string(out,i->k),jbl_stream_push_char(out,'"');
			jbl_stream_push_char(out,':');
			jbl_var_view_put(i->v,out,0,tabs,0,NULL,NULL,NULL);
		}
	return this;
/*
	if(format){for(jbl_int32 i=0;i<tabs;jbl_stream_push_char(out,'\t'),++i);}
	jbl_stream_push_chars(out,UC"cache        :"),jbl_stream_push_uint(out,this->cache),jbl_stream_push_char(out,'\t');
	if(this->cache==JWL_HTTP_CACHE_MAX_AGE)
		jbl_stream_push_chars(out,UC"(max-age,"),jbl_stream_push_uint(out,this->cache_max_age),jbl_stream_push_chars(out,UC")\n");
	else
		jbl_stream_push_chars(out,UC"(no-cache)\n");
	jbl_stream_push_chars(out,UC"content type :"),jbl_stream_push_string(out,this->content_type),jbl_stream_push_char(out,'\n');
*/	
}
#endif




#endif
