/* Generated by re2c 1.3 on Tue Aug 25 22:04:26 2020 */
#line 1 "jwl/jwl_http.l"
/* Copyright (c) [2019] juruoyun developer team
   Juruoyun web lib is licensed under the Mulan PSL v1.
   You can use this software according to the terms and conditions of the Mulan PSL v1.
   You may obtain a copy of Mulan PSL v1 at:
      http://license.coscl.org.cn/MulanPSL
   THIS SOFTWARE IS PROVIDED ON AN "AS IS" BASIS, WITHOUT WARRANTIES OF ANY KIND, EITHER EXPRESS OR
   IMPLIED, INCLUDING BUT NOT LIMITED TO NON-INFRINGEMENT, MERCHANTABILITY OR FIT FOR A PARTICULAR
   PURPOSE.
   See the Mulan PSL v1 for more details.*/
#include "jwl_http.h"
#if JWL_HTTP_ENABLE==1
jwl_http_head *jwl_http_head_new()
{
	return jwl_http_head_init(jbl_malloc(sizeof(jwl_http_head)));
}
jwl_http_head *jwl_http_head_init(jwl_http_head * this)
{
	if(!this)jbl_exception("NULL POINTER");		
	jbl_gc_init(this);
	jbl_gc_plus(this);
	this->status		=0;
	this->charset		=0;	
	this->content_type	=0;
	
	this->method		=0;
	this->protocol		=0;
	this->len			=0;
	this->tren			=0;
	
	this->connection	=0;
	this->cache			=0;
	this->upgrade		=0;
	this->cache_max_age	=0;	
	this->range.start	=0;	
	this->range.end		=0;	
	this->etag			=NULL;

//jbl_string
	this->filename		=NULL;

	this->url			=NULL;
	this->host			=NULL;
	this->ua			=NULL;
	this->referer		=NULL;
//jbl_ht
	this->cookie		=NULL;
	this->v				=NULL;	
	this->parameter		=NULL;	

	this->cond			=0;	
	return this;
}
jwl_http_head *jwl_http_head_free(jwl_http_head * this)
{
	if(!this)return NULL;
	jbl_gc_minus(this);
	if(!jbl_gc_refcnt(this))
	{
		if(jbl_gc_is_ref(this))
			jwl_http_head_free((jwl_http_head*)(((jbl_reference*)this)->ptr));
		else
		{
			this->etag			=jbl_string_free(this->etag);
			
			this->filename		=jbl_string_free(this->filename);
			
			this->url			=jbl_string_free(this->url);
			this->host			=jbl_string_free(this->host);
			this->ua			=jbl_string_free(this->ua);
			this->referer		=jbl_string_free(this->referer);
			this->v				=jbl_ht_free	(this->v);
			this->cookie		=jbl_ht_free	(this->cookie);
			this->parameter		=jbl_ht_free	(this->parameter);
		}
		if(jbl_gc_is_var(this))//因为该功能依赖jbl_ht,jbl_ht强制依赖var所以不用宏判断
			jbl_free((char*)this-sizeof(jbl_var));
		else
			jbl_free(this);
	}
	return NULL;	
	
}
inline jwl_http_head *jwl_http_head_copy(jwl_http_head * this)
{
	jbl_gc_plus(this);
	return this;
}
inline jwl_http_head *jwl_http_head_extend(jwl_http_head * this,jwl_http_head **pthi)
{
	if(!this){this=jwl_http_head_new();if(pthi)*pthi=this;return this;}
	jbl_reference *ref=NULL;jwl_http_head *thi=jbl_refer_pull_keep_father(this,&ref);
	if(jbl_gc_is_pvar(thi))
	{
		jwl_http_head *ttt=((jbl_reference*)thi)->ptr;
		if(jbl_gc_refcnt(thi)==1)
			((jbl_reference*)thi)->ptr=NULL,
		jwl_http_head_free(thi);
		thi=ttt;
	}	
	if((jbl_gc_refcnt(thi)<=1)){if(pthi)*pthi=thi;return this;}

	jwl_http_head * tmp	=jwl_http_head_new();
	
	tmp->status			=this->status;
	tmp->charset		=this->charset;
	tmp->content_type	=this->content_type;
	
	tmp->method			=this->method;
	tmp->protocol		=this->protocol;
	tmp->connection		=this->connection;
	tmp->len			=this->len;
	tmp->tren			=this->tren;
	
	tmp->cache			=this->cache;
	tmp->upgrade		=this->upgrade;
	tmp->cache_max_age	=this->cache_max_age;
	tmp->range.start	=this->range.start;
	tmp->range.end		=this->range.end;
	tmp->etag			=jbl_string_copy(this->etag);
	
	
	tmp->filename		=jbl_string_copy(this->filename);
	
	
	tmp->url			=jbl_string_copy(this->url);
	tmp->host			=jbl_string_copy(this->host);
	tmp->ua				=jbl_string_copy(this->ua);
	tmp->referer		=jbl_string_copy(this->referer);
	
	tmp->cookie			=jbl_ht_copy(this->cookie);
	tmp->v				=jbl_ht_copy(this->v);
	tmp->parameter		=jbl_ht_copy(this->parameter);
	
	jwl_http_head_free(this);
	if(ref)		ref->ptr=tmp;
	else		this=tmp;
	if(pthi)	*pthi=tmp;	
	return this;
}
jwl_http_head *		jwl_http_head_set_status		(jwl_http_head * this,jbl_uint32			status)			{jwl_http_head *thi;this=jwl_http_head_extend(this,&thi);thi->status		=status			;return this;}
jwl_http_head *		jwl_http_head_set_charset		(jwl_http_head * this,jwl_http_charset		charset)		{jwl_http_head *thi;this=jwl_http_head_extend(this,&thi);thi->charset		=charset  		;return this;}
jwl_http_head *		jwl_http_head_set_content_type	(jwl_http_head * this,jbl_file_ct			content_type)	{jwl_http_head *thi;this=jwl_http_head_extend(this,&thi);thi->content_type	=content_type	;return this;}
jwl_http_head *		jwl_http_head_set_method		(jwl_http_head * this,jwl_http_method		method)			{jwl_http_head *thi;this=jwl_http_head_extend(this,&thi);thi->method		=method  		;return this;}
jwl_http_head *		jwl_http_head_set_protocol		(jwl_http_head * this,jwl_http_protocol		protocol)		{jwl_http_head *thi;this=jwl_http_head_extend(this,&thi);thi->protocol		=protocol  		;return this;}
jwl_http_head *		jwl_http_head_set_connection	(jwl_http_head * this,jwl_http_connection	connection)		{jwl_http_head *thi;this=jwl_http_head_extend(this,&thi);thi->connection	=connection		;return this;}
jwl_http_head *		jwl_http_head_set_cache			(jwl_http_head * this,jwl_http_cache		cache)			{jwl_http_head *thi;this=jwl_http_head_extend(this,&thi);thi->cache			=cache  		;return this;}
jwl_http_head *		jwl_http_head_set_upgrade		(jwl_http_head * this,jwl_http_upgrade		upgrade)		{jwl_http_head *thi;this=jwl_http_head_extend(this,&thi);thi->upgrade		=upgrade  		;return this;}
jwl_http_head *		jwl_http_head_set_tren			(jwl_http_head * this,jwl_http_tren			tren)			{jwl_http_head *thi;this=jwl_http_head_extend(this,&thi);thi->tren			=tren  			;return this;}
jwl_http_head *		jwl_http_head_set_length		(jwl_http_head * this,jbl_uint64			len)			{jwl_http_head *thi;this=jwl_http_head_extend(this,&thi);thi->len			=len			;return this;}
jwl_http_head *		jwl_http_head_set_cache_max_age	(jwl_http_head * this,jbl_uint32			cache_max_age)	{jwl_http_head *thi;this=jwl_http_head_extend(this,&thi);thi->cache_max_age	=cache_max_age	;return this;}
jwl_http_head *		jwl_http_head_set_range			(jwl_http_head * this,jwl_http_head_range	range)			{jwl_http_head *thi;this=jwl_http_head_extend(this,&thi);thi->range			=range			;return this;}
jwl_http_head *		jwl_http_head_set_etag			(jwl_http_head * this,jbl_string *	etag)					{jwl_http_head *thi;this=jwl_http_head_extend(this,&thi);jbl_string_free(thi->etag)			;thi->etag			=jbl_string_copy(etag)							;return this;}
jwl_http_head *		jwl_http_head_set_filename		(jwl_http_head * this,jbl_string * filename)				{jwl_http_head *thi;this=jwl_http_head_extend(this,&thi);jbl_string_free(thi->filename)		;thi->filename		=jbl_string_copy(filename)						;return this;}
jwl_http_head *		jwl_http_head_set_url			(jwl_http_head * this,jbl_string * url)						{jwl_http_head *thi;this=jwl_http_head_extend(this,&thi);jbl_string_free(thi->url)			;thi->url			=jbl_string_copy(url)							;return this;}
jwl_http_head *		jwl_http_head_set_host			(jwl_http_head * this,jbl_string * host)					{jwl_http_head *thi;this=jwl_http_head_extend(this,&thi);jbl_string_free(thi->host)			;thi->host			=jbl_string_copy(host)							;return this;}
jwl_http_head *		jwl_http_head_set_ua			(jwl_http_head * this,jbl_string * ua)						{jwl_http_head *thi;this=jwl_http_head_extend(this,&thi);jbl_string_free(thi->ua)			;thi->ua			=jbl_string_copy(ua)							;return this;}
jwl_http_head *		jwl_http_head_set_referer		(jwl_http_head * this,jbl_string * referer)					{jwl_http_head *thi;this=jwl_http_head_extend(this,&thi);jbl_string_free(thi->referer)		;thi->referer		=jbl_string_copy(referer)						;return this;}
jwl_http_head *		jwl_http_head_set				(jwl_http_head * this,unsigned char * key,jbl_var* var)		{jwl_http_head *thi;this=jwl_http_head_extend(this,&thi)									;thi->v				=jbl_ht_insert_chars(thi->v			,key,var)	;return this;}
jwl_http_head *		jwl_http_head_set_parameter		(jwl_http_head * this,unsigned char * key,jbl_var* var)		{jwl_http_head *thi;this=jwl_http_head_extend(this,&thi);									thi->parameter		=jbl_ht_insert_chars(thi->parameter	,key,var)	;return this;}
jwl_http_head *		jwl_http_head_set_cookie		(jwl_http_head * this,unsigned char * key,jbl_var* var)		{jwl_http_head *thi;this=jwl_http_head_extend(this,&thi);									thi->cookie			=jbl_ht_insert_chars(thi->cookie	,key,var)	;return this;}

jbl_uint32			jwl_http_head_get_status		(jwl_http_head * this){if(!this)return 0;this=jbl_refer_pull(this);return this->status;}
jwl_http_charset	jwl_http_head_get_charget		(jwl_http_head * this){if(!this)return 0;this=jbl_refer_pull(this);return this->charset;}
jbl_file_ct			jwl_http_head_get_content_type	(jwl_http_head * this){if(!this)return 0;this=jbl_refer_pull(this);return this->content_type;}
jwl_http_method		jwl_http_head_get_method		(jwl_http_head * this){if(!this)return 0;this=jbl_refer_pull(this);return this->method;}
jwl_http_protocol	jwl_http_head_get_protocol		(jwl_http_head * this){if(!this)return 0;this=jbl_refer_pull(this);return this->protocol;}
jwl_http_connection	jwl_http_head_get_connection	(jwl_http_head * this){if(!this)return 0;this=jbl_refer_pull(this);return this->connection;}
jwl_http_cache		jwl_http_head_get_cache			(jwl_http_head * this){if(!this)return 0;this=jbl_refer_pull(this);return this->cache;}
jwl_http_upgrade	jwl_http_head_get_upgrade		(jwl_http_head * this){if(!this)return 0;this=jbl_refer_pull(this);return this->upgrade;}
jwl_http_tren		jwl_http_head_get_tren			(jwl_http_head * this){if(!this)return 0;this=jbl_refer_pull(this);return this->tren;}
jbl_uint64			jwl_http_head_get_length		(jwl_http_head * this){if(!this)return 0;this=jbl_refer_pull(this);return this->len;}
jbl_uint32			jwl_http_head_get_cache_max_age	(jwl_http_head * this){if(!this)return 0;this=jbl_refer_pull(this);return this->cache_max_age;}
jwl_http_head_range	jwl_http_head_get_range			(jwl_http_head * this){if(!this)return (jwl_http_head_range){0,0};this=jbl_refer_pull(this);return this->range;}
jbl_string *		jwl_http_head_get_etag			(jwl_http_head * this){if(!this)return NULL;this=jbl_refer_pull(this);return jbl_string_copy(this->etag);}
jbl_string *		jwl_http_head_get_filename		(jwl_http_head * this){if(!this)return NULL;this=jbl_refer_pull(this);return jbl_string_copy(this->filename);}
jbl_string *		jwl_http_head_get_url			(jwl_http_head * this){if(!this)return NULL;this=jbl_refer_pull(this);return jbl_string_copy(this->url);}
jbl_string *		jwl_http_head_get_host			(jwl_http_head * this){if(!this)return NULL;this=jbl_refer_pull(this);return jbl_string_copy(this->host);}
jbl_string *		jwl_http_head_get_ua			(jwl_http_head * this){if(!this)return NULL;this=jbl_refer_pull(this);return jbl_string_copy(this->ua);}
jbl_string *		jwl_http_head_get_referer		(jwl_http_head * this){if(!this)return NULL;this=jbl_refer_pull(this);return jbl_string_copy(this->referer);}
jbl_var    *		jwl_http_head_get				(jwl_http_head * this,unsigned char * key){if(!this)return NULL;this=jbl_refer_pull(this);if(!this->v)			return NULL;return jbl_ht_get_chars(this->v,key);}
jbl_var    *		jwl_http_head_get_parameter		(jwl_http_head * this,unsigned char * key){if(!this)return NULL;this=jbl_refer_pull(this);if(!this->parameter)	return NULL;return jbl_ht_get_chars(this->parameter,key);}
jbl_var    *		jwl_http_head_get_cookie		(jwl_http_head * this,unsigned char * key){if(!this)return NULL;this=jbl_refer_pull(this);if(!this->cookie)		return NULL;return jbl_ht_get_chars(this->cookie,key);}





void jwl_http_head_encode(jwl_http_head *head,jbl_stream *stream)
{
#define rn() jbl_stream_push_char(stream,'\r'),jbl_stream_push_char(stream,'\n')
	if(!head)return;
	head=jbl_refer_pull(head);
	if(jwl_http_head_is_response(head))
	{
		jbl_stream_push_chars(stream,UC"HTTP/1.1 ");
		jbl_stream_push_uint(stream,head->status);
		switch(head->status)
		{
			case 101:	jbl_stream_push_chars(stream,UC" Switching Protocols")	;break;
			case 200:	jbl_stream_push_chars(stream,UC" OK")				;break;
			case 206:	jbl_stream_push_chars(stream,UC" Partial Content")	;break;
			case 304:	jbl_stream_push_chars(stream,UC" Not Modified")		;break;
			case 404:	jbl_stream_push_chars(stream,UC" Not Found")		;break;
			case 416:	jbl_stream_push_chars(stream,UC" Range Not Satisfiable")		;break;
		}
	}
	else
	{
		char * method		[]={"","GET ","POST "};
		char * protocol		[]={""," HTTP/1.1",""};
		jbl_stream_push_chars	(stream,UC method[head->method]);
		jbl_stream_push_string	(stream,head->url);
		if(head->parameter)
		{
			jbl_stream_push_char(stream,'?');
			jbl_uint8 f=0;
			jbl_ht_foreach(head->parameter,i)
			{
				if(f)jbl_stream_push_char(stream,'&');
				f=1;
				jbl_stream_push_string(stream,i->k);
				jbl_stream_push_char(stream,'=');
				if(Vis_jbl_string(i->v))jbl_stream_push_string(stream,jbl_Vstring(i->v));
				else					jbl_var_json_put(i->v,stream,0,0);
			}		
		}		
		jbl_stream_push_chars	(stream,UC protocol[head->protocol]);
	}
	rn();
	if(head->cache==JWL_HTTP_CACHE_MAX_AGE)
	{
		jbl_stream_push_chars(stream,UC"Cache-Control: max-age=")	,jbl_stream_push_uint(stream,head->cache_max_age)				,rn();
		jbl_time * t=jbl_time_add_second(jbl_time_now(NULL),head->cache_max_age);
//		jbl_stream_push_chars(stream,UC"Date: ")	,jbl_time_to_string_format(t,stream,UC JBL_TIME_FORMAT_RFC1123)					,rn();
//		jbl_stream_push_chars(stream,UC"Expires: ")	,jbl_time_to_string_format(t,stream,UC JBL_TIME_FORMAT_RFC1123)					,rn();
		t=jbl_time_free(t);
	}
	else
	{
		jbl_stream_push_chars(stream,UC"Pragma: no-cache")																			,rn();
		jbl_stream_push_chars(stream,UC"Cache-Control: no-cache")																	,rn();
	}
	if(head->connection)
	{
		char * connection[]={"","keep-alive","close","Upgrade"};
		jbl_uint8 f=0;
		jbl_stream_push_chars(stream,UC"Connection: ");
		if(head->connection&JWL_HTTP_CONNECTION_KEEP_ALIVE	){jbl_stream_push_chars(stream,UC connection[1]);f=1;}
		if(head->connection&JWL_HTTP_CONNECTION_CLOSE		){if(f)jbl_stream_push_chars(stream,UC", ");jbl_stream_push_chars(stream,UC connection[2]);f=1;}
		if(head->connection&JWL_HTTP_CONNECTION_UPGRADE		){if(f)jbl_stream_push_chars(stream,UC", ");jbl_stream_push_chars(stream,UC connection[3]);f=1;}
		rn();
	}
	if(head->etag&&jwl_http_head_is_response(head))
		jbl_stream_push_chars(stream,UC"ETag: ")							,jbl_stream_push_string(stream,head->etag)				,rn();
	if(head->etag&&jwl_http_head_is_request(head))
		jbl_stream_push_chars(stream,UC"If-None-Match: ")					,jbl_stream_push_string(stream,head->etag)				,rn();
	if(head->content_type)
	{
		jbl_stream_push_chars(stream,UC"Content-Type: ")					,jbl_stream_push_chars(stream,jbl_file_get_ct_chars_by_ctid(head->content_type));
		char *charset[]={"","UTF-8"};
		if(head->charset)
			jbl_stream_push_chars(stream,UC"; charset=")					,jbl_stream_push_chars(stream,UC charset[head->charset]);
		rn();
	}
	if(!(head->tren&JWL_HTTP_TREN_CHUNKED))
	{
		if(head->status==206&&jwl_http_head_is_response(head))
		{
			jbl_stream_push_chars(stream,UC"Content-Length: ")					,jbl_stream_push_uint(stream,(head->range.end?head->range.end:head->len)-head->range.start)	,rn();//注意，range是闭区间，而jwl,jbl要求左闭右开区间
			jbl_stream_push_chars(stream,UC"Content-Range: bytes ")				,jbl_stream_push_uint(stream,head->range.start)			,jbl_stream_push_char(stream,'-')	,jbl_stream_push_uint(stream,head->range.end?(head->range.end-1):0)	,jbl_stream_push_char(stream,'/')	,jbl_stream_push_uint(stream,head->len)	,rn();
		}
		else
			jbl_stream_push_chars(stream,UC"Content-Length: ")					,jbl_stream_push_uint(stream,head->len)					,rn();
	}
	if(head->tren)
	{
		char * tren			[]={"","chunked","compress","deflate","gzip","identity"};
		jbl_uint8 f=0;
		jbl_stream_push_chars(stream,UC"Transfer-Encoding: ");
		if(head->tren&JWL_HTTP_TREN_CHUNKED		){jbl_stream_push_chars(stream,UC tren[1]);f=1;}
		if(head->tren&JWL_HTTP_TREN_COMPRESS	){if(f)jbl_stream_push_chars(stream,UC", ");jbl_stream_push_chars(stream,UC tren[2]);f=1;}
		if(head->tren&JWL_HTTP_TREN_DEFLATE		){if(f)jbl_stream_push_chars(stream,UC", ");jbl_stream_push_chars(stream,UC tren[3]);f=1;}
		if(head->tren&JWL_HTTP_TREN_GZIP		){if(f)jbl_stream_push_chars(stream,UC", ");jbl_stream_push_chars(stream,UC tren[4]);f=1;}
		if(head->tren&JWL_HTTP_TREN_IDENTITY	){if(f)jbl_stream_push_chars(stream,UC", ");jbl_stream_push_chars(stream,UC tren[5]);f=1;}
		rn();
	}	
	
	
	
	if(head->host&&jwl_http_head_is_request(head))
		jbl_stream_push_chars(stream,UC"Host: ")							,jbl_stream_push_string(stream,head->host)				,rn();	
	
	
	if(jwl_http_head_is_response(head))
	{
		jbl_stream_push_chars(stream,UC"Server: "JWL_HTTP_RESPONSE_SERVER_NAME)														,rn();
		jbl_stream_push_chars(stream,UC"Accept-Ranges: bytes")																		,rn();
		if(head->connection==JWL_HTTP_CONNECTION_UPGRADE&&head->upgrade)
		{
			char * upgrade[]={"","websocket"};
			jbl_stream_push_chars(stream,UC"Upgrade: ")							,jbl_stream_push_chars(stream,UC upgrade[head->upgrade])		,rn();
		}
			
		if(head->filename)
		{
			jbl_stream_push_chars(stream,UC"Content-Disposition: attachment; filename=\"");
			jbl_stream_push_string(stream,head->filename);
			jbl_stream_push_char(stream,'"');
			rn();
		}
	}
	if(head->v)
		jbl_ht_foreach(head->v,i)
		{
			jbl_stream_push_string(stream,jbl_htk(i));
			jbl_stream_push_chars(stream,UC": ");
			if(Vis_jbl_string(i->v))jbl_stream_push_string(stream,jbl_Vstring(i->v));
			else					jbl_var_json_put(i->v,stream,0,0);
			rn();
		}
	rn();
#undef rn
}
#line 327 "jwl/jwl_http.c"
enum jwl_http_scanner_condition {
	jwl_http_scanner_condition_0,
	jwl_http_scanner_condition_start,
	jwl_http_scanner_condition_starts,
	jwl_http_scanner_condition_status,
	jwl_http_scanner_condition_statuse,
	jwl_http_scanner_condition_url,
	jwl_http_scanner_condition_parameter,
	jwl_http_scanner_condition_parameterv,
	jwl_http_scanner_condition_protocol,
	jwl_http_scanner_condition_head_body,
	jwl_http_scanner_condition_head_host,
	jwl_http_scanner_condition_head_ua,
	jwl_http_scanner_condition_head_refer,
	jwl_http_scanner_condition_head_etag,
	jwl_http_scanner_condition_head_conn,
	jwl_http_scanner_condition_head_tren,
	jwl_http_scanner_condition_head_upgrade,
	jwl_http_scanner_condition_head_range_s,
	jwl_http_scanner_condition_head_range_e,
	jwl_http_scanner_condition_head_accept,
	jwl_http_scanner_condition_head_acen,
	jwl_http_scanner_condition_head_aclan,
	jwl_http_scanner_condition_head_cookie,
	jwl_http_scanner_condition_head_cookiev,
	jwl_http_scanner_condition_head_ct,
	jwl_http_scanner_condition_head_cs,
	jwl_http_scanner_condition_head_cache,
	jwl_http_scanner_condition_special_key,
	jwl_http_scanner_condition_special_var,
	jwl_http_scanner_condition_head_ignore,
};
#line 324 "jwl/jwl_http.l"


jwl_http_head* jwl_http_head_decode(jbl_string *buf,jbl_string_size_type *start)
{	
	if(!buf)return NULL;
	buf=jbl_refer_pull(buf);
	if(!buf->len)return NULL;
	jwl_http_head * head=jwl_http_head_new();
	head=jwl_http_head_set_request(head);
	unsigned char	*	YYMARKER;
	unsigned char	*	YYCURSOR=buf->s+(start?(*start):0);
	jbl_string		*	tmp_key	=NULL;
	jbl_var			*	tmp_var	=NULL;
	#define YYCTYPE		unsigned char

#line 376 "jwl/jwl_http.c"
{
	YYCTYPE yych;
	switch (head->cond) {
	case jwl_http_scanner_condition_0: goto yyc_0;
	case jwl_http_scanner_condition_start: goto yyc_start;
	case jwl_http_scanner_condition_starts: goto yyc_starts;
	case jwl_http_scanner_condition_status: goto yyc_status;
	case jwl_http_scanner_condition_statuse: goto yyc_statuse;
	case jwl_http_scanner_condition_url: goto yyc_url;
	case jwl_http_scanner_condition_parameter: goto yyc_parameter;
	case jwl_http_scanner_condition_parameterv: goto yyc_parameterv;
	case jwl_http_scanner_condition_protocol: goto yyc_protocol;
	case jwl_http_scanner_condition_head_body: goto yyc_head_body;
	case jwl_http_scanner_condition_head_host: goto yyc_head_host;
	case jwl_http_scanner_condition_head_ua: goto yyc_head_ua;
	case jwl_http_scanner_condition_head_refer: goto yyc_head_refer;
	case jwl_http_scanner_condition_head_etag: goto yyc_head_etag;
	case jwl_http_scanner_condition_head_conn: goto yyc_head_conn;
	case jwl_http_scanner_condition_head_tren: goto yyc_head_tren;
	case jwl_http_scanner_condition_head_upgrade: goto yyc_head_upgrade;
	case jwl_http_scanner_condition_head_range_s: goto yyc_head_range_s;
	case jwl_http_scanner_condition_head_range_e: goto yyc_head_range_e;
	case jwl_http_scanner_condition_head_accept: goto yyc_head_accept;
	case jwl_http_scanner_condition_head_acen: goto yyc_head_acen;
	case jwl_http_scanner_condition_head_aclan: goto yyc_head_aclan;
	case jwl_http_scanner_condition_head_cookie: goto yyc_head_cookie;
	case jwl_http_scanner_condition_head_cookiev: goto yyc_head_cookiev;
	case jwl_http_scanner_condition_head_ct: goto yyc_head_ct;
	case jwl_http_scanner_condition_head_cs: goto yyc_head_cs;
	case jwl_http_scanner_condition_head_cache: goto yyc_head_cache;
	case jwl_http_scanner_condition_special_key: goto yyc_special_key;
	case jwl_http_scanner_condition_special_var: goto yyc_special_var;
	case jwl_http_scanner_condition_head_ignore: goto yyc_head_ignore;
	}
/* *********************************** */
yyc_0:
	head->cond = (jwl_http_scanner_condition_start);
	goto yyc_start;
/* *********************************** */
yyc_start:
	yych = *YYCURSOR;
	switch (yych) {
	case ' ':	goto yy7;
	case 'G':	goto yy9;
	case 'H':	goto yy10;
	case 'P':	goto yy11;
	default:	goto yy6;
	}
yy6:
yy7:
	++YYCURSOR;
	head->cond = (jwl_http_scanner_condition_url);
#line 350 "jwl/jwl_http.l"
	{head->url				=jbl_string_free    (head->url)									;goto yyc_url;}
#line 431 "jwl/jwl_http.c"
yy9:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'E':	goto yy12;
	default:	goto yy6;
	}
yy10:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'T':	goto yy13;
	default:	goto yy6;
	}
yy11:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'O':	goto yy14;
	default:	goto yy6;
	}
yy12:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'T':	goto yy15;
	default:	goto yy6;
	}
yy13:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'T':	goto yy17;
	default:	goto yy6;
	}
yy14:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'S':	goto yy18;
	default:	goto yy6;
	}
yy15:
	++YYCURSOR;
#line 348 "jwl/jwl_http.l"
	{head->method=JWL_HTTP_METHOD_GET		;head=jwl_http_head_set_request(head)			;goto yyc_start;}
#line 472 "jwl/jwl_http.c"
yy17:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'P':	goto yy19;
	default:	goto yy6;
	}
yy18:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'T':	goto yy20;
	default:	goto yy6;
	}
yy19:
	yych = *++YYCURSOR;
	switch (yych) {
	case '/':	goto yy22;
	default:	goto yy6;
	}
yy20:
	++YYCURSOR;
#line 347 "jwl/jwl_http.l"
	{head->method=JWL_HTTP_METHOD_POST		;head=jwl_http_head_set_request(head)			;goto yyc_start;}
#line 495 "jwl/jwl_http.c"
yy22:
	yych = *++YYCURSOR;
	switch (yych) {
	case '1':	goto yy23;
	default:	goto yy6;
	}
yy23:
	yych = *++YYCURSOR;
	switch (yych) {
	case '.':	goto yy24;
	default:	goto yy6;
	}
yy24:
	yych = *++YYCURSOR;
	switch (yych) {
	case '1':	goto yy25;
	default:	goto yy6;
	}
yy25:
	++YYCURSOR;
	head->cond = (jwl_http_scanner_condition_starts);
#line 349 "jwl/jwl_http.l"
	{head->method=JWL_HTTP_METHOD_GET		;head=jwl_http_head_set_response(head)			;goto yyc_starts;}
#line 519 "jwl/jwl_http.c"
/* *********************************** */
yyc_starts:
	yych = *YYCURSOR;
	switch (yych) {
	case ' ':	goto yy30;
	default:	goto yy29;
	}
yy29:
yy30:
	++YYCURSOR;
	head->cond = (jwl_http_scanner_condition_status);
#line 351 "jwl/jwl_http.l"
	{head->status			=0																;goto yyc_status;}
#line 533 "jwl/jwl_http.c"
/* *********************************** */
yyc_status:
	yych = *(YYMARKER = YYCURSOR);
	switch (yych) {
	case '\r':	goto yy35;
	case ' ':	goto yy37;
	default:	goto yy34;
	}
yy34:
#line 353 "jwl/jwl_http.l"
	{head->status			=((head->status<<3)+(head->status<<1)+*YYCURSOR-'0')			;++YYCURSOR;goto yyc_status;}
#line 545 "jwl/jwl_http.c"
yy35:
	yych = *++YYCURSOR;
	switch (yych) {
	case '\n':	goto yy39;
	default:	goto yy36;
	}
yy36:
	YYCURSOR = YYMARKER;
	goto yy34;
yy37:
	++YYCURSOR;
	head->cond = (jwl_http_scanner_condition_statuse);
#line 354 "jwl/jwl_http.l"
	{																						;goto yyc_statuse;}
#line 560 "jwl/jwl_http.c"
yy39:
	++YYCURSOR;
	head->cond = (jwl_http_scanner_condition_head_body);
#line 355 "jwl/jwl_http.l"
	{																						;goto yyc_head_body;}
#line 566 "jwl/jwl_http.c"
/* *********************************** */
yyc_statuse:
	yych = *YYCURSOR;
	switch (yych) {
	case '\r':	goto yy44;
	default:	goto yy43;
	}
yy43:
yy44:
	yych = *++YYCURSOR;
	switch (yych) {
	case '\n':	goto yy45;
	default:	goto yy43;
	}
yy45:
	++YYCURSOR;
	head->cond = (jwl_http_scanner_condition_head_body);
#line 356 "jwl/jwl_http.l"
	{																						;goto yyc_head_body;}
#line 586 "jwl/jwl_http.c"
/* *********************************** */
yyc_url:
	yych = *YYCURSOR;
	switch (yych) {
	case ' ':	goto yy50;
	case '?':	goto yy52;
	default:	goto yy49;
	}
yy49:
#line 358 "jwl/jwl_http.l"
	{head->url				=jbl_string_add_char(head->url,*YYCURSOR)						;++YYCURSOR;goto yyc_url;}
#line 598 "jwl/jwl_http.c"
yy50:
	++YYCURSOR;
	head->cond = (jwl_http_scanner_condition_protocol);
#line 359 "jwl/jwl_http.l"
	{																						;goto yyc_protocol;}
#line 604 "jwl/jwl_http.c"
yy52:
	++YYCURSOR;
	head->cond = (jwl_http_scanner_condition_parameter);
#line 360 "jwl/jwl_http.l"
	{tmp_key				=jbl_string_free    (tmp_key)									;goto yyc_parameter;}
#line 610 "jwl/jwl_http.c"
/* *********************************** */
yyc_parameter:
	yych = *YYCURSOR;
	switch (yych) {
	case ' ':	goto yy57;
	case '&':	goto yy59;
	case '=':	goto yy61;
	default:	goto yy56;
	}
yy56:
#line 361 "jwl/jwl_http.l"
	{tmp_key				=jbl_string_add_char(tmp_key,*YYCURSOR)		;++YYCURSOR;		;goto yyc_parameter;}
#line 623 "jwl/jwl_http.c"
yy57:
	++YYCURSOR;
	head->cond = (jwl_http_scanner_condition_protocol);
#line 362 "jwl/jwl_http.l"
	{tmp_key=jbl_string_free(tmp_key);tmp_var=jbl_var_free(tmp_var);						;goto yyc_protocol;}
#line 629 "jwl/jwl_http.c"
yy59:
	++YYCURSOR;
#line 363 "jwl/jwl_http.l"
	{tmp_key=jbl_string_free(tmp_key);tmp_var=jbl_var_free(tmp_var);						;goto yyc_parameter;}
#line 634 "jwl/jwl_http.c"
yy61:
	++YYCURSOR;
	head->cond = (jwl_http_scanner_condition_parameterv);
#line 364 "jwl/jwl_http.l"
	{tmp_var				=jbl_var_free(tmp_var)			;tmp_var=jbl_Vstring_new();														;goto yyc_parameterv;}
#line 640 "jwl/jwl_http.c"
/* *********************************** */
yyc_parameterv:
	yych = *YYCURSOR;
	switch (yych) {
	case ' ':	goto yy66;
	case '&':	goto yy68;
	default:	goto yy65;
	}
yy65:
#line 365 "jwl/jwl_http.l"
	{tmp_var				=jbl_V(jbl_string_add_char(jbl_Vstring(tmp_var),*YYCURSOR))		;++YYCURSOR;goto yyc_parameterv;}
#line 652 "jwl/jwl_http.c"
yy66:
	++YYCURSOR;
	head->cond = (jwl_http_scanner_condition_protocol);
#line 367 "jwl/jwl_http.l"
	{head->parameter		=jbl_ht_insert(head->parameter,tmp_key,tmp_var);tmp_key=jbl_string_free(tmp_key);tmp_var=jbl_var_free(tmp_var);			;goto yyc_protocol;}
#line 658 "jwl/jwl_http.c"
yy68:
	++YYCURSOR;
	head->cond = (jwl_http_scanner_condition_head_body);
#line 366 "jwl/jwl_http.l"
	{head->parameter		=jbl_ht_insert(head->parameter,tmp_key,tmp_var);tmp_key=jbl_string_free(tmp_key);tmp_var=jbl_var_free(tmp_var);			;goto yyc_parameter;}
#line 664 "jwl/jwl_http.c"
/* *********************************** */
yyc_protocol:
	yych = *YYCURSOR;
	switch (yych) {
	case '\r':	goto yy73;
	case 'H':	goto yy74;
	default:	goto yy72;
	}
yy72:
yy73:
	yych = *++YYCURSOR;
	switch (yych) {
	case '\n':	goto yy75;
	default:	goto yy72;
	}
yy74:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'T':	goto yy77;
	default:	goto yy72;
	}
yy75:
	++YYCURSOR;
	head->cond = (jwl_http_scanner_condition_head_body);
#line 370 "jwl/jwl_http.l"
	{																						;goto yyc_head_body;}
#line 691 "jwl/jwl_http.c"
yy77:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'T':	goto yy78;
	default:	goto yy72;
	}
yy78:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'P':	goto yy79;
	default:	goto yy72;
	}
yy79:
	yych = *++YYCURSOR;
	switch (yych) {
	case '/':	goto yy80;
	default:	goto yy72;
	}
yy80:
	yych = *++YYCURSOR;
	switch (yych) {
	case '1':	goto yy81;
	default:	goto yy72;
	}
yy81:
	yych = *++YYCURSOR;
	switch (yych) {
	case '.':	goto yy82;
	default:	goto yy72;
	}
yy82:
	yych = *++YYCURSOR;
	switch (yych) {
	case '1':	goto yy83;
	default:	goto yy72;
	}
yy83:
	++YYCURSOR;
#line 369 "jwl/jwl_http.l"
	{head->protocol			=JWL_HTTP_PROTOCOL_HTTP_1_1										;goto yyc_protocol;}
#line 732 "jwl/jwl_http.c"
/* *********************************** */
yyc_head_body:
	yych = *(YYMARKER = YYCURSOR);
	switch (yych) {
	case 0x00:	goto yy88;
	case '\r':	goto yy90;
	case 'A':	goto yy92;
	case 'C':	goto yy93;
	case 'E':	goto yy94;
	case 'H':	goto yy95;
	case 'I':	goto yy96;
	case 'P':	goto yy97;
	case 'R':	goto yy98;
	case 'S':	goto yy99;
	case 'T':	goto yy100;
	case 'U':	goto yy101;
	default:	goto yy87;
	}
yy87:
	head->cond = (jwl_http_scanner_condition_special_key);
#line 453 "jwl/jwl_http.l"
	{tmp_key				=jbl_string_free    (tmp_key)	;tmp_key=jbl_string_add_char(tmp_key,*YYCURSOR)		;++YYCURSOR;		;goto yyc_special_key;}
#line 755 "jwl/jwl_http.c"
yy88:
	++YYCURSOR;
#line 469 "jwl/jwl_http.l"
	{if(start)*start=YYCURSOR-buf->s;return head;}
#line 760 "jwl/jwl_http.c"
yy90:
	yych = *++YYCURSOR;
	switch (yych) {
	case '\n':	goto yy102;
	default:	goto yy91;
	}
yy91:
	YYCURSOR = YYMARKER;
	goto yy87;
yy92:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'c':	goto yy104;
	default:	goto yy91;
	}
yy93:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'a':	goto yy105;
	case 'o':	goto yy106;
	default:	goto yy91;
	}
yy94:
	yych = *++YYCURSOR;
	switch (yych) {
	case 't':	goto yy107;
	default:	goto yy91;
	}
yy95:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'o':	goto yy108;
	default:	goto yy91;
	}
yy96:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'f':	goto yy109;
	default:	goto yy91;
	}
yy97:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'r':	goto yy110;
	default:	goto yy91;
	}
yy98:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'a':	goto yy111;
	case 'e':	goto yy112;
	default:	goto yy91;
	}
yy99:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'e':	goto yy113;
	default:	goto yy91;
	}
yy100:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'r':	goto yy114;
	default:	goto yy91;
	}
yy101:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'p':	goto yy115;
	case 's':	goto yy116;
	default:	goto yy91;
	}
yy102:
	++YYCURSOR;
#line 468 "jwl/jwl_http.l"
	{if(start)*start=YYCURSOR-buf->s;return head;}
#line 837 "jwl/jwl_http.c"
yy104:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'c':	goto yy117;
	default:	goto yy91;
	}
yy105:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'c':	goto yy118;
	default:	goto yy91;
	}
yy106:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'n':	goto yy119;
	case 'o':	goto yy120;
	default:	goto yy91;
	}
yy107:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'a':	goto yy121;
	default:	goto yy91;
	}
yy108:
	yych = *++YYCURSOR;
	switch (yych) {
	case 's':	goto yy122;
	default:	goto yy91;
	}
yy109:
	yych = *++YYCURSOR;
	switch (yych) {
	case '-':	goto yy123;
	default:	goto yy91;
	}
yy110:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'a':	goto yy124;
	default:	goto yy91;
	}
yy111:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'n':	goto yy125;
	default:	goto yy91;
	}
yy112:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'f':	goto yy126;
	default:	goto yy91;
	}
yy113:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'r':	goto yy127;
	default:	goto yy91;
	}
yy114:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'a':	goto yy128;
	default:	goto yy91;
	}
yy115:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'g':	goto yy129;
	default:	goto yy91;
	}
yy116:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'e':	goto yy130;
	default:	goto yy91;
	}
yy117:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'e':	goto yy131;
	default:	goto yy91;
	}
yy118:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'h':	goto yy132;
	default:	goto yy91;
	}
yy119:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'n':	goto yy133;
	case 't':	goto yy134;
	default:	goto yy91;
	}
yy120:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'k':	goto yy135;
	default:	goto yy91;
	}
yy121:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'g':	goto yy136;
	default:	goto yy91;
	}
yy122:
	yych = *++YYCURSOR;
	switch (yych) {
	case 't':	goto yy137;
	default:	goto yy91;
	}
yy123:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'N':	goto yy138;
	default:	goto yy91;
	}
yy124:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'g':	goto yy139;
	default:	goto yy91;
	}
yy125:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'g':	goto yy140;
	default:	goto yy91;
	}
yy126:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'e':	goto yy141;
	default:	goto yy91;
	}
yy127:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'v':	goto yy142;
	default:	goto yy91;
	}
yy128:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'n':	goto yy143;
	default:	goto yy91;
	}
yy129:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'r':	goto yy144;
	default:	goto yy91;
	}
yy130:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'r':	goto yy145;
	default:	goto yy91;
	}
yy131:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'p':	goto yy146;
	default:	goto yy91;
	}
yy132:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'e':	goto yy147;
	default:	goto yy91;
	}
yy133:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'e':	goto yy148;
	default:	goto yy91;
	}
yy134:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'e':	goto yy149;
	default:	goto yy91;
	}
yy135:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'i':	goto yy150;
	default:	goto yy91;
	}
yy136:
	yych = *++YYCURSOR;
	switch (yych) {
	case ':':	goto yy151;
	default:	goto yy91;
	}
yy137:
	yych = *++YYCURSOR;
	switch (yych) {
	case ':':	goto yy154;
	default:	goto yy91;
	}
yy138:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'o':	goto yy157;
	default:	goto yy91;
	}
yy139:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'm':	goto yy158;
	default:	goto yy91;
	}
yy140:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'e':	goto yy159;
	default:	goto yy91;
	}
yy141:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'r':	goto yy160;
	default:	goto yy91;
	}
yy142:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'e':	goto yy161;
	default:	goto yy91;
	}
yy143:
	yych = *++YYCURSOR;
	switch (yych) {
	case 's':	goto yy162;
	default:	goto yy91;
	}
yy144:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'a':	goto yy163;
	default:	goto yy91;
	}
yy145:
	yych = *++YYCURSOR;
	switch (yych) {
	case '-':	goto yy164;
	default:	goto yy91;
	}
yy146:
	yych = *++YYCURSOR;
	switch (yych) {
	case 't':	goto yy165;
	default:	goto yy91;
	}
yy147:
	yych = *++YYCURSOR;
	switch (yych) {
	case '-':	goto yy166;
	default:	goto yy91;
	}
yy148:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'c':	goto yy167;
	default:	goto yy91;
	}
yy149:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'n':	goto yy168;
	default:	goto yy91;
	}
yy150:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'e':	goto yy169;
	default:	goto yy91;
	}
yy151:
	yych = *++YYCURSOR;
	switch (yych) {
	case ' ':	goto yy151;
	default:	goto yy153;
	}
yy153:
	head->cond = (jwl_http_scanner_condition_head_etag);
#line 384 "jwl/jwl_http.l"
	{head->etag				=jbl_string_free    (head->etag)								;goto yyc_head_etag;}
#line 1132 "jwl/jwl_http.c"
yy154:
	yych = *++YYCURSOR;
	switch (yych) {
	case ' ':	goto yy154;
	default:	goto yy156;
	}
yy156:
	head->cond = (jwl_http_scanner_condition_head_host);
#line 372 "jwl/jwl_http.l"
	{head->host				=jbl_string_free    (head->host)								;goto yyc_head_host;}
#line 1143 "jwl/jwl_http.c"
yy157:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'n':	goto yy170;
	default:	goto yy91;
	}
yy158:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'a':	goto yy171;
	default:	goto yy91;
	}
yy159:
	yych = *++YYCURSOR;
	switch (yych) {
	case ':':	goto yy172;
	default:	goto yy91;
	}
yy160:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'e':	goto yy174;
	default:	goto yy91;
	}
yy161:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'r':	goto yy175;
	default:	goto yy91;
	}
yy162:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'f':	goto yy176;
	default:	goto yy91;
	}
yy163:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'd':	goto yy177;
	default:	goto yy91;
	}
yy164:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'A':	goto yy178;
	default:	goto yy91;
	}
yy165:
	yych = *++YYCURSOR;
	switch (yych) {
	case '-':	goto yy179;
	case ':':	goto yy180;
	default:	goto yy91;
	}
yy166:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'C':	goto yy183;
	default:	goto yy91;
	}
yy167:
	yych = *++YYCURSOR;
	switch (yych) {
	case 't':	goto yy184;
	default:	goto yy91;
	}
yy168:
	yych = *++YYCURSOR;
	switch (yych) {
	case 't':	goto yy185;
	default:	goto yy91;
	}
yy169:
	yych = *++YYCURSOR;
	switch (yych) {
	case ':':	goto yy186;
	default:	goto yy91;
	}
yy170:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'e':	goto yy189;
	default:	goto yy91;
	}
yy171:
	yych = *++YYCURSOR;
	switch (yych) {
	case ':':	goto yy190;
	default:	goto yy91;
	}
yy172:
	yych = *++YYCURSOR;
	switch (yych) {
	case ' ':	goto yy172;
	case 'b':	goto yy191;
	default:	goto yy91;
	}
yy174:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'r':	goto yy192;
	default:	goto yy91;
	}
yy175:
	yych = *++YYCURSOR;
	switch (yych) {
	case ':':	goto yy193;
	default:	goto yy91;
	}
yy176:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'e':	goto yy196;
	default:	goto yy91;
	}
yy177:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'e':	goto yy197;
	default:	goto yy91;
	}
yy178:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'g':	goto yy198;
	default:	goto yy91;
	}
yy179:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'E':	goto yy199;
	case 'L':	goto yy200;
	default:	goto yy91;
	}
yy180:
	yych = *++YYCURSOR;
	switch (yych) {
	case ' ':	goto yy180;
	default:	goto yy182;
	}
yy182:
	head->cond = (jwl_http_scanner_condition_head_accept);
#line 416 "jwl/jwl_http.l"
	{																						;goto yyc_head_accept;}
#line 1289 "jwl/jwl_http.c"
yy183:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'o':	goto yy201;
	default:	goto yy91;
	}
yy184:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'i':	goto yy202;
	default:	goto yy91;
	}
yy185:
	yych = *++YYCURSOR;
	switch (yych) {
	case '-':	goto yy203;
	default:	goto yy91;
	}
yy186:
	yych = *++YYCURSOR;
	switch (yych) {
	case ' ':	goto yy186;
	default:	goto yy188;
	}
yy188:
	head->cond = (jwl_http_scanner_condition_head_cookie);
#line 428 "jwl/jwl_http.l"
	{tmp_key				=jbl_string_free    (tmp_key)	;								;goto yyc_head_cookie;}
#line 1318 "jwl/jwl_http.c"
yy189:
	yych = *++YYCURSOR;
	switch (yych) {
	case '-':	goto yy204;
	default:	goto yy91;
	}
yy190:
	yych = *++YYCURSOR;
	switch (yych) {
	case ' ':	goto yy205;
	default:	goto yy91;
	}
yy191:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'y':	goto yy207;
	default:	goto yy91;
	}
yy192:
	yych = *++YYCURSOR;
	switch (yych) {
	case ':':	goto yy208;
	default:	goto yy91;
	}
yy193:
	yych = *++YYCURSOR;
	switch (yych) {
	case ' ':	goto yy193;
	default:	goto yy195;
	}
yy195:
	head->cond = (jwl_http_scanner_condition_head_ignore);
#line 462 "jwl/jwl_http.l"
	{																						;goto yyc_head_ignore;}
#line 1353 "jwl/jwl_http.c"
yy196:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'r':	goto yy211;
	default:	goto yy91;
	}
yy197:
	yych = *++YYCURSOR;
	switch (yych) {
	case ':':	goto yy212;
	default:	goto yy91;
	}
yy198:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'e':	goto yy215;
	default:	goto yy91;
	}
yy199:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'n':	goto yy216;
	default:	goto yy91;
	}
yy200:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'a':	goto yy217;
	default:	goto yy91;
	}
yy201:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'n':	goto yy218;
	default:	goto yy91;
	}
yy202:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'o':	goto yy219;
	default:	goto yy91;
	}
yy203:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'T':	goto yy220;
	default:	goto yy91;
	}
yy204:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'M':	goto yy221;
	default:	goto yy91;
	}
yy205:
	++YYCURSOR;
	head->cond = (jwl_http_scanner_condition_head_cache);
#line 447 "jwl/jwl_http.l"
	{																						;goto yyc_head_cache;}
#line 1413 "jwl/jwl_http.c"
yy207:
	yych = *++YYCURSOR;
	switch (yych) {
	case 't':	goto yy222;
	default:	goto yy91;
	}
yy208:
	yych = *++YYCURSOR;
	switch (yych) {
	case ' ':	goto yy208;
	default:	goto yy210;
	}
yy210:
	head->cond = (jwl_http_scanner_condition_head_refer);
#line 380 "jwl/jwl_http.l"
	{head->referer			=jbl_string_free    (head->referer)								;goto yyc_head_refer;}
#line 1430 "jwl/jwl_http.c"
yy211:
	yych = *++YYCURSOR;
	switch (yych) {
	case '-':	goto yy223;
	default:	goto yy91;
	}
yy212:
	yych = *++YYCURSOR;
	switch (yych) {
	case ' ':	goto yy212;
	default:	goto yy214;
	}
yy214:
	head->cond = (jwl_http_scanner_condition_head_upgrade);
#line 405 "jwl/jwl_http.l"
	{																						;goto yyc_head_upgrade;}
#line 1447 "jwl/jwl_http.c"
yy215:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'n':	goto yy224;
	default:	goto yy91;
	}
yy216:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'c':	goto yy225;
	default:	goto yy91;
	}
yy217:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'n':	goto yy226;
	default:	goto yy91;
	}
yy218:
	yych = *++YYCURSOR;
	switch (yych) {
	case 't':	goto yy227;
	default:	goto yy91;
	}
yy219:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'n':	goto yy228;
	default:	goto yy91;
	}
yy220:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'y':	goto yy229;
	default:	goto yy91;
	}
yy221:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'a':	goto yy230;
	default:	goto yy91;
	}
yy222:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'e':	goto yy231;
	default:	goto yy91;
	}
yy223:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'E':	goto yy232;
	default:	goto yy91;
	}
yy224:
	yych = *++YYCURSOR;
	switch (yych) {
	case 't':	goto yy233;
	default:	goto yy91;
	}
yy225:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'o':	goto yy234;
	default:	goto yy91;
	}
yy226:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'g':	goto yy235;
	default:	goto yy91;
	}
yy227:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'r':	goto yy236;
	default:	goto yy91;
	}
yy228:
	yych = *++YYCURSOR;
	switch (yych) {
	case ':':	goto yy237;
	default:	goto yy91;
	}
yy229:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'p':	goto yy240;
	default:	goto yy91;
	}
yy230:
	yych = *++YYCURSOR;
	switch (yych) {
	case 't':	goto yy241;
	default:	goto yy91;
	}
yy231:
	yych = *++YYCURSOR;
	switch (yych) {
	case 's':	goto yy242;
	default:	goto yy91;
	}
yy232:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'n':	goto yy243;
	default:	goto yy91;
	}
yy233:
	yych = *++YYCURSOR;
	switch (yych) {
	case ':':	goto yy244;
	default:	goto yy91;
	}
yy234:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'd':	goto yy247;
	default:	goto yy91;
	}
yy235:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'u':	goto yy248;
	default:	goto yy91;
	}
yy236:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'o':	goto yy249;
	default:	goto yy91;
	}
yy237:
	yych = *++YYCURSOR;
	switch (yych) {
	case ' ':	goto yy237;
	default:	goto yy239;
	}
yy239:
	head->cond = (jwl_http_scanner_condition_head_conn);
#line 389 "jwl/jwl_http.l"
	{																						;goto yyc_head_conn;}
#line 1590 "jwl/jwl_http.c"
yy240:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'e':	goto yy250;
	default:	goto yy91;
	}
yy241:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'c':	goto yy251;
	default:	goto yy91;
	}
yy242:
	yych = *++YYCURSOR;
	switch (yych) {
	case '=':	goto yy252;
	default:	goto yy91;
	}
yy243:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'c':	goto yy254;
	default:	goto yy91;
	}
yy244:
	yych = *++YYCURSOR;
	switch (yych) {
	case ' ':	goto yy244;
	default:	goto yy246;
	}
yy246:
	head->cond = (jwl_http_scanner_condition_head_ua);
#line 376 "jwl/jwl_http.l"
	{head->ua				=jbl_string_free    (head->ua)									;goto yyc_head_ua;}
#line 1625 "jwl/jwl_http.c"
yy247:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'i':	goto yy255;
	default:	goto yy91;
	}
yy248:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'a':	goto yy256;
	default:	goto yy91;
	}
yy249:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'l':	goto yy257;
	default:	goto yy91;
	}
yy250:
	yych = *++YYCURSOR;
	switch (yych) {
	case ':':	goto yy258;
	default:	goto yy91;
	}
yy251:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'h':	goto yy261;
	default:	goto yy91;
	}
yy252:
	++YYCURSOR;
	head->cond = (jwl_http_scanner_condition_head_range_s);
#line 409 "jwl/jwl_http.l"
	{head->range.start		=0																;goto yyc_head_range_s;}
#line 1661 "jwl/jwl_http.c"
yy254:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'o':	goto yy262;
	default:	goto yy91;
	}
yy255:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'n':	goto yy263;
	default:	goto yy91;
	}
yy256:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'g':	goto yy264;
	default:	goto yy91;
	}
yy257:
	yych = *++YYCURSOR;
	switch (yych) {
	case ':':	goto yy265;
	default:	goto yy91;
	}
yy258:
	yych = *++YYCURSOR;
	switch (yych) {
	case ' ':	goto yy258;
	default:	goto yy260;
	}
yy260:
	head->cond = (jwl_http_scanner_condition_head_ct);
#line 436 "jwl/jwl_http.l"
	{tmp_key				=jbl_string_free    (tmp_key)									;goto yyc_head_ct;}
#line 1696 "jwl/jwl_http.c"
yy261:
	yych = *++YYCURSOR;
	switch (yych) {
	case ':':	goto yy268;
	default:	goto yy91;
	}
yy262:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'd':	goto yy271;
	default:	goto yy91;
	}
yy263:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'g':	goto yy272;
	default:	goto yy91;
	}
yy264:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'e':	goto yy273;
	default:	goto yy91;
	}
yy265:
	yych = *++YYCURSOR;
	switch (yych) {
	case ' ':	goto yy265;
	default:	goto yy267;
	}
yy267:
	head->cond = (jwl_http_scanner_condition_head_cache);
#line 446 "jwl/jwl_http.l"
	{																						;goto yyc_head_cache;}
#line 1731 "jwl/jwl_http.c"
yy268:
	yych = *++YYCURSOR;
	switch (yych) {
	case ' ':	goto yy268;
	default:	goto yy270;
	}
yy270:
	head->cond = (jwl_http_scanner_condition_head_etag);
#line 385 "jwl/jwl_http.l"
	{head->etag				=jbl_string_free    (head->etag)								;goto yyc_head_etag;}
#line 1742 "jwl/jwl_http.c"
yy271:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'i':	goto yy274;
	default:	goto yy91;
	}
yy272:
	yych = *++YYCURSOR;
	switch (yych) {
	case ':':	goto yy275;
	default:	goto yy91;
	}
yy273:
	yych = *++YYCURSOR;
	switch (yych) {
	case ':':	goto yy278;
	default:	goto yy91;
	}
yy274:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'n':	goto yy281;
	default:	goto yy91;
	}
yy275:
	yych = *++YYCURSOR;
	switch (yych) {
	case ' ':	goto yy275;
	default:	goto yy277;
	}
yy277:
	head->cond = (jwl_http_scanner_condition_head_acen);
#line 420 "jwl/jwl_http.l"
	{																						;goto yyc_head_acen;}
#line 1777 "jwl/jwl_http.c"
yy278:
	yych = *++YYCURSOR;
	switch (yych) {
	case ' ':	goto yy278;
	default:	goto yy280;
	}
yy280:
	head->cond = (jwl_http_scanner_condition_head_aclan);
#line 424 "jwl/jwl_http.l"
	{																						;goto yyc_head_aclan;}
#line 1788 "jwl/jwl_http.c"
yy281:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'g':	goto yy282;
	default:	goto yy91;
	}
yy282:
	yych = *++YYCURSOR;
	switch (yych) {
	case ':':	goto yy283;
	default:	goto yy91;
	}
yy283:
	yych = *++YYCURSOR;
	switch (yych) {
	case ' ':	goto yy283;
	default:	goto yy285;
	}
yy285:
	head->cond = (jwl_http_scanner_condition_head_tren);
#line 396 "jwl/jwl_http.l"
	{																						;goto yyc_head_tren;}
#line 1811 "jwl/jwl_http.c"
/* *********************************** */
yyc_head_host:
	yych = *(YYMARKER = YYCURSOR);
	switch (yych) {
	case '\r':	goto yy289;
	default:	goto yy288;
	}
yy288:
#line 373 "jwl/jwl_http.l"
	{head->host				=jbl_string_add_char(head->host,*YYCURSOR)						;++YYCURSOR;goto yyc_head_host;}
#line 1822 "jwl/jwl_http.c"
yy289:
	yych = *++YYCURSOR;
	switch (yych) {
	case '\n':	goto yy291;
	default:	goto yy290;
	}
yy290:
	YYCURSOR = YYMARKER;
	goto yy288;
yy291:
	++YYCURSOR;
	head->cond = (jwl_http_scanner_condition_head_body);
#line 374 "jwl/jwl_http.l"
	{																						;goto yyc_head_body;}
#line 1837 "jwl/jwl_http.c"
/* *********************************** */
yyc_head_ua:
	yych = *(YYMARKER = YYCURSOR);
	switch (yych) {
	case '\r':	goto yy296;
	default:	goto yy295;
	}
yy295:
#line 377 "jwl/jwl_http.l"
	{head->ua				=jbl_string_add_char(head->ua,*YYCURSOR)						;++YYCURSOR;goto yyc_head_ua;}
#line 1848 "jwl/jwl_http.c"
yy296:
	yych = *++YYCURSOR;
	switch (yych) {
	case '\n':	goto yy298;
	default:	goto yy297;
	}
yy297:
	YYCURSOR = YYMARKER;
	goto yy295;
yy298:
	++YYCURSOR;
	head->cond = (jwl_http_scanner_condition_head_body);
#line 378 "jwl/jwl_http.l"
	{																						;goto yyc_head_body;}
#line 1863 "jwl/jwl_http.c"
/* *********************************** */
yyc_head_refer:
	yych = *(YYMARKER = YYCURSOR);
	switch (yych) {
	case '\r':	goto yy303;
	default:	goto yy302;
	}
yy302:
#line 381 "jwl/jwl_http.l"
	{head->referer			=jbl_string_add_char(head->referer,*YYCURSOR)					;++YYCURSOR;goto yyc_head_refer;}
#line 1874 "jwl/jwl_http.c"
yy303:
	yych = *++YYCURSOR;
	switch (yych) {
	case '\n':	goto yy305;
	default:	goto yy304;
	}
yy304:
	YYCURSOR = YYMARKER;
	goto yy302;
yy305:
	++YYCURSOR;
	head->cond = (jwl_http_scanner_condition_head_body);
#line 382 "jwl/jwl_http.l"
	{																						;goto yyc_head_body;}
#line 1889 "jwl/jwl_http.c"
/* *********************************** */
yyc_head_etag:
	yych = *(YYMARKER = YYCURSOR);
	switch (yych) {
	case '\r':	goto yy310;
	default:	goto yy309;
	}
yy309:
#line 386 "jwl/jwl_http.l"
	{head->etag				=jbl_string_add_char(head->etag,*YYCURSOR)						;++YYCURSOR;goto yyc_head_etag;}
#line 1900 "jwl/jwl_http.c"
yy310:
	yych = *++YYCURSOR;
	switch (yych) {
	case '\n':	goto yy312;
	default:	goto yy311;
	}
yy311:
	YYCURSOR = YYMARKER;
	goto yy309;
yy312:
	++YYCURSOR;
	head->cond = (jwl_http_scanner_condition_head_body);
#line 387 "jwl/jwl_http.l"
	{																						;goto yyc_head_body;}
#line 1915 "jwl/jwl_http.c"
/* *********************************** */
yyc_head_conn:
	yych = *YYCURSOR;
	switch (yych) {
	case '\r':	goto yy317;
	case ',':	goto yy318;
	case 'U':	goto yy319;
	case 'c':	goto yy320;
	case 'k':	goto yy321;
	case 'n':	goto yy322;
	default:	goto yy316;
	}
yy316:
yy317:
	yych = *++YYCURSOR;
	switch (yych) {
	case '\n':	goto yy323;
	default:	goto yy316;
	}
yy318:
	yych = *++YYCURSOR;
	switch (yych) {
	case ' ':	goto yy325;
	default:	goto yy316;
	}
yy319:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'p':	goto yy327;
	default:	goto yy316;
	}
yy320:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'l':	goto yy328;
	default:	goto yy316;
	}
yy321:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'e':	goto yy329;
	default:	goto yy316;
	}
yy322:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'o':	goto yy330;
	default:	goto yy316;
	}
yy323:
	++YYCURSOR;
	head->cond = (jwl_http_scanner_condition_head_body);
#line 394 "jwl/jwl_http.l"
	{																						;goto yyc_head_body;}
#line 1970 "jwl/jwl_http.c"
yy325:
	++YYCURSOR;
#line 393 "jwl/jwl_http.l"
	{																						;goto yyc_head_conn;}
#line 1975 "jwl/jwl_http.c"
yy327:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'g':	goto yy331;
	default:	goto yy316;
	}
yy328:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'o':	goto yy332;
	default:	goto yy316;
	}
yy329:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'e':	goto yy333;
	default:	goto yy316;
	}
yy330:
	yych = *++YYCURSOR;
	switch (yych) {
	case '-':	goto yy334;
	default:	goto yy316;
	}
yy331:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'r':	goto yy335;
	default:	goto yy316;
	}
yy332:
	yych = *++YYCURSOR;
	switch (yych) {
	case 's':	goto yy336;
	default:	goto yy316;
	}
yy333:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'p':	goto yy337;
	default:	goto yy316;
	}
yy334:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'c':	goto yy338;
	default:	goto yy316;
	}
yy335:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'a':	goto yy339;
	default:	goto yy316;
	}
yy336:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'e':	goto yy340;
	default:	goto yy316;
	}
yy337:
	yych = *++YYCURSOR;
	switch (yych) {
	case '-':	goto yy342;
	default:	goto yy316;
	}
yy338:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'a':	goto yy343;
	default:	goto yy316;
	}
yy339:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'd':	goto yy344;
	default:	goto yy316;
	}
yy340:
	++YYCURSOR;
#line 391 "jwl/jwl_http.l"
	{head->connection		|=JWL_HTTP_CONNECTION_CLOSE										;goto yyc_head_conn;}
#line 2058 "jwl/jwl_http.c"
yy342:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'a':	goto yy345;
	default:	goto yy316;
	}
yy343:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'c':	goto yy346;
	default:	goto yy316;
	}
yy344:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'e':	goto yy347;
	default:	goto yy316;
	}
yy345:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'l':	goto yy349;
	default:	goto yy316;
	}
yy346:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'h':	goto yy350;
	default:	goto yy316;
	}
yy347:
	++YYCURSOR;
#line 392 "jwl/jwl_http.l"
	{head->connection		|=JWL_HTTP_CONNECTION_UPGRADE									;goto yyc_head_conn;}
#line 2093 "jwl/jwl_http.c"
yy349:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'i':	goto yy351;
	default:	goto yy316;
	}
yy350:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'e':	goto yy352;
	default:	goto yy316;
	}
yy351:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'v':	goto yy354;
	default:	goto yy316;
	}
yy352:
	++YYCURSOR;
#line 448 "jwl/jwl_http.l"
	{head->cache			=JWL_HTTP_CACHE_NO												;goto yyc_head_cache;}
#line 2116 "jwl/jwl_http.c"
yy354:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'e':	goto yy355;
	default:	goto yy316;
	}
yy355:
	++YYCURSOR;
#line 390 "jwl/jwl_http.l"
	{head->connection		|=JWL_HTTP_CONNECTION_KEEP_ALIVE								;goto yyc_head_conn;}
#line 2127 "jwl/jwl_http.c"
/* *********************************** */
yyc_head_tren:
	yych = *YYCURSOR;
	switch (yych) {
	case '\r':	goto yy360;
	case ',':	goto yy361;
	case 'c':	goto yy362;
	case 'd':	goto yy363;
	case 'g':	goto yy364;
	case 'i':	goto yy365;
	default:	goto yy359;
	}
yy359:
yy360:
	yych = *++YYCURSOR;
	switch (yych) {
	case '\n':	goto yy366;
	default:	goto yy359;
	}
yy361:
	yych = *++YYCURSOR;
	switch (yych) {
	case ' ':	goto yy368;
	default:	goto yy359;
	}
yy362:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'h':	goto yy370;
	case 'o':	goto yy371;
	default:	goto yy359;
	}
yy363:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'e':	goto yy372;
	default:	goto yy359;
	}
yy364:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'z':	goto yy373;
	default:	goto yy359;
	}
yy365:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'd':	goto yy374;
	default:	goto yy359;
	}
yy366:
	++YYCURSOR;
	head->cond = (jwl_http_scanner_condition_head_body);
#line 403 "jwl/jwl_http.l"
	{																						;goto yyc_head_body;}
#line 2183 "jwl/jwl_http.c"
yy368:
	++YYCURSOR;
#line 402 "jwl/jwl_http.l"
	{																						;goto yyc_head_tren;}
#line 2188 "jwl/jwl_http.c"
yy370:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'u':	goto yy375;
	default:	goto yy359;
	}
yy371:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'm':	goto yy376;
	default:	goto yy359;
	}
yy372:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'f':	goto yy377;
	default:	goto yy359;
	}
yy373:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'i':	goto yy378;
	default:	goto yy359;
	}
yy374:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'e':	goto yy379;
	default:	goto yy359;
	}
yy375:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'n':	goto yy380;
	default:	goto yy359;
	}
yy376:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'p':	goto yy381;
	default:	goto yy359;
	}
yy377:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'l':	goto yy382;
	default:	goto yy359;
	}
yy378:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'p':	goto yy383;
	default:	goto yy359;
	}
yy379:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'n':	goto yy385;
	default:	goto yy359;
	}
yy380:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'k':	goto yy386;
	default:	goto yy359;
	}
yy381:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'r':	goto yy387;
	default:	goto yy359;
	}
yy382:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'a':	goto yy388;
	default:	goto yy359;
	}
yy383:
	++YYCURSOR;
#line 400 "jwl/jwl_http.l"
	{head->tren				|=JWL_HTTP_TREN_GZIP											;goto yyc_head_tren;}
#line 2271 "jwl/jwl_http.c"
yy385:
	yych = *++YYCURSOR;
	switch (yych) {
	case 't':	goto yy389;
	default:	goto yy359;
	}
yy386:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'e':	goto yy390;
	default:	goto yy359;
	}
yy387:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'e':	goto yy391;
	default:	goto yy359;
	}
yy388:
	yych = *++YYCURSOR;
	switch (yych) {
	case 't':	goto yy392;
	default:	goto yy359;
	}
yy389:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'i':	goto yy393;
	default:	goto yy359;
	}
yy390:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'd':	goto yy394;
	default:	goto yy359;
	}
yy391:
	yych = *++YYCURSOR;
	switch (yych) {
	case 's':	goto yy396;
	default:	goto yy359;
	}
yy392:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'e':	goto yy397;
	default:	goto yy359;
	}
yy393:
	yych = *++YYCURSOR;
	switch (yych) {
	case 't':	goto yy399;
	default:	goto yy359;
	}
yy394:
	++YYCURSOR;
#line 397 "jwl/jwl_http.l"
	{head->tren				|=JWL_HTTP_TREN_CHUNKED											;goto yyc_head_tren;}
#line 2330 "jwl/jwl_http.c"
yy396:
	yych = *++YYCURSOR;
	switch (yych) {
	case 's':	goto yy400;
	default:	goto yy359;
	}
yy397:
	++YYCURSOR;
#line 399 "jwl/jwl_http.l"
	{head->tren				|=JWL_HTTP_TREN_DEFLATE											;goto yyc_head_tren;}
#line 2341 "jwl/jwl_http.c"
yy399:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'y':	goto yy402;
	default:	goto yy359;
	}
yy400:
	++YYCURSOR;
#line 398 "jwl/jwl_http.l"
	{head->tren				|=JWL_HTTP_TREN_COMPRESS										;goto yyc_head_tren;}
#line 2352 "jwl/jwl_http.c"
yy402:
	++YYCURSOR;
#line 401 "jwl/jwl_http.l"
	{head->tren				|=JWL_HTTP_TREN_IDENTITY										;goto yyc_head_tren;}
#line 2357 "jwl/jwl_http.c"
/* *********************************** */
yyc_head_upgrade:
	yych = *YYCURSOR;
	switch (yych) {
	case '\r':	goto yy407;
	case 'w':	goto yy408;
	default:	goto yy406;
	}
yy406:
yy407:
	yych = *++YYCURSOR;
	switch (yych) {
	case '\n':	goto yy409;
	default:	goto yy406;
	}
yy408:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'e':	goto yy411;
	default:	goto yy406;
	}
yy409:
	++YYCURSOR;
	head->cond = (jwl_http_scanner_condition_head_body);
#line 407 "jwl/jwl_http.l"
	{																						;goto yyc_head_body;}
#line 2384 "jwl/jwl_http.c"
yy411:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'b':	goto yy412;
	default:	goto yy406;
	}
yy412:
	yych = *++YYCURSOR;
	switch (yych) {
	case 's':	goto yy413;
	default:	goto yy406;
	}
yy413:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'o':	goto yy414;
	default:	goto yy406;
	}
yy414:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'c':	goto yy415;
	default:	goto yy406;
	}
yy415:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'k':	goto yy416;
	default:	goto yy406;
	}
yy416:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'e':	goto yy417;
	default:	goto yy406;
	}
yy417:
	yych = *++YYCURSOR;
	switch (yych) {
	case 't':	goto yy418;
	default:	goto yy406;
	}
yy418:
	++YYCURSOR;
#line 406 "jwl/jwl_http.l"
	{head->upgrade			=JWL_HTTP_UPGRADE_WEBSOCKET										;goto yyc_head_upgrade;}
#line 2431 "jwl/jwl_http.c"
/* *********************************** */
yyc_head_range_s:
	yych = *YYCURSOR;
	switch (yych) {
	case '\r':	goto yy423;
	case '-':	goto yy424;
	case '0':
	case '1':
	case '2':
	case '3':
	case '4':
	case '5':
	case '6':
	case '7':
	case '8':
	case '9':	goto yy426;
	default:	goto yy422;
	}
yy422:
yy423:
	yych = *++YYCURSOR;
	switch (yych) {
	case '\n':	goto yy428;
	default:	goto yy422;
	}
yy424:
	++YYCURSOR;
	head->cond = (jwl_http_scanner_condition_head_range_e);
#line 410 "jwl/jwl_http.l"
	{head->range.end		=0																;goto yyc_head_range_e;}
#line 2462 "jwl/jwl_http.c"
yy426:
	++YYCURSOR;
#line 411 "jwl/jwl_http.l"
	{head->range.start		=(head->range.start<<3)+(head->range.start<<1)+*(YYCURSOR-1)-'0';goto yyc_head_range_s;}
#line 2467 "jwl/jwl_http.c"
yy428:
	++YYCURSOR;
	head->cond = (jwl_http_scanner_condition_head_body);
#line 412 "jwl/jwl_http.l"
	{																						;goto yyc_head_body;}
#line 2473 "jwl/jwl_http.c"
/* *********************************** */
yyc_head_range_e:
	yych = *YYCURSOR;
	switch (yych) {
	case '\r':	goto yy433;
	case '0':
	case '1':
	case '2':
	case '3':
	case '4':
	case '5':
	case '6':
	case '7':
	case '8':
	case '9':	goto yy434;
	default:	goto yy432;
	}
yy432:
yy433:
	yych = *++YYCURSOR;
	switch (yych) {
	case '\n':	goto yy436;
	default:	goto yy432;
	}
yy434:
	++YYCURSOR;
#line 413 "jwl/jwl_http.l"
	{head->range.end		=(head->range.end<<3)+(head->range.end<<1)+*(YYCURSOR-1)-'0'	;goto yyc_head_range_e;}
#line 2502 "jwl/jwl_http.c"
yy436:
	++YYCURSOR;
	head->cond = (jwl_http_scanner_condition_head_body);
#line 414 "jwl/jwl_http.l"
	{head->range.end		=(head->range.end)?(head->range.end+1):0						;goto yyc_head_body;}
#line 2508 "jwl/jwl_http.c"
/* *********************************** */
yyc_head_accept:
	yych = *(YYMARKER = YYCURSOR);
	switch (yych) {
	case '\r':	goto yy441;
	default:	goto yy440;
	}
yy440:
#line 417 "jwl/jwl_http.l"
	{																						;++YYCURSOR;goto yyc_head_accept;}
#line 2519 "jwl/jwl_http.c"
yy441:
	yych = *++YYCURSOR;
	switch (yych) {
	case '\n':	goto yy443;
	default:	goto yy442;
	}
yy442:
	YYCURSOR = YYMARKER;
	goto yy440;
yy443:
	++YYCURSOR;
	head->cond = (jwl_http_scanner_condition_head_body);
#line 418 "jwl/jwl_http.l"
	{																						;goto yyc_head_body;}
#line 2534 "jwl/jwl_http.c"
/* *********************************** */
yyc_head_acen:
	yych = *(YYMARKER = YYCURSOR);
	switch (yych) {
	case '\r':	goto yy448;
	default:	goto yy447;
	}
yy447:
#line 421 "jwl/jwl_http.l"
	{																						;++YYCURSOR;goto yyc_head_acen;}
#line 2545 "jwl/jwl_http.c"
yy448:
	yych = *++YYCURSOR;
	switch (yych) {
	case '\n':	goto yy450;
	default:	goto yy449;
	}
yy449:
	YYCURSOR = YYMARKER;
	goto yy447;
yy450:
	++YYCURSOR;
	head->cond = (jwl_http_scanner_condition_head_body);
#line 422 "jwl/jwl_http.l"
	{																						;goto yyc_head_body;}
#line 2560 "jwl/jwl_http.c"
/* *********************************** */
yyc_head_aclan:
	yych = *(YYMARKER = YYCURSOR);
	switch (yych) {
	case '\r':	goto yy455;
	default:	goto yy454;
	}
yy454:
#line 425 "jwl/jwl_http.l"
	{																						;++YYCURSOR;goto yyc_head_aclan;}
#line 2571 "jwl/jwl_http.c"
yy455:
	yych = *++YYCURSOR;
	switch (yych) {
	case '\n':	goto yy457;
	default:	goto yy456;
	}
yy456:
	YYCURSOR = YYMARKER;
	goto yy454;
yy457:
	++YYCURSOR;
	head->cond = (jwl_http_scanner_condition_head_body);
#line 426 "jwl/jwl_http.l"
	{																						;goto yyc_head_body;}
#line 2586 "jwl/jwl_http.c"
/* *********************************** */
yyc_head_cookie:
	yych = *(YYMARKER = YYCURSOR);
	switch (yych) {
	case '\r':	goto yy462;
	case '=':	goto yy464;
	default:	goto yy461;
	}
yy461:
#line 429 "jwl/jwl_http.l"
	{tmp_key				=jbl_string_add_char(tmp_key,*YYCURSOR)		;++YYCURSOR;		;goto yyc_head_cookie;}
#line 2598 "jwl/jwl_http.c"
yy462:
	yych = *++YYCURSOR;
	switch (yych) {
	case '\n':	goto yy466;
	default:	goto yy463;
	}
yy463:
	YYCURSOR = YYMARKER;
	goto yy461;
yy464:
	++YYCURSOR;
	head->cond = (jwl_http_scanner_condition_head_cookiev);
#line 430 "jwl/jwl_http.l"
	{tmp_var				=jbl_var_free(tmp_var)			;tmp_var=jbl_Vstring_new()		;goto yyc_head_cookiev;}
#line 2613 "jwl/jwl_http.c"
yy466:
	++YYCURSOR;
	head->cond = (jwl_http_scanner_condition_head_body);
#line 431 "jwl/jwl_http.l"
	{tmp_key				=jbl_string_free    (tmp_key)	;								;goto yyc_head_body;}
#line 2619 "jwl/jwl_http.c"
/* *********************************** */
yyc_head_cookiev:
	yych = *(YYMARKER = YYCURSOR);
	switch (yych) {
	case '\r':	goto yy471;
	case ';':	goto yy473;
	default:	goto yy470;
	}
yy470:
#line 432 "jwl/jwl_http.l"
	{tmp_var				=jbl_V(jbl_string_add_char(jbl_Vstring(tmp_var),*YYCURSOR))		;++YYCURSOR;goto yyc_head_cookiev;}
#line 2631 "jwl/jwl_http.c"
yy471:
	yych = *++YYCURSOR;
	switch (yych) {
	case '\n':	goto yy474;
	default:	goto yy472;
	}
yy472:
	YYCURSOR = YYMARKER;
	goto yy470;
yy473:
	yych = *++YYCURSOR;
	switch (yych) {
	case ' ':	goto yy476;
	default:	goto yy472;
	}
yy474:
	++YYCURSOR;
	head->cond = (jwl_http_scanner_condition_head_body);
#line 434 "jwl/jwl_http.l"
	{head->cookie			=jbl_ht_insert(head->cookie,tmp_key,tmp_var);tmp_key=jbl_string_free(tmp_key);tmp_var=jbl_var_free(tmp_var);			;goto yyc_head_body;}
#line 2652 "jwl/jwl_http.c"
yy476:
	++YYCURSOR;
	head->cond = (jwl_http_scanner_condition_head_cookie);
#line 433 "jwl/jwl_http.l"
	{head->cookie			=jbl_ht_insert(head->cookie,tmp_key,tmp_var);tmp_key=jbl_string_free(tmp_key);tmp_var=jbl_var_free(tmp_var);			;goto yyc_head_cookie;}
#line 2658 "jwl/jwl_http.c"
/* *********************************** */
yyc_head_ct:
	yych = *(YYMARKER = YYCURSOR);
	switch (yych) {
	case '\r':	goto yy481;
	case ';':	goto yy483;
	default:	goto yy480;
	}
yy480:
#line 437 "jwl/jwl_http.l"
	{tmp_key				=jbl_string_add_char(tmp_key,*YYCURSOR)		;++YYCURSOR			;goto yyc_head_ct;}
#line 2670 "jwl/jwl_http.c"
yy481:
	yych = *++YYCURSOR;
	switch (yych) {
	case '\n':	goto yy485;
	default:	goto yy482;
	}
yy482:
	YYCURSOR = YYMARKER;
	goto yy480;
yy483:
	yych = *++YYCURSOR;
	switch (yych) {
	case ' ':	goto yy483;
	case 'c':	goto yy487;
	default:	goto yy482;
	}
yy485:
	++YYCURSOR;
	head->cond = (jwl_http_scanner_condition_head_body);
#line 439 "jwl/jwl_http.l"
	{head->content_type		=jbl_file_get_ctid_by_ct(tmp_key);tmp_key=jbl_string_free(tmp_key);goto yyc_head_body;}
#line 2692 "jwl/jwl_http.c"
yy487:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'h':	goto yy488;
	default:	goto yy482;
	}
yy488:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'a':	goto yy489;
	default:	goto yy482;
	}
yy489:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'r':	goto yy490;
	default:	goto yy482;
	}
yy490:
	yych = *++YYCURSOR;
	switch (yych) {
	case 's':	goto yy491;
	default:	goto yy482;
	}
yy491:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'e':	goto yy492;
	default:	goto yy482;
	}
yy492:
	yych = *++YYCURSOR;
	switch (yych) {
	case 't':	goto yy493;
	default:	goto yy482;
	}
yy493:
	yych = *++YYCURSOR;
	switch (yych) {
	case '=':	goto yy494;
	default:	goto yy482;
	}
yy494:
	++YYCURSOR;
	head->cond = (jwl_http_scanner_condition_head_cs);
#line 438 "jwl/jwl_http.l"
	{head->content_type		=jbl_file_get_ctid_by_ct(tmp_key);tmp_key=jbl_string_free(tmp_key);goto yyc_head_cs;}
#line 2740 "jwl/jwl_http.c"
/* *********************************** */
yyc_head_cs:
	yych = *YYCURSOR;
	switch (yych) {
	case '\r':	goto yy499;
	case 'U':	goto yy500;
	default:	goto yy498;
	}
yy498:
yy499:
	yych = *++YYCURSOR;
	switch (yych) {
	case '\n':	goto yy501;
	default:	goto yy498;
	}
yy500:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'T':	goto yy503;
	default:	goto yy498;
	}
yy501:
	++YYCURSOR;
	head->cond = (jwl_http_scanner_condition_head_body);
#line 441 "jwl/jwl_http.l"
	{																						;goto yyc_head_body;}
#line 2767 "jwl/jwl_http.c"
yy503:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'F':	goto yy504;
	default:	goto yy498;
	}
yy504:
	yych = *++YYCURSOR;
	switch (yych) {
	case '-':	goto yy505;
	default:	goto yy498;
	}
yy505:
	yych = *++YYCURSOR;
	switch (yych) {
	case '8':	goto yy506;
	default:	goto yy498;
	}
yy506:
	++YYCURSOR;
#line 440 "jwl/jwl_http.l"
	{head->charset			=JWL_HTTP_CHARSET_UTF8											;goto yyc_head_cs;}
#line 2790 "jwl/jwl_http.c"
/* *********************************** */
yyc_head_cache:
	yych = *(YYMARKER = YYCURSOR);
	switch (yych) {
	case '\r':	goto yy511;
	default:	goto yy510;
	}
yy510:
#line 449 "jwl/jwl_http.l"
	{																						;++YYCURSOR;goto yyc_head_cache;}
#line 2801 "jwl/jwl_http.c"
yy511:
	yych = *++YYCURSOR;
	switch (yych) {
	case '\n':	goto yy513;
	default:	goto yy512;
	}
yy512:
	YYCURSOR = YYMARKER;
	goto yy510;
yy513:
	++YYCURSOR;
	head->cond = (jwl_http_scanner_condition_head_body);
#line 450 "jwl/jwl_http.l"
	{																						;goto yyc_head_body;}
#line 2816 "jwl/jwl_http.c"
/* *********************************** */
yyc_special_key:
	yych = *(YYMARKER = YYCURSOR);
	switch (yych) {
	case '\r':	goto yy518;
	case ':':	goto yy520;
	default:	goto yy517;
	}
yy517:
#line 454 "jwl/jwl_http.l"
	{tmp_key				=jbl_string_add_char(tmp_key,*YYCURSOR)		;++YYCURSOR;					;goto yyc_special_key;}
#line 2828 "jwl/jwl_http.c"
yy518:
	yych = *++YYCURSOR;
	switch (yych) {
	case '\n':	goto yy523;
	default:	goto yy519;
	}
yy519:
	YYCURSOR = YYMARKER;
	goto yy517;
yy520:
	yych = *++YYCURSOR;
	switch (yych) {
	case ' ':	goto yy520;
	default:	goto yy522;
	}
yy522:
	head->cond = (jwl_http_scanner_condition_special_var);
#line 456 "jwl/jwl_http.l"
	{tmp_var				=jbl_var_free(tmp_var)		;tmp_var=jbl_Vstring_new();						;goto yyc_special_var;}
#line 2848 "jwl/jwl_http.c"
yy523:
	++YYCURSOR;
	head->cond = (jwl_http_scanner_condition_head_body);
#line 455 "jwl/jwl_http.l"
	{tmp_key				=jbl_string_free(tmp_key)	;tmp_var=jbl_var_free(tmp_var);					;goto yyc_head_body;}
#line 2854 "jwl/jwl_http.c"
/* *********************************** */
yyc_special_var:
	yych = *(YYMARKER = YYCURSOR);
	switch (yych) {
	case '\r':	goto yy528;
	default:	goto yy527;
	}
yy527:
#line 457 "jwl/jwl_http.l"
	{tmp_var				=jbl_V(jbl_string_add_char(jbl_Vstring(tmp_var),*YYCURSOR))		;++YYCURSOR	;goto yyc_special_var;}
#line 2865 "jwl/jwl_http.c"
yy528:
	yych = *++YYCURSOR;
	switch (yych) {
	case '\n':	goto yy530;
	default:	goto yy529;
	}
yy529:
	YYCURSOR = YYMARKER;
	goto yy527;
yy530:
	++YYCURSOR;
	head->cond = (jwl_http_scanner_condition_head_body);
#line 458 "jwl/jwl_http.l"
	{head->v				=jbl_ht_insert(head->v,tmp_key,tmp_var);tmp_key=jbl_string_free(tmp_key);tmp_var=jbl_var_free(tmp_var);			;goto yyc_head_body;}
#line 2880 "jwl/jwl_http.c"
/* *********************************** */
yyc_head_ignore:
	yych = *(YYMARKER = YYCURSOR);
	switch (yych) {
	case '\r':	goto yy535;
	default:	goto yy534;
	}
yy534:
#line 463 "jwl/jwl_http.l"
	{																						;++YYCURSOR;goto yyc_head_ignore;}
#line 2891 "jwl/jwl_http.c"
yy535:
	yych = *++YYCURSOR;
	switch (yych) {
	case '\n':	goto yy537;
	default:	goto yy536;
	}
yy536:
	YYCURSOR = YYMARKER;
	goto yy534;
yy537:
	++YYCURSOR;
	head->cond = (jwl_http_scanner_condition_head_body);
#line 464 "jwl/jwl_http.l"
	{																						;goto yyc_head_body;}
#line 2906 "jwl/jwl_http.c"
}
#line 471 "jwl/jwl_http.l"

	#undef YYCTYPE	


	return head;
}


#if JBL_STREAM_ENABLE==1
jbl_stream *jwl_http_encode_stream_new(jwl_http_head* head)
{
	if(!head)jbl_exception("NULL POINTER");
	jbl_stream *this=jbl_stream_new(&jwl_http_encode_stream_operaters,head,JWL_SOCKET_STREAM_BUF_LENGTH,NULL,1);
	return this;
}
void __jwl_http_encode_stream_operater(jbl_stream* this,jbl_uint8 flags)
{
	if(!this)jbl_exception("NULL POINTER");	
	this=jbl_refer_pull(this);
	jbl_stream* nxt=jbl_refer_pull(this->nxt);
	jwl_http_head *head=jbl_refer_pull((jwl_http_head*)this->data);
	if(nxt&&((flags&jbl_stream_force)||(this->en>JWL_SOCKET_STREAM_BUF_LENGTH>>1)))
	{
		if(!this->extra[0].c8[0])
			jwl_http_head_encode(head,nxt),this->extra[0].c8[0]=1;
		for(jbl_stream_buf_size_type i=0;i<this->en;)
		{
			jbl_stream_buf_size_type len=jbl_min(this->en-i,nxt->size-nxt->en-(head->tren&JWL_HTTP_TREN_CHUNKED?16:0));
			if(head->tren&JWL_HTTP_TREN_CHUNKED)jbl_stream_push_hex(nxt,len),jbl_stream_push_char(nxt,'\r'),jbl_stream_push_char(nxt,'\n');
			jbl_memory_copy(nxt->buf+nxt->en,this->buf+i,len);
			i+=len;
			nxt->en+=len;
			if(head->tren&JWL_HTTP_TREN_CHUNKED)jbl_stream_push_char(nxt,'\r'),jbl_stream_push_char(nxt,'\n');
			jbl_stream_do(nxt,0);
		}
		this->en=0;
		if(flags&jbl_stream_force)
			jbl_stream_push_chars(nxt,UC"0\r\n\r\n"),jbl_stream_do(nxt,flags);
	}
}
jbl_stream_operators_new(jwl_http_encode_stream_operaters,__jwl_http_encode_stream_operater,jwl_http_head_free,NULL);



jwl_http_head* jwl_http_head_view_put(jwl_http_head* this,jbl_stream *out,jbl_uint8 format,jbl_uint32 tabs,jbl_uint32 line,unsigned char * varname,unsigned char * func,unsigned char * file)
{
	jwl_http_head* thi;if(jbl_stream_view_put_format(thi=jbl_refer_pull(this),out,format,tabs,UC"jwl_http_head",line,varname,func,file)){jbl_stream_push_char(out,'\n');return this;}
	jbl_stream_push_char(out,'\n');
	++tabs;
	char * type			[]={"response","request"};
	char * charset		[]={"","UTF-8"};
	char * method		[]={"","get","post"};
	char * protocol		[]={"","HTTP/1.1"};
	char * connection	[]={"","keep alive","close","upgrade"};
	char * cache		[]={"","no","max age,"};
	char * upgrade		[]={"","websocket"};
	char * tren			[]={"","chunked","compress","deflate","gzip","identity"};
		for(jbl_int32 j=0;j<tabs;jbl_stream_push_char(out,'\t'),++j);	jbl_stream_push_chars(out,UC"type         :");jbl_stream_push_chars(out,UC type			[jwl_http_head_is_request(this)?1:0])	;jbl_stream_push_char(out,'\n');
	if(jwl_http_head_is_request(this))
	{
		for(jbl_int32 j=0;j<tabs;jbl_stream_push_char(out,'\t'),++j);	jbl_stream_push_chars(out,UC"method       :");jbl_stream_push_chars(out,UC method		[thi->method])						;jbl_stream_push_char(out,'\n');	
		for(jbl_int32 j=0;j<tabs;jbl_stream_push_char(out,'\t'),++j);	jbl_stream_push_chars(out,UC"url          :");jbl_stream_push_string(out,thi->url)											;jbl_stream_push_char(out,'\n');	
	}
	if(jwl_http_head_is_response(this))
	{
		for(jbl_int32 j=0;j<tabs;jbl_stream_push_char(out,'\t'),++j);	jbl_stream_push_chars(out,UC"status       :");jbl_stream_push_uint(out,thi->status)											;jbl_stream_push_char(out,'\n');
	}
	
	for(jbl_int32 j=0;j<tabs;jbl_stream_push_char(out,'\t'),++j);	jbl_stream_push_chars(out,UC"length       :");jbl_stream_push_uint(out,thi->len)											;jbl_stream_push_char(out,'\n');
	for(jbl_int32 j=0;j<tabs;jbl_stream_push_char(out,'\t'),++j);	jbl_stream_push_chars(out,UC"protocol     :");jbl_stream_push_chars(out,UC protocol		[thi->protocol])					;jbl_stream_push_char(out,'\n');	
	for(jbl_int32 j=0;j<tabs;jbl_stream_push_char(out,'\t'),++j);	jbl_stream_push_chars(out,UC"charset      :");jbl_stream_push_chars(out,UC charset		[thi->charset])						;jbl_stream_push_char(out,'\n');
	for(jbl_int32 j=0;j<tabs;jbl_stream_push_char(out,'\t'),++j);	jbl_stream_push_chars(out,UC"upgrade      :");jbl_stream_push_chars(out,UC upgrade		[thi->upgrade])						;jbl_stream_push_char(out,'\n');	
	for(jbl_int32 j=0;j<tabs;jbl_stream_push_char(out,'\t'),++j);	jbl_stream_push_chars(out,UC"cache        :");jbl_stream_push_chars(out,UC cache		[thi->cache])						;if(thi->cache==JWL_HTTP_CACHE_MAX_AGE){jbl_stream_push_uint(out,thi->cache_max_age);}	;jbl_stream_push_char(out,'\n');	
	for(jbl_int32 j=0;j<tabs;jbl_stream_push_char(out,'\t'),++j);	jbl_stream_push_chars(out,UC"range        :");jbl_stream_push_uint(out,thi->range.start)									;jbl_stream_push_char(out,'-' );	jbl_stream_push_uint(out,thi->range.end)			;jbl_stream_push_char(out,'\n');	
	for(jbl_int32 j=0;j<tabs;jbl_stream_push_char(out,'\t'),++j);	jbl_stream_push_chars(out,UC"etag         :");jbl_stream_push_string(out,thi->etag)											;jbl_stream_push_char(out,'\n');
	for(jbl_int32 j=0;j<tabs;jbl_stream_push_char(out,'\t'),++j);	jbl_stream_push_chars(out,UC"host         :");jbl_stream_push_string(out,thi->host)											;jbl_stream_push_char(out,'\n');	
	for(jbl_int32 j=0;j<tabs;jbl_stream_push_char(out,'\t'),++j);	jbl_stream_push_chars(out,UC"content type :");jbl_stream_push_chars(out,jbl_file_get_ct_chars_by_ctid(thi->content_type))	;jbl_stream_push_char(out,'\n');
	for(jbl_int32 j=0;j<tabs;jbl_stream_push_char(out,'\t'),++j);	jbl_stream_push_chars(out,UC"filename     :");jbl_stream_push_string(out,thi->filename)										;jbl_stream_push_char(out,'\n');
	for(jbl_int32 j=0;j<tabs;jbl_stream_push_char(out,'\t'),++j);	jbl_stream_push_chars(out,UC"user agent   :");jbl_stream_push_string(out,thi->ua)											;jbl_stream_push_char(out,'\n');	
	for(jbl_int32 j=0;j<tabs;jbl_stream_push_char(out,'\t'),++j);	jbl_stream_push_chars(out,UC"referer      :");jbl_stream_push_string(out,thi->referer)										;jbl_stream_push_char(out,'\n');
	for(jbl_int32 j=0;j<tabs;jbl_stream_push_char(out,'\t'),++j);	jbl_stream_push_chars(out,UC"connection   :");
	if(!thi->connection)
		jbl_stream_push_chars(out,UC connection	[0]);
	else 
	{
		if(thi->connection&JWL_HTTP_CONNECTION_KEEP_ALIVE	)jbl_stream_push_chars(out,UC connection[1]),jbl_stream_push_char(out,',');
		if(thi->connection&JWL_HTTP_CONNECTION_CLOSE		)jbl_stream_push_chars(out,UC connection[2]),jbl_stream_push_char(out,',');
		if(thi->connection&JWL_HTTP_CONNECTION_UPGRADE		)jbl_stream_push_chars(out,UC connection[3]),jbl_stream_push_char(out,',');
	}
	jbl_stream_push_char(out,'\n');	
	for(jbl_int32 j=0;j<tabs;jbl_stream_push_char(out,'\t'),++j);	jbl_stream_push_chars(out,UC"tren         :");
	if(!thi->tren)
		jbl_stream_push_chars(out,UC connection	[0]);
	else 
	{
		if(thi->tren&JWL_HTTP_TREN_CHUNKED	)jbl_stream_push_chars(out,UC tren[1]),jbl_stream_push_char(out,',');
		if(thi->tren&JWL_HTTP_TREN_COMPRESS	)jbl_stream_push_chars(out,UC tren[2]),jbl_stream_push_char(out,',');
		if(thi->tren&JWL_HTTP_TREN_DEFLATE	)jbl_stream_push_chars(out,UC tren[3]),jbl_stream_push_char(out,',');
		if(thi->tren&JWL_HTTP_TREN_GZIP		)jbl_stream_push_chars(out,UC tren[4]),jbl_stream_push_char(out,',');
		if(thi->tren&JWL_HTTP_TREN_IDENTITY	)jbl_stream_push_chars(out,UC tren[5]),jbl_stream_push_char(out,',');
	}
	jbl_stream_push_char(out,'\n');	
			

	if(thi->parameter)
	{
		for(jbl_int32 j=0;j<tabs;jbl_stream_push_char(out,'\t'),++j);	jbl_stream_push_chars(out,UC"parameter    :");																				;jbl_stream_push_char(out,'\n');
		++tabs;
		jbl_ht_foreach(thi->parameter,i)
		{
			for(jbl_int32 j=0;j<tabs;jbl_stream_push_char(out,'\t'),++j);//格式化的\t
			jbl_stream_push_string(out,i->k);
			for(jbl_int32 j=jbl_string_get_length(i->k);j<13;jbl_stream_push_char(out,' '),++j);//格式化的\t
			jbl_stream_push_char(out,':');
			if(Vis_jbl_string(i->v))jbl_stream_push_string(out,jbl_Vstring(i->v)),jbl_stream_push_char(out,'\n');	
			else					jbl_var_view_put(i->v,out,0,tabs,0,NULL,NULL,NULL);
		}		
		--tabs;
	}
	if(thi->cookie)
	{
		for(jbl_int32 j=0;j<tabs;jbl_stream_push_char(out,'\t'),++j);	jbl_stream_push_chars(out,UC"cookie       :");																				;jbl_stream_push_char(out,'\n');
		++tabs;
		jbl_ht_foreach(thi->cookie,i)
		{
			for(jbl_int32 j=0;j<tabs;jbl_stream_push_char(out,'\t'),++j);//格式化的\t
			jbl_stream_push_string(out,i->k);
			for(jbl_int32 j=jbl_string_get_length(i->k);j<13;jbl_stream_push_char(out,' '),++j);//格式化的\t
			jbl_stream_push_char(out,':');
			if(Vis_jbl_string(i->v))jbl_stream_push_string(out,jbl_Vstring(i->v)),jbl_stream_push_char(out,'\n');	
			else					jbl_var_view_put(i->v,out,0,tabs,0,NULL,NULL,NULL);
		}		
		--tabs;
	}
	if(thi->v)
		jbl_ht_foreach(thi->v,i)
		{
			for(jbl_int32 j=0;j<tabs;jbl_stream_push_char(out,'\t'),++j);//格式化的\t
			jbl_stream_push_string(out,i->k);
			for(jbl_int32 j=jbl_string_get_length(i->k);j<13;jbl_stream_push_char(out,' '),++j);//格式化的\t
			jbl_stream_push_char(out,':');
			if(Vis_jbl_string(i->v))jbl_stream_push_string(out,jbl_Vstring(i->v)),jbl_stream_push_char(out,'\n');	
			else					jbl_var_view_put(i->v,out,0,tabs,0,NULL,NULL,NULL);
		}
	return this;
}
#endif




#endif
