/* Generated by re2c 1.3 on Tue Aug 18 14:51:33 2020 */
#line 1 "jwl/jwl_http.l"
/* Copyright (c) [2019] juruoyun developer team
   Juruoyun web lib is licensed under the Mulan PSL v1.
   You can use this software according to the terms and conditions of the Mulan PSL v1.
   You may obtain a copy of Mulan PSL v1 at:
      http://license.coscl.org.cn/MulanPSL
   THIS SOFTWARE IS PROVIDED ON AN "AS IS" BASIS, WITHOUT WARRANTIES OF ANY KIND, EITHER EXPRESS OR
   IMPLIED, INCLUDING BUT NOT LIMITED TO NON-INFRINGEMENT, MERCHANTABILITY OR FIT FOR A PARTICULAR
   PURPOSE.
   See the Mulan PSL v1 for more details.*/
#include "jwl_http.h"
#if JWL_HTTP_ENABLE==1
jwl_http_head *jwl_http_head_new()
{
	return jwl_http_head_init(jbl_malloc(sizeof(jwl_http_head)));
}
jwl_http_head *jwl_http_head_init(jwl_http_head * this)
{
	if(!this)jbl_exception("NULL POINTER");		
	jbl_gc_init(this);
	jbl_gc_plus(this);
	jwl_http_head_set_response(this);
	this->status		=0;
	this->charset		=0;	
	
	this->method		=0;
	this->protocol		=0;
	
	this->connection	=0;
	this->cache			=0;
	this->upgrade		=0;
	this->cache_max_age	=0;	
	this->range.start	=0;	
	this->range.end		=0;	
	this->etag			=NULL;

//jbl_string
	this->content_type	=NULL;
	this->filename		=NULL;

	this->url			=NULL;
	this->host			=NULL;
	this->ua			=NULL;
	this->referer		=NULL;
//jbl_ht
	this->cookie		=NULL;
	this->v				=NULL;	

	this->cond			=0;	
	return this;
}
jwl_http_head *jwl_http_head_free(jwl_http_head * this)
{
	if(!this)return NULL;
	jbl_gc_minus(this);
	if(!jbl_gc_refcnt(this))
	{
		if(jbl_gc_is_ref(this))
			jwl_http_head_free((jwl_http_head*)(((jbl_reference*)this)->ptr));
		else
		{
			this->etag			=jbl_string_free(this->etag);
			
			this->content_type	=jbl_string_free(this->content_type);
			this->filename		=jbl_string_free(this->filename);
			
			this->url			=jbl_string_free(this->url);
			this->host			=jbl_string_free(this->host);
			this->ua			=jbl_string_free(this->ua);
			this->referer		=jbl_string_free(this->referer);
			this->v				=jbl_ht_free	(this->v);
			this->cookie		=jbl_ht_free	(this->v);
		}
		if(jbl_gc_is_var(this))//因为该功能依赖jbl_ht,jbl_ht强制依赖var所以不用宏判断
			jbl_free((char*)this-sizeof(jbl_var));
		else
			jbl_free(this);
	}
	return NULL;	
	
}
inline jwl_http_head *jwl_http_head_copy(jwl_http_head * this)
{
	jbl_gc_plus(this);
	return this;
}
inline jwl_http_head *jwl_http_head_extend(jwl_http_head * this,jwl_http_head **pthi)
{
	if(!this){this=jwl_http_head_new();if(pthi)*pthi=this;return this;}
	jbl_reference *ref=NULL;jwl_http_head *thi=jbl_refer_pull_keep_father(this,&ref);
	if(jbl_gc_is_pvar(thi))
	{
		jwl_http_head *ttt=((jbl_reference*)thi)->ptr;
		if(jbl_gc_refcnt(thi)==1)
			((jbl_reference*)thi)->ptr=NULL,
		jwl_http_head_free(thi);
		thi=ttt;
	}	
	if((jbl_gc_refcnt(thi)<=1)){if(pthi)*pthi=thi;return this;}

	jwl_http_head * tmp	=jwl_http_head_new();
	
	tmp->status			=this->status;
	tmp->charset		=this->charset;
	
	tmp->method			=this->method;
	tmp->protocol		=this->protocol;
	tmp->connection		=this->connection;
	
	tmp->cache			=this->cache;
	tmp->upgrade		=this->upgrade;
	tmp->cache_max_age	=this->cache_max_age;
	tmp->range.start	=this->range.start;
	tmp->range.end		=this->range.end;
	tmp->etag			=jbl_string_copy(this->etag);
	
	
	tmp->content_type	=jbl_string_copy(this->content_type);
	tmp->filename		=jbl_string_copy(this->filename);
	
	
	tmp->url			=jbl_string_copy(this->url);
	tmp->host			=jbl_string_copy(this->host);
	tmp->ua				=jbl_string_copy(this->ua);
	tmp->referer		=jbl_string_copy(this->referer);
	
	tmp->cookie			=jbl_ht_copy(this->cookie);
	tmp->v				=jbl_ht_copy(this->v);
	
	jwl_http_head_free(this);
	if(ref)		ref->ptr=tmp;
	else		this=tmp;
	if(pthi)	*pthi=tmp;	
	return this;
}
jwl_http_head *		jwl_http_head_set_status		(jwl_http_head * this,jbl_uint32 status)				{jwl_http_head *thi;this=jwl_http_head_extend(this,&thi);thi->status		=status			;return this;}
jwl_http_head *		jwl_http_head_set_charset		(jwl_http_head * this,jbl_uint32 charset)				{jwl_http_head *thi;this=jwl_http_head_extend(this,&thi);thi->charset		=charset  		;return this;}
jwl_http_head *		jwl_http_head_set_method		(jwl_http_head * this,jbl_uint32 method)				{jwl_http_head *thi;this=jwl_http_head_extend(this,&thi);thi->method		=method  		;return this;}
jwl_http_head *		jwl_http_head_set_protocol		(jwl_http_head * this,jbl_uint32 protocol)				{jwl_http_head *thi;this=jwl_http_head_extend(this,&thi);thi->protocol		=protocol  		;return this;}
jwl_http_head *		jwl_http_head_set_connection	(jwl_http_head * this,jbl_uint32 connection)			{jwl_http_head *thi;this=jwl_http_head_extend(this,&thi);thi->connection	=connection		;return this;}
jwl_http_head *		jwl_http_head_set_cache			(jwl_http_head * this,jbl_uint32 cache)					{jwl_http_head *thi;this=jwl_http_head_extend(this,&thi);thi->cache			=cache  		;return this;}
jwl_http_head *		jwl_http_head_set_upgrade		(jwl_http_head * this,jbl_uint32 upgrade)				{jwl_http_head *thi;this=jwl_http_head_extend(this,&thi);thi->upgrade		=upgrade  		;return this;}
jwl_http_head *		jwl_http_head_set_cache_max_age	(jwl_http_head * this,jbl_uint32 cache_max_age)			{jwl_http_head *thi;this=jwl_http_head_extend(this,&thi);thi->cache_max_age	=cache_max_age	;return this;}
jwl_http_head *		jwl_http_head_set_range			(jwl_http_head * this,jwl_http_head_range range)		{jwl_http_head *thi;this=jwl_http_head_extend(this,&thi);thi->range			=range			;return this;}
jwl_http_head *		jwl_http_head_set_etag			(jwl_http_head * this,jbl_string * etag)				{jwl_http_head *thi;this=jwl_http_head_extend(this,&thi);jbl_string_free(thi->etag)			;thi->etag			=jbl_string_copy(etag)			;return this;}
jwl_http_head *		jwl_http_head_set_content_type	(jwl_http_head * this,jbl_string * content_type)		{jwl_http_head *thi;this=jwl_http_head_extend(this,&thi);jbl_string_free(thi->content_type)	;thi->content_type	=jbl_string_copy(content_type)	;return this;}
jwl_http_head *		jwl_http_head_set_filename		(jwl_http_head * this,jbl_string * filename)			{jwl_http_head *thi;this=jwl_http_head_extend(this,&thi);jbl_string_free(thi->filename)		;thi->filename		=jbl_string_copy(filename)		;return this;}
jwl_http_head *		jwl_http_head_set_url			(jwl_http_head * this,jbl_string * url)					{jwl_http_head *thi;this=jwl_http_head_extend(this,&thi);jbl_string_free(thi->url)			;thi->url			=jbl_string_copy(url)			;return this;}
jwl_http_head *		jwl_http_head_set_host			(jwl_http_head * this,jbl_string * host)				{jwl_http_head *thi;this=jwl_http_head_extend(this,&thi);jbl_string_free(thi->host)			;thi->host			=jbl_string_copy(host)			;return this;}
jwl_http_head *		jwl_http_head_set_ua			(jwl_http_head * this,jbl_string * ua)					{jwl_http_head *thi;this=jwl_http_head_extend(this,&thi);jbl_string_free(thi->ua)			;thi->ua			=jbl_string_copy(ua)			;return this;}
jwl_http_head *		jwl_http_head_set_referer		(jwl_http_head * this,jbl_string * referer)				{jwl_http_head *thi;this=jwl_http_head_extend(this,&thi);jbl_string_free(thi->referer)		;thi->referer		=jbl_string_copy(referer)		;return this;}
jwl_http_head *		jwl_http_head_set				(jwl_http_head * this,unsigned char * key,jbl_var* var)
{
	jwl_http_head *thi;this=jwl_http_head_extend(this,&thi);
	thi->v=jbl_ht_insert_chars(thi->v,key,var);
	return this;
}

jbl_uint32			jwl_http_head_get_status		(jwl_http_head * this){if(!this)return 0;this=jbl_refer_pull(this);return this->status;}
jbl_uint32			jwl_http_head_get_charget		(jwl_http_head * this){if(!this)return 0;this=jbl_refer_pull(this);return this->charset;}
jbl_uint32			jwl_http_head_get_method		(jwl_http_head * this){if(!this)return 0;this=jbl_refer_pull(this);return this->method;}
jbl_uint32			jwl_http_head_get_protocol		(jwl_http_head * this){if(!this)return 0;this=jbl_refer_pull(this);return this->protocol;}
jbl_uint32			jwl_http_head_get_connection	(jwl_http_head * this){if(!this)return 0;this=jbl_refer_pull(this);return this->connection;}
jbl_uint32			jwl_http_head_get_cache			(jwl_http_head * this){if(!this)return 0;this=jbl_refer_pull(this);return this->cache;}
jbl_uint32			jwl_http_head_get_upgrade		(jwl_http_head * this){if(!this)return 0;this=jbl_refer_pull(this);return this->upgrade;}
jbl_uint32			jwl_http_head_get_cache_max_age	(jwl_http_head * this){if(!this)return 0;this=jbl_refer_pull(this);return this->cache_max_age;}
jwl_http_head_range	jwl_http_head_get_range			(jwl_http_head * this){if(!this)return (jwl_http_head_range){0,0};this=jbl_refer_pull(this);return this->range;}
jbl_string *		jwl_http_head_get_etag			(jwl_http_head * this){if(!this)return NULL;this=jbl_refer_pull(this);return jbl_string_copy(this->etag);}
jbl_string *		jwl_http_head_get_content_type	(jwl_http_head * this){if(!this)return NULL;this=jbl_refer_pull(this);return jbl_string_copy(this->content_type);}
jbl_string *		jwl_http_head_get_filename		(jwl_http_head * this){if(!this)return NULL;this=jbl_refer_pull(this);return jbl_string_copy(this->filename);}
jbl_string *		jwl_http_head_get_url			(jwl_http_head * this){if(!this)return NULL;this=jbl_refer_pull(this);return jbl_string_copy(this->url);}
jbl_string *		jwl_http_head_get_host			(jwl_http_head * this){if(!this)return NULL;this=jbl_refer_pull(this);return jbl_string_copy(this->host);}
jbl_string *		jwl_http_head_get_ua			(jwl_http_head * this){if(!this)return NULL;this=jbl_refer_pull(this);return jbl_string_copy(this->ua);}
jbl_string *		jwl_http_head_get_referer		(jwl_http_head * this){if(!this)return NULL;this=jbl_refer_pull(this);return jbl_string_copy(this->referer);}
jbl_var    *		jwl_http_head_get				(jwl_http_head * this,unsigned char * key)
{
	if(!this)return NULL;
	this=jbl_refer_pull(this);
	if(!this->v)return NULL;
	return jbl_ht_get_chars(this->v,key);
}




void jwl_http_head_encode(jbl_stream *stream,jwl_http_head *head,jbl_string_size_type size)
{
#define rn() jbl_stream_push_char(stream,'\r'),jbl_stream_push_char(stream,'\n')
	if(!head)return;
	head=jbl_refer_pull(head);
	jbl_stream_push_chars(stream,UC"HTTP/1.1 ");
	jbl_stream_push_uint(stream,head->status);
	switch(head->status)
	{
		case 101:	jbl_stream_push_chars(stream,UC" Switching Protocols")	;break;
		case 200:	jbl_stream_push_chars(stream,UC" OK")				;break;
		case 206:	jbl_stream_push_chars(stream,UC" Partial Content")	;break;
		case 304:	jbl_stream_push_chars(stream,UC" Not Modified")		;break;
		case 404:	jbl_stream_push_chars(stream,UC" Not Found")		;break;
		case 416:	jbl_stream_push_chars(stream,UC" Range Not Satisfiable")		;break;
	}
	rn();
	jbl_stream_push_chars(stream,UC"Server: "JWL_HTTP_RESPONSE_SERVER_NAME)															,rn();
	if(head->status==206)
	{
		jbl_stream_push_chars(stream,UC"Content-Length: ")					,jbl_stream_push_uint(stream,(head->range.end?head->range.end:size)-head->range.start)	,rn();
		//注意，range是闭区间，而jwl,jbl要求左闭右开区间
		jbl_stream_push_chars(stream,UC"Content-Range: bytes ")				,jbl_stream_push_uint(stream,head->range.start)			,jbl_stream_push_char(stream,'-')	,jbl_stream_push_uint(stream,head->range.end?(head->range.end-1):0)	,jbl_stream_push_char(stream,'/')	,jbl_stream_push_uint(stream,size)	,rn();
	}
	else
		jbl_stream_push_chars(stream,UC"Content-Length: ")					,jbl_stream_push_uint(stream,size)						,rn();
	jbl_stream_push_chars(stream,UC"Accept-Ranges: bytes")																			,rn();
	if(head->cache==JWL_HTTP_CACHE_MAX_AGE)
	{
		jbl_stream_push_chars(stream,UC"Cache-Control: max-age=")	,jbl_stream_push_uint(stream,head->cache_max_age)				,rn();
		jbl_time * t=jbl_time_add_second(jbl_time_now(NULL),head->cache_max_age);
//		jbl_stream_push_chars(stream,UC"Date: ")	,jbl_time_to_string_format(t,stream,UC JBL_TIME_FORMAT_RFC1123)					,rn();
//		jbl_stream_push_chars(stream,UC"Expires: ")	,jbl_time_to_string_format(t,stream,UC JBL_TIME_FORMAT_RFC1123)					,rn();
		t=jbl_time_free(t);
	}
	else
	{
		jbl_stream_push_chars(stream,UC"Pragma: no-cache")																			,rn();
		jbl_stream_push_chars(stream,UC"Cache-Control: no-cache")																	,rn();
	}
	if(head->content_type)
	{
		jbl_stream_push_chars(stream,UC"Content-Type: ")					,jbl_stream_push_string(stream,head->content_type);
		char *charset[]={"","UTF-8"};
		if(head->charset)
			jbl_stream_push_chars(stream,UC"; charset=")					,jbl_stream_push_chars(stream,UC charset[head->charset]);
		rn();
	}
	if(head->connection)
	{
		char * connection[]={"","keep-alive","close","Upgrade"};
		jbl_stream_push_chars(stream,UC"Connection: ")						,jbl_stream_push_chars(stream,UC connection[head->connection])	,rn();
	}
	if(head->connection==JWL_HTTP_CONNECTION_UPGRADE&&head->upgrade)
	{
		char * upgrade[]={"","websocket"};
		jbl_stream_push_chars(stream,UC"Upgrade: ")							,jbl_stream_push_chars(stream,UC upgrade[head->upgrade])		,rn();
	}
		
	if(head->etag)
		jbl_stream_push_chars(stream,UC"ETag: ")							,jbl_stream_push_string(stream,head->etag)				,rn();
	if(head->filename)
	{
		jbl_stream_push_chars(stream,UC"Content-Disposition: attachment; filename=\"");
		jbl_stream_push_string(stream,head->filename);
		jbl_stream_push_char(stream,'"');
		rn();
	}
	if(head->v)
		jbl_ht_foreach(head->v,i)
		{
			jbl_stream_push_string(stream,jbl_htk(i));
			jbl_stream_push_chars(stream,UC": ");
			if(Vis_jbl_string(i->v))jbl_stream_push_string(stream,jbl_Vstring(i->v));
			else					jbl_var_json_put(i->v,stream,0,0);
			rn();
		}
	
	rn();
#undef rn
}
#line 269 "jwl/jwl_http.c"
enum jwl_http_scanner_condition {
	jwl_http_scanner_condition_0,
	jwl_http_scanner_condition_method,
	jwl_http_scanner_condition_url,
	jwl_http_scanner_condition_protocol,
	jwl_http_scanner_condition_head_body,
	jwl_http_scanner_condition_head_host,
	jwl_http_scanner_condition_head_ua,
	jwl_http_scanner_condition_head_refer,
	jwl_http_scanner_condition_head_etag,
	jwl_http_scanner_condition_head_conn,
	jwl_http_scanner_condition_head_upgrade,
	jwl_http_scanner_condition_head_range_s,
	jwl_http_scanner_condition_head_range_e,
	jwl_http_scanner_condition_head_accept,
	jwl_http_scanner_condition_head_acen,
	jwl_http_scanner_condition_head_aclan,
	jwl_http_scanner_condition_head_cookie,
	jwl_http_scanner_condition_head_cache,
	jwl_http_scanner_condition_special_key,
	jwl_http_scanner_condition_special_var,
};
#line 266 "jwl/jwl_http.l"


jwl_http_head* jwl_http_head_decode(jbl_string *buf,jbl_string_size_type *start)
{	
	if(!buf)return NULL;
	buf=jbl_refer_pull(buf);
	if(!buf->len)return NULL;
	jwl_http_head * head=jwl_http_head_new();
	jwl_http_head_set_request(head);
	unsigned char	*	YYMARKER;
	unsigned char	*	YYCURSOR=buf->s+(start?(*start):0);
	jbl_string		*	tmp_key	=NULL;
	jbl_var			*	tmp_var	=NULL;
	#define YYCTYPE		unsigned char

#line 308 "jwl/jwl_http.c"
{
	YYCTYPE yych;
	switch (head->cond) {
	case jwl_http_scanner_condition_0: goto yyc_0;
	case jwl_http_scanner_condition_method: goto yyc_method;
	case jwl_http_scanner_condition_url: goto yyc_url;
	case jwl_http_scanner_condition_protocol: goto yyc_protocol;
	case jwl_http_scanner_condition_head_body: goto yyc_head_body;
	case jwl_http_scanner_condition_head_host: goto yyc_head_host;
	case jwl_http_scanner_condition_head_ua: goto yyc_head_ua;
	case jwl_http_scanner_condition_head_refer: goto yyc_head_refer;
	case jwl_http_scanner_condition_head_etag: goto yyc_head_etag;
	case jwl_http_scanner_condition_head_conn: goto yyc_head_conn;
	case jwl_http_scanner_condition_head_upgrade: goto yyc_head_upgrade;
	case jwl_http_scanner_condition_head_range_s: goto yyc_head_range_s;
	case jwl_http_scanner_condition_head_range_e: goto yyc_head_range_e;
	case jwl_http_scanner_condition_head_accept: goto yyc_head_accept;
	case jwl_http_scanner_condition_head_acen: goto yyc_head_acen;
	case jwl_http_scanner_condition_head_aclan: goto yyc_head_aclan;
	case jwl_http_scanner_condition_head_cookie: goto yyc_head_cookie;
	case jwl_http_scanner_condition_head_cache: goto yyc_head_cache;
	case jwl_http_scanner_condition_special_key: goto yyc_special_key;
	case jwl_http_scanner_condition_special_var: goto yyc_special_var;
	}
/* *********************************** */
yyc_0:
	head->cond = (jwl_http_scanner_condition_method);
	goto yyc_method;
/* *********************************** */
yyc_method:
	yych = *YYCURSOR;
	switch (yych) {
	case ' ':	goto yy7;
	case 'G':	goto yy9;
	case 'P':	goto yy10;
	default:	goto yy6;
	}
yy6:
yy7:
	++YYCURSOR;
	head->cond = (jwl_http_scanner_condition_url);
#line 291 "jwl/jwl_http.l"
	{head->url				=jbl_string_free    (head->url)									;goto yyc_url;}
#line 352 "jwl/jwl_http.c"
yy9:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'E':	goto yy11;
	default:	goto yy6;
	}
yy10:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'O':	goto yy12;
	default:	goto yy6;
	}
yy11:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'T':	goto yy13;
	default:	goto yy6;
	}
yy12:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'S':	goto yy15;
	default:	goto yy6;
	}
yy13:
	++YYCURSOR;
#line 290 "jwl/jwl_http.l"
	{head->method=JWL_HTTP_METHOD_GET														;goto yyc_method;}
#line 381 "jwl/jwl_http.c"
yy15:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'T':	goto yy16;
	default:	goto yy6;
	}
yy16:
	++YYCURSOR;
#line 289 "jwl/jwl_http.l"
	{head->method=JWL_HTTP_METHOD_POST														;goto yyc_method;}
#line 392 "jwl/jwl_http.c"
/* *********************************** */
yyc_url:
	yych = *YYCURSOR;
	switch (yych) {
	case ' ':	goto yy21;
	default:	goto yy20;
	}
yy20:
#line 293 "jwl/jwl_http.l"
	{head->url				=jbl_string_add_char(head->url,*YYCURSOR)						;++YYCURSOR;goto yyc_url;}
#line 403 "jwl/jwl_http.c"
yy21:
	++YYCURSOR;
	head->cond = (jwl_http_scanner_condition_protocol);
#line 294 "jwl/jwl_http.l"
	{																						;goto yyc_protocol;}
#line 409 "jwl/jwl_http.c"
/* *********************************** */
yyc_protocol:
	yych = *YYCURSOR;
	switch (yych) {
	case '\r':	goto yy26;
	case 'H':	goto yy27;
	default:	goto yy25;
	}
yy25:
yy26:
	yych = *++YYCURSOR;
	switch (yych) {
	case '\n':	goto yy28;
	default:	goto yy25;
	}
yy27:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'T':	goto yy30;
	default:	goto yy25;
	}
yy28:
	++YYCURSOR;
	head->cond = (jwl_http_scanner_condition_head_body);
#line 297 "jwl/jwl_http.l"
	{																						;goto yyc_head_body;}
#line 436 "jwl/jwl_http.c"
yy30:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'T':	goto yy31;
	default:	goto yy25;
	}
yy31:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'P':	goto yy32;
	default:	goto yy25;
	}
yy32:
	yych = *++YYCURSOR;
	switch (yych) {
	case '/':	goto yy33;
	default:	goto yy25;
	}
yy33:
	yych = *++YYCURSOR;
	switch (yych) {
	case '1':	goto yy34;
	default:	goto yy25;
	}
yy34:
	yych = *++YYCURSOR;
	switch (yych) {
	case '.':	goto yy35;
	default:	goto yy25;
	}
yy35:
	yych = *++YYCURSOR;
	switch (yych) {
	case '1':	goto yy36;
	default:	goto yy25;
	}
yy36:
	++YYCURSOR;
#line 296 "jwl/jwl_http.l"
	{head->protocol			=JWL_HTTP_PROTOCOL_HTTP_1_1										;goto yyc_protocol;}
#line 477 "jwl/jwl_http.c"
/* *********************************** */
yyc_head_body:
	yych = *(YYMARKER = YYCURSOR);
	switch (yych) {
	case 0x00:	goto yy41;
	case '\r':	goto yy43;
	case 'A':	goto yy45;
	case 'C':	goto yy46;
	case 'E':	goto yy47;
	case 'H':	goto yy48;
	case 'I':	goto yy49;
	case 'P':	goto yy50;
	case 'R':	goto yy51;
	case 'U':	goto yy52;
	default:	goto yy40;
	}
yy40:
	head->cond = (jwl_http_scanner_condition_special_key);
#line 356 "jwl/jwl_http.l"
	{tmp_key				=jbl_string_free    (tmp_key)	;tmp_key=jbl_string_add_char(tmp_key,*YYCURSOR)		;++YYCURSOR;		;goto yyc_special_key;}
#line 498 "jwl/jwl_http.c"
yy41:
	++YYCURSOR;
#line 363 "jwl/jwl_http.l"
	{if(start)*start=YYCURSOR-buf->s;return head;}
#line 503 "jwl/jwl_http.c"
yy43:
	yych = *++YYCURSOR;
	switch (yych) {
	case '\n':	goto yy53;
	default:	goto yy44;
	}
yy44:
	YYCURSOR = YYMARKER;
	goto yy40;
yy45:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'c':	goto yy55;
	default:	goto yy44;
	}
yy46:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'a':	goto yy56;
	case 'o':	goto yy57;
	default:	goto yy44;
	}
yy47:
	yych = *++YYCURSOR;
	switch (yych) {
	case 't':	goto yy58;
	default:	goto yy44;
	}
yy48:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'o':	goto yy59;
	default:	goto yy44;
	}
yy49:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'f':	goto yy60;
	default:	goto yy44;
	}
yy50:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'r':	goto yy61;
	default:	goto yy44;
	}
yy51:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'a':	goto yy62;
	case 'e':	goto yy63;
	default:	goto yy44;
	}
yy52:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'p':	goto yy64;
	case 's':	goto yy65;
	default:	goto yy44;
	}
yy53:
	++YYCURSOR;
#line 362 "jwl/jwl_http.l"
	{if(start)*start=YYCURSOR-buf->s;return head;}
#line 568 "jwl/jwl_http.c"
yy55:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'c':	goto yy66;
	default:	goto yy44;
	}
yy56:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'c':	goto yy67;
	default:	goto yy44;
	}
yy57:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'n':	goto yy68;
	case 'o':	goto yy69;
	default:	goto yy44;
	}
yy58:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'a':	goto yy70;
	default:	goto yy44;
	}
yy59:
	yych = *++YYCURSOR;
	switch (yych) {
	case 's':	goto yy71;
	default:	goto yy44;
	}
yy60:
	yych = *++YYCURSOR;
	switch (yych) {
	case '-':	goto yy72;
	default:	goto yy44;
	}
yy61:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'a':	goto yy73;
	default:	goto yy44;
	}
yy62:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'n':	goto yy74;
	default:	goto yy44;
	}
yy63:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'f':	goto yy75;
	default:	goto yy44;
	}
yy64:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'g':	goto yy76;
	default:	goto yy44;
	}
yy65:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'e':	goto yy77;
	default:	goto yy44;
	}
yy66:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'e':	goto yy78;
	default:	goto yy44;
	}
yy67:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'h':	goto yy79;
	default:	goto yy44;
	}
yy68:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'n':	goto yy80;
	default:	goto yy44;
	}
yy69:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'k':	goto yy81;
	default:	goto yy44;
	}
yy70:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'g':	goto yy82;
	default:	goto yy44;
	}
yy71:
	yych = *++YYCURSOR;
	switch (yych) {
	case 't':	goto yy83;
	default:	goto yy44;
	}
yy72:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'N':	goto yy84;
	default:	goto yy44;
	}
yy73:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'g':	goto yy85;
	default:	goto yy44;
	}
yy74:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'g':	goto yy86;
	default:	goto yy44;
	}
yy75:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'e':	goto yy87;
	default:	goto yy44;
	}
yy76:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'r':	goto yy88;
	default:	goto yy44;
	}
yy77:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'r':	goto yy89;
	default:	goto yy44;
	}
yy78:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'p':	goto yy90;
	default:	goto yy44;
	}
yy79:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'e':	goto yy91;
	default:	goto yy44;
	}
yy80:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'e':	goto yy92;
	default:	goto yy44;
	}
yy81:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'i':	goto yy93;
	default:	goto yy44;
	}
yy82:
	yych = *++YYCURSOR;
	switch (yych) {
	case ':':	goto yy94;
	default:	goto yy44;
	}
yy83:
	yych = *++YYCURSOR;
	switch (yych) {
	case ':':	goto yy95;
	default:	goto yy44;
	}
yy84:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'o':	goto yy96;
	default:	goto yy44;
	}
yy85:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'm':	goto yy97;
	default:	goto yy44;
	}
yy86:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'e':	goto yy98;
	default:	goto yy44;
	}
yy87:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'r':	goto yy99;
	default:	goto yy44;
	}
yy88:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'a':	goto yy100;
	default:	goto yy44;
	}
yy89:
	yych = *++YYCURSOR;
	switch (yych) {
	case '-':	goto yy101;
	default:	goto yy44;
	}
yy90:
	yych = *++YYCURSOR;
	switch (yych) {
	case 't':	goto yy102;
	default:	goto yy44;
	}
yy91:
	yych = *++YYCURSOR;
	switch (yych) {
	case '-':	goto yy103;
	default:	goto yy44;
	}
yy92:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'c':	goto yy104;
	default:	goto yy44;
	}
yy93:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'e':	goto yy105;
	default:	goto yy44;
	}
yy94:
	yych = *++YYCURSOR;
	switch (yych) {
	case ' ':	goto yy106;
	default:	goto yy44;
	}
yy95:
	yych = *++YYCURSOR;
	switch (yych) {
	case ' ':	goto yy108;
	default:	goto yy44;
	}
yy96:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'n':	goto yy110;
	default:	goto yy44;
	}
yy97:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'a':	goto yy111;
	default:	goto yy44;
	}
yy98:
	yych = *++YYCURSOR;
	switch (yych) {
	case ':':	goto yy112;
	default:	goto yy44;
	}
yy99:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'e':	goto yy113;
	default:	goto yy44;
	}
yy100:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'd':	goto yy114;
	default:	goto yy44;
	}
yy101:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'A':	goto yy115;
	default:	goto yy44;
	}
yy102:
	yych = *++YYCURSOR;
	switch (yych) {
	case '-':	goto yy116;
	case ':':	goto yy117;
	default:	goto yy44;
	}
yy103:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'C':	goto yy118;
	default:	goto yy44;
	}
yy104:
	yych = *++YYCURSOR;
	switch (yych) {
	case 't':	goto yy119;
	default:	goto yy44;
	}
yy105:
	yych = *++YYCURSOR;
	switch (yych) {
	case ':':	goto yy120;
	default:	goto yy44;
	}
yy106:
	++YYCURSOR;
	head->cond = (jwl_http_scanner_condition_head_etag);
#line 311 "jwl/jwl_http.l"
	{head->etag				=jbl_string_free    (head->etag)								;goto yyc_head_etag;}
#line 882 "jwl/jwl_http.c"
yy108:
	++YYCURSOR;
	head->cond = (jwl_http_scanner_condition_head_host);
#line 299 "jwl/jwl_http.l"
	{head->host				=jbl_string_free    (head->host)								;goto yyc_head_host;}
#line 888 "jwl/jwl_http.c"
yy110:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'e':	goto yy121;
	default:	goto yy44;
	}
yy111:
	yych = *++YYCURSOR;
	switch (yych) {
	case ':':	goto yy122;
	default:	goto yy44;
	}
yy112:
	yych = *++YYCURSOR;
	switch (yych) {
	case ' ':	goto yy123;
	default:	goto yy44;
	}
yy113:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'r':	goto yy124;
	default:	goto yy44;
	}
yy114:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'e':	goto yy125;
	default:	goto yy44;
	}
yy115:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'g':	goto yy126;
	default:	goto yy44;
	}
yy116:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'E':	goto yy127;
	case 'L':	goto yy128;
	default:	goto yy44;
	}
yy117:
	yych = *++YYCURSOR;
	switch (yych) {
	case ' ':	goto yy129;
	default:	goto yy44;
	}
yy118:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'o':	goto yy131;
	default:	goto yy44;
	}
yy119:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'i':	goto yy132;
	default:	goto yy44;
	}
yy120:
	yych = *++YYCURSOR;
	switch (yych) {
	case ' ':	goto yy133;
	default:	goto yy44;
	}
yy121:
	yych = *++YYCURSOR;
	switch (yych) {
	case '-':	goto yy135;
	default:	goto yy44;
	}
yy122:
	yych = *++YYCURSOR;
	switch (yych) {
	case ' ':	goto yy136;
	default:	goto yy44;
	}
yy123:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'b':	goto yy138;
	default:	goto yy44;
	}
yy124:
	yych = *++YYCURSOR;
	switch (yych) {
	case ':':	goto yy139;
	default:	goto yy44;
	}
yy125:
	yych = *++YYCURSOR;
	switch (yych) {
	case ':':	goto yy140;
	default:	goto yy44;
	}
yy126:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'e':	goto yy141;
	default:	goto yy44;
	}
yy127:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'n':	goto yy142;
	default:	goto yy44;
	}
yy128:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'a':	goto yy143;
	default:	goto yy44;
	}
yy129:
	++YYCURSOR;
	head->cond = (jwl_http_scanner_condition_head_accept);
#line 333 "jwl/jwl_http.l"
	{																						;goto yyc_head_accept;}
#line 1009 "jwl/jwl_http.c"
yy131:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'n':	goto yy144;
	default:	goto yy44;
	}
yy132:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'o':	goto yy145;
	default:	goto yy44;
	}
yy133:
	++YYCURSOR;
	head->cond = (jwl_http_scanner_condition_head_cookie);
#line 345 "jwl/jwl_http.l"
	{																						;goto yyc_head_cookie;}
#line 1027 "jwl/jwl_http.c"
yy135:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'M':	goto yy146;
	default:	goto yy44;
	}
yy136:
	++YYCURSOR;
	head->cond = (jwl_http_scanner_condition_head_cache);
#line 350 "jwl/jwl_http.l"
	{																						;goto yyc_head_cache;}
#line 1039 "jwl/jwl_http.c"
yy138:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'y':	goto yy147;
	default:	goto yy44;
	}
yy139:
	yych = *++YYCURSOR;
	switch (yych) {
	case ' ':	goto yy148;
	default:	goto yy44;
	}
yy140:
	yych = *++YYCURSOR;
	switch (yych) {
	case ' ':	goto yy150;
	default:	goto yy44;
	}
yy141:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'n':	goto yy152;
	default:	goto yy44;
	}
yy142:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'c':	goto yy153;
	default:	goto yy44;
	}
yy143:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'n':	goto yy154;
	default:	goto yy44;
	}
yy144:
	yych = *++YYCURSOR;
	switch (yych) {
	case 't':	goto yy155;
	default:	goto yy44;
	}
yy145:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'n':	goto yy156;
	default:	goto yy44;
	}
yy146:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'a':	goto yy157;
	default:	goto yy44;
	}
yy147:
	yych = *++YYCURSOR;
	switch (yych) {
	case 't':	goto yy158;
	default:	goto yy44;
	}
yy148:
	++YYCURSOR;
	head->cond = (jwl_http_scanner_condition_head_refer);
#line 307 "jwl/jwl_http.l"
	{head->referer			=jbl_string_free    (head->referer)								;goto yyc_head_refer;}
#line 1105 "jwl/jwl_http.c"
yy150:
	++YYCURSOR;
	head->cond = (jwl_http_scanner_condition_head_upgrade);
#line 322 "jwl/jwl_http.l"
	{																						;goto yyc_head_upgrade;}
#line 1111 "jwl/jwl_http.c"
yy152:
	yych = *++YYCURSOR;
	switch (yych) {
	case 't':	goto yy159;
	default:	goto yy44;
	}
yy153:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'o':	goto yy160;
	default:	goto yy44;
	}
yy154:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'g':	goto yy161;
	default:	goto yy44;
	}
yy155:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'r':	goto yy162;
	default:	goto yy44;
	}
yy156:
	yych = *++YYCURSOR;
	switch (yych) {
	case ':':	goto yy163;
	default:	goto yy44;
	}
yy157:
	yych = *++YYCURSOR;
	switch (yych) {
	case 't':	goto yy164;
	default:	goto yy44;
	}
yy158:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'e':	goto yy165;
	default:	goto yy44;
	}
yy159:
	yych = *++YYCURSOR;
	switch (yych) {
	case ':':	goto yy166;
	default:	goto yy44;
	}
yy160:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'd':	goto yy167;
	default:	goto yy44;
	}
yy161:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'u':	goto yy168;
	default:	goto yy44;
	}
yy162:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'o':	goto yy169;
	default:	goto yy44;
	}
yy163:
	yych = *++YYCURSOR;
	switch (yych) {
	case ' ':	goto yy170;
	default:	goto yy44;
	}
yy164:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'c':	goto yy172;
	default:	goto yy44;
	}
yy165:
	yych = *++YYCURSOR;
	switch (yych) {
	case 's':	goto yy173;
	default:	goto yy44;
	}
yy166:
	yych = *++YYCURSOR;
	switch (yych) {
	case ' ':	goto yy174;
	default:	goto yy44;
	}
yy167:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'i':	goto yy176;
	default:	goto yy44;
	}
yy168:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'a':	goto yy177;
	default:	goto yy44;
	}
yy169:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'l':	goto yy178;
	default:	goto yy44;
	}
yy170:
	++YYCURSOR;
	head->cond = (jwl_http_scanner_condition_head_conn);
#line 316 "jwl/jwl_http.l"
	{																						;goto yyc_head_conn;}
#line 1225 "jwl/jwl_http.c"
yy172:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'h':	goto yy179;
	default:	goto yy44;
	}
yy173:
	yych = *++YYCURSOR;
	switch (yych) {
	case '=':	goto yy180;
	default:	goto yy44;
	}
yy174:
	++YYCURSOR;
	head->cond = (jwl_http_scanner_condition_head_ua);
#line 303 "jwl/jwl_http.l"
	{head->ua				=jbl_string_free    (head->ua)									;goto yyc_head_ua;}
#line 1243 "jwl/jwl_http.c"
yy176:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'n':	goto yy182;
	default:	goto yy44;
	}
yy177:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'g':	goto yy183;
	default:	goto yy44;
	}
yy178:
	yych = *++YYCURSOR;
	switch (yych) {
	case ':':	goto yy184;
	default:	goto yy44;
	}
yy179:
	yych = *++YYCURSOR;
	switch (yych) {
	case ':':	goto yy185;
	default:	goto yy44;
	}
yy180:
	++YYCURSOR;
	head->cond = (jwl_http_scanner_condition_head_range_s);
#line 326 "jwl/jwl_http.l"
	{head->range.start		=0																;goto yyc_head_range_s;}
#line 1273 "jwl/jwl_http.c"
yy182:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'g':	goto yy186;
	default:	goto yy44;
	}
yy183:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'e':	goto yy187;
	default:	goto yy44;
	}
yy184:
	yych = *++YYCURSOR;
	switch (yych) {
	case ' ':	goto yy188;
	default:	goto yy44;
	}
yy185:
	yych = *++YYCURSOR;
	switch (yych) {
	case ' ':	goto yy190;
	default:	goto yy44;
	}
yy186:
	yych = *++YYCURSOR;
	switch (yych) {
	case ':':	goto yy192;
	default:	goto yy44;
	}
yy187:
	yych = *++YYCURSOR;
	switch (yych) {
	case ':':	goto yy193;
	default:	goto yy44;
	}
yy188:
	++YYCURSOR;
	head->cond = (jwl_http_scanner_condition_head_cache);
#line 349 "jwl/jwl_http.l"
	{																						;goto yyc_head_cache;}
#line 1315 "jwl/jwl_http.c"
yy190:
	++YYCURSOR;
	head->cond = (jwl_http_scanner_condition_head_etag);
#line 312 "jwl/jwl_http.l"
	{head->etag				=jbl_string_free    (head->etag)								;goto yyc_head_etag;}
#line 1321 "jwl/jwl_http.c"
yy192:
	yych = *++YYCURSOR;
	switch (yych) {
	case ' ':	goto yy194;
	default:	goto yy44;
	}
yy193:
	yych = *++YYCURSOR;
	switch (yych) {
	case ' ':	goto yy196;
	default:	goto yy44;
	}
yy194:
	++YYCURSOR;
	head->cond = (jwl_http_scanner_condition_head_acen);
#line 337 "jwl/jwl_http.l"
	{																						;goto yyc_head_acen;}
#line 1339 "jwl/jwl_http.c"
yy196:
	++YYCURSOR;
	head->cond = (jwl_http_scanner_condition_head_aclan);
#line 341 "jwl/jwl_http.l"
	{																						;goto yyc_head_aclan;}
#line 1345 "jwl/jwl_http.c"
/* *********************************** */
yyc_head_host:
	yych = *(YYMARKER = YYCURSOR);
	switch (yych) {
	case '\r':	goto yy201;
	default:	goto yy200;
	}
yy200:
#line 300 "jwl/jwl_http.l"
	{head->host				=jbl_string_add_char(head->host,*YYCURSOR)						;++YYCURSOR;goto yyc_head_host;}
#line 1356 "jwl/jwl_http.c"
yy201:
	yych = *++YYCURSOR;
	switch (yych) {
	case '\n':	goto yy203;
	default:	goto yy202;
	}
yy202:
	YYCURSOR = YYMARKER;
	goto yy200;
yy203:
	++YYCURSOR;
	head->cond = (jwl_http_scanner_condition_head_body);
#line 301 "jwl/jwl_http.l"
	{																						;goto yyc_head_body;}
#line 1371 "jwl/jwl_http.c"
/* *********************************** */
yyc_head_ua:
	yych = *(YYMARKER = YYCURSOR);
	switch (yych) {
	case '\r':	goto yy208;
	default:	goto yy207;
	}
yy207:
#line 304 "jwl/jwl_http.l"
	{head->ua				=jbl_string_add_char(head->ua,*YYCURSOR)						;++YYCURSOR;goto yyc_head_ua;}
#line 1382 "jwl/jwl_http.c"
yy208:
	yych = *++YYCURSOR;
	switch (yych) {
	case '\n':	goto yy210;
	default:	goto yy209;
	}
yy209:
	YYCURSOR = YYMARKER;
	goto yy207;
yy210:
	++YYCURSOR;
	head->cond = (jwl_http_scanner_condition_head_body);
#line 305 "jwl/jwl_http.l"
	{																						;goto yyc_head_body;}
#line 1397 "jwl/jwl_http.c"
/* *********************************** */
yyc_head_refer:
	yych = *(YYMARKER = YYCURSOR);
	switch (yych) {
	case '\r':	goto yy215;
	default:	goto yy214;
	}
yy214:
#line 308 "jwl/jwl_http.l"
	{head->referer			=jbl_string_add_char(head->referer,*YYCURSOR)					;++YYCURSOR;goto yyc_head_refer;}
#line 1408 "jwl/jwl_http.c"
yy215:
	yych = *++YYCURSOR;
	switch (yych) {
	case '\n':	goto yy217;
	default:	goto yy216;
	}
yy216:
	YYCURSOR = YYMARKER;
	goto yy214;
yy217:
	++YYCURSOR;
	head->cond = (jwl_http_scanner_condition_head_body);
#line 309 "jwl/jwl_http.l"
	{																						;goto yyc_head_body;}
#line 1423 "jwl/jwl_http.c"
/* *********************************** */
yyc_head_etag:
	yych = *(YYMARKER = YYCURSOR);
	switch (yych) {
	case '\r':	goto yy222;
	default:	goto yy221;
	}
yy221:
#line 313 "jwl/jwl_http.l"
	{head->etag				=jbl_string_add_char(head->etag,*YYCURSOR)						;++YYCURSOR;goto yyc_head_etag;}
#line 1434 "jwl/jwl_http.c"
yy222:
	yych = *++YYCURSOR;
	switch (yych) {
	case '\n':	goto yy224;
	default:	goto yy223;
	}
yy223:
	YYCURSOR = YYMARKER;
	goto yy221;
yy224:
	++YYCURSOR;
	head->cond = (jwl_http_scanner_condition_head_body);
#line 314 "jwl/jwl_http.l"
	{																						;goto yyc_head_body;}
#line 1449 "jwl/jwl_http.c"
/* *********************************** */
yyc_head_conn:
	yych = *YYCURSOR;
	switch (yych) {
	case '\r':	goto yy229;
	case 'U':	goto yy230;
	case 'c':	goto yy231;
	case 'k':	goto yy232;
	case 'n':	goto yy233;
	default:	goto yy228;
	}
yy228:
yy229:
	yych = *++YYCURSOR;
	switch (yych) {
	case '\n':	goto yy234;
	default:	goto yy228;
	}
yy230:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'p':	goto yy236;
	default:	goto yy228;
	}
yy231:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'l':	goto yy237;
	default:	goto yy228;
	}
yy232:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'e':	goto yy238;
	default:	goto yy228;
	}
yy233:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'o':	goto yy239;
	default:	goto yy228;
	}
yy234:
	++YYCURSOR;
	head->cond = (jwl_http_scanner_condition_head_body);
#line 320 "jwl/jwl_http.l"
	{																						;goto yyc_head_body;}
#line 1497 "jwl/jwl_http.c"
yy236:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'g':	goto yy240;
	default:	goto yy228;
	}
yy237:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'o':	goto yy241;
	default:	goto yy228;
	}
yy238:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'e':	goto yy242;
	default:	goto yy228;
	}
yy239:
	yych = *++YYCURSOR;
	switch (yych) {
	case '-':	goto yy243;
	default:	goto yy228;
	}
yy240:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'r':	goto yy244;
	default:	goto yy228;
	}
yy241:
	yych = *++YYCURSOR;
	switch (yych) {
	case 's':	goto yy245;
	default:	goto yy228;
	}
yy242:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'p':	goto yy246;
	default:	goto yy228;
	}
yy243:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'c':	goto yy247;
	default:	goto yy228;
	}
yy244:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'a':	goto yy248;
	default:	goto yy228;
	}
yy245:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'e':	goto yy249;
	default:	goto yy228;
	}
yy246:
	yych = *++YYCURSOR;
	switch (yych) {
	case '-':	goto yy251;
	default:	goto yy228;
	}
yy247:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'a':	goto yy252;
	default:	goto yy228;
	}
yy248:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'd':	goto yy253;
	default:	goto yy228;
	}
yy249:
	++YYCURSOR;
#line 318 "jwl/jwl_http.l"
	{head->connection		=JWL_HTTP_CONNECTION_CLOSE										;goto yyc_head_conn;}
#line 1580 "jwl/jwl_http.c"
yy251:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'a':	goto yy254;
	default:	goto yy228;
	}
yy252:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'c':	goto yy255;
	default:	goto yy228;
	}
yy253:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'e':	goto yy256;
	default:	goto yy228;
	}
yy254:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'l':	goto yy258;
	default:	goto yy228;
	}
yy255:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'h':	goto yy259;
	default:	goto yy228;
	}
yy256:
	++YYCURSOR;
#line 319 "jwl/jwl_http.l"
	{head->connection		=JWL_HTTP_CONNECTION_UPGRADE									;goto yyc_head_conn;}
#line 1615 "jwl/jwl_http.c"
yy258:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'i':	goto yy260;
	default:	goto yy228;
	}
yy259:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'e':	goto yy261;
	default:	goto yy228;
	}
yy260:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'v':	goto yy263;
	default:	goto yy228;
	}
yy261:
	++YYCURSOR;
#line 351 "jwl/jwl_http.l"
	{head->cache			=JWL_HTTP_CACHE_NO												;goto yyc_head_cache;}
#line 1638 "jwl/jwl_http.c"
yy263:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'e':	goto yy264;
	default:	goto yy228;
	}
yy264:
	++YYCURSOR;
#line 317 "jwl/jwl_http.l"
	{head->connection		=JWL_HTTP_CONNECTION_KEEP_ALIVE									;goto yyc_head_conn;}
#line 1649 "jwl/jwl_http.c"
/* *********************************** */
yyc_head_upgrade:
	yych = *YYCURSOR;
	switch (yych) {
	case '\r':	goto yy269;
	case 'w':	goto yy270;
	default:	goto yy268;
	}
yy268:
yy269:
	yych = *++YYCURSOR;
	switch (yych) {
	case '\n':	goto yy271;
	default:	goto yy268;
	}
yy270:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'e':	goto yy273;
	default:	goto yy268;
	}
yy271:
	++YYCURSOR;
	head->cond = (jwl_http_scanner_condition_head_body);
#line 324 "jwl/jwl_http.l"
	{																						;goto yyc_head_body;}
#line 1676 "jwl/jwl_http.c"
yy273:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'b':	goto yy274;
	default:	goto yy268;
	}
yy274:
	yych = *++YYCURSOR;
	switch (yych) {
	case 's':	goto yy275;
	default:	goto yy268;
	}
yy275:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'o':	goto yy276;
	default:	goto yy268;
	}
yy276:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'c':	goto yy277;
	default:	goto yy268;
	}
yy277:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'k':	goto yy278;
	default:	goto yy268;
	}
yy278:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'e':	goto yy279;
	default:	goto yy268;
	}
yy279:
	yych = *++YYCURSOR;
	switch (yych) {
	case 't':	goto yy280;
	default:	goto yy268;
	}
yy280:
	++YYCURSOR;
#line 323 "jwl/jwl_http.l"
	{head->upgrade			=JWL_HTTP_UPGRADE_WEBSOCKET										;goto yyc_head_upgrade;}
#line 1723 "jwl/jwl_http.c"
/* *********************************** */
yyc_head_range_s:
	yych = *YYCURSOR;
	switch (yych) {
	case '\r':	goto yy285;
	case '-':	goto yy286;
	case '0':
	case '1':
	case '2':
	case '3':
	case '4':
	case '5':
	case '6':
	case '7':
	case '8':
	case '9':	goto yy288;
	default:	goto yy284;
	}
yy284:
yy285:
	yych = *++YYCURSOR;
	switch (yych) {
	case '\n':	goto yy290;
	default:	goto yy284;
	}
yy286:
	++YYCURSOR;
	head->cond = (jwl_http_scanner_condition_head_range_e);
#line 327 "jwl/jwl_http.l"
	{head->range.end		=0																;goto yyc_head_range_e;}
#line 1754 "jwl/jwl_http.c"
yy288:
	++YYCURSOR;
#line 328 "jwl/jwl_http.l"
	{head->range.start		=(head->range.start<<3)+(head->range.start<<1)+*(YYCURSOR-1)-'0';goto yyc_head_range_s;}
#line 1759 "jwl/jwl_http.c"
yy290:
	++YYCURSOR;
	head->cond = (jwl_http_scanner_condition_head_body);
#line 329 "jwl/jwl_http.l"
	{																						;goto yyc_head_body;}
#line 1765 "jwl/jwl_http.c"
/* *********************************** */
yyc_head_range_e:
	yych = *YYCURSOR;
	switch (yych) {
	case '\r':	goto yy295;
	case '0':
	case '1':
	case '2':
	case '3':
	case '4':
	case '5':
	case '6':
	case '7':
	case '8':
	case '9':	goto yy296;
	default:	goto yy294;
	}
yy294:
yy295:
	yych = *++YYCURSOR;
	switch (yych) {
	case '\n':	goto yy298;
	default:	goto yy294;
	}
yy296:
	++YYCURSOR;
#line 330 "jwl/jwl_http.l"
	{head->range.end		=(head->range.end<<3)+(head->range.end<<1)+*(YYCURSOR-1)-'0'	;goto yyc_head_range_e;}
#line 1794 "jwl/jwl_http.c"
yy298:
	++YYCURSOR;
	head->cond = (jwl_http_scanner_condition_head_body);
#line 331 "jwl/jwl_http.l"
	{head->range.end		=(head->range.end)?(head->range.end+1):0						;goto yyc_head_body;}
#line 1800 "jwl/jwl_http.c"
/* *********************************** */
yyc_head_accept:
	yych = *(YYMARKER = YYCURSOR);
	switch (yych) {
	case '\r':	goto yy303;
	default:	goto yy302;
	}
yy302:
#line 334 "jwl/jwl_http.l"
	{																						;++YYCURSOR;goto yyc_head_accept;}
#line 1811 "jwl/jwl_http.c"
yy303:
	yych = *++YYCURSOR;
	switch (yych) {
	case '\n':	goto yy305;
	default:	goto yy304;
	}
yy304:
	YYCURSOR = YYMARKER;
	goto yy302;
yy305:
	++YYCURSOR;
	head->cond = (jwl_http_scanner_condition_head_body);
#line 335 "jwl/jwl_http.l"
	{																						;goto yyc_head_body;}
#line 1826 "jwl/jwl_http.c"
/* *********************************** */
yyc_head_acen:
	yych = *(YYMARKER = YYCURSOR);
	switch (yych) {
	case '\r':	goto yy310;
	default:	goto yy309;
	}
yy309:
#line 338 "jwl/jwl_http.l"
	{																						;++YYCURSOR;goto yyc_head_acen;}
#line 1837 "jwl/jwl_http.c"
yy310:
	yych = *++YYCURSOR;
	switch (yych) {
	case '\n':	goto yy312;
	default:	goto yy311;
	}
yy311:
	YYCURSOR = YYMARKER;
	goto yy309;
yy312:
	++YYCURSOR;
	head->cond = (jwl_http_scanner_condition_head_body);
#line 339 "jwl/jwl_http.l"
	{																						;goto yyc_head_body;}
#line 1852 "jwl/jwl_http.c"
/* *********************************** */
yyc_head_aclan:
	yych = *(YYMARKER = YYCURSOR);
	switch (yych) {
	case '\r':	goto yy317;
	default:	goto yy316;
	}
yy316:
#line 342 "jwl/jwl_http.l"
	{																						;++YYCURSOR;goto yyc_head_aclan;}
#line 1863 "jwl/jwl_http.c"
yy317:
	yych = *++YYCURSOR;
	switch (yych) {
	case '\n':	goto yy319;
	default:	goto yy318;
	}
yy318:
	YYCURSOR = YYMARKER;
	goto yy316;
yy319:
	++YYCURSOR;
	head->cond = (jwl_http_scanner_condition_head_body);
#line 343 "jwl/jwl_http.l"
	{																						;goto yyc_head_body;}
#line 1878 "jwl/jwl_http.c"
/* *********************************** */
yyc_head_cookie:
	yych = *(YYMARKER = YYCURSOR);
	switch (yych) {
	case '\r':	goto yy324;
	default:	goto yy323;
	}
yy323:
#line 346 "jwl/jwl_http.l"
	{																						;++YYCURSOR;goto yyc_head_cookie;}
#line 1889 "jwl/jwl_http.c"
yy324:
	yych = *++YYCURSOR;
	switch (yych) {
	case '\n':	goto yy326;
	default:	goto yy325;
	}
yy325:
	YYCURSOR = YYMARKER;
	goto yy323;
yy326:
	++YYCURSOR;
	head->cond = (jwl_http_scanner_condition_head_body);
#line 347 "jwl/jwl_http.l"
	{																						;goto yyc_head_body;}
#line 1904 "jwl/jwl_http.c"
/* *********************************** */
yyc_head_cache:
	yych = *(YYMARKER = YYCURSOR);
	switch (yych) {
	case '\r':	goto yy331;
	default:	goto yy330;
	}
yy330:
#line 352 "jwl/jwl_http.l"
	{																						;++YYCURSOR;goto yyc_head_cache;}
#line 1915 "jwl/jwl_http.c"
yy331:
	yych = *++YYCURSOR;
	switch (yych) {
	case '\n':	goto yy333;
	default:	goto yy332;
	}
yy332:
	YYCURSOR = YYMARKER;
	goto yy330;
yy333:
	++YYCURSOR;
	head->cond = (jwl_http_scanner_condition_head_body);
#line 353 "jwl/jwl_http.l"
	{																						;goto yyc_head_body;}
#line 1930 "jwl/jwl_http.c"
/* *********************************** */
yyc_special_key:
	yych = *(YYMARKER = YYCURSOR);
	switch (yych) {
	case ':':	goto yy338;
	default:	goto yy337;
	}
yy337:
#line 357 "jwl/jwl_http.l"
	{tmp_key				=jbl_string_add_char(tmp_key,*YYCURSOR)		;++YYCURSOR;		;goto yyc_special_key;}
#line 1941 "jwl/jwl_http.c"
yy338:
	yych = *++YYCURSOR;
	switch (yych) {
	case ' ':	goto yy340;
	default:	goto yy339;
	}
yy339:
	YYCURSOR = YYMARKER;
	goto yy337;
yy340:
	++YYCURSOR;
	head->cond = (jwl_http_scanner_condition_special_var);
#line 358 "jwl/jwl_http.l"
	{tmp_var				=jbl_var_free(tmp_var)			;tmp_var=jbl_Vstring_new();														;goto yyc_special_var;}
#line 1956 "jwl/jwl_http.c"
/* *********************************** */
yyc_special_var:
	yych = *(YYMARKER = YYCURSOR);
	switch (yych) {
	case '\r':	goto yy345;
	default:	goto yy344;
	}
yy344:
#line 359 "jwl/jwl_http.l"
	{tmp_var				=jbl_V(jbl_string_add_char(jbl_Vstring(tmp_var),*YYCURSOR))		;++YYCURSOR;goto yyc_special_var;}
#line 1967 "jwl/jwl_http.c"
yy345:
	yych = *++YYCURSOR;
	switch (yych) {
	case '\n':	goto yy347;
	default:	goto yy346;
	}
yy346:
	YYCURSOR = YYMARKER;
	goto yy344;
yy347:
	++YYCURSOR;
	head->cond = (jwl_http_scanner_condition_head_body);
#line 360 "jwl/jwl_http.l"
	{head->v				=jbl_ht_insert(head->v,tmp_key,tmp_var);tmp_key=jbl_string_free(tmp_key);tmp_var=jbl_var_free(tmp_var);			;goto yyc_head_body;}
#line 1982 "jwl/jwl_http.c"
}
#line 365 "jwl/jwl_http.l"

	#undef YYCTYPE	


	return head;
}


#if JBL_STREAM_ENABLE==1
jwl_http_head* jwl_http_head_view_put(jwl_http_head* this,jbl_stream *out,jbl_uint8 format,jbl_uint32 tabs,jbl_uint32 line,unsigned char * varname,unsigned char * func,unsigned char * file)
{
	jwl_http_head* thi;if(jbl_stream_view_put_format(thi=jbl_refer_pull(this),out,format,tabs,UC"jwl_http_head",line,varname,func,file)){jbl_stream_push_char(out,'\n');return this;}
	jbl_stream_push_char(out,'\n');
	++tabs;
	char * type			[]={"response","request"};
	char * charset		[]={"unknow","UTF-8"};
	char * method		[]={"unknow","get","post"};
	char * protocol		[]={"unknow","HTTP/1.1"};
	char * connection	[]={"unknow","keep alive","close","upgrade"};
	char * cache		[]={"unknow","no","max age,"};
	char * upgrade		[]={"unknow","websocket"};
	if(1)
		for(jbl_int32 j=0;j<tabs;jbl_stream_push_char(out,'\t'),++j);	jbl_stream_push_chars(out,UC"type         :");jbl_stream_push_chars(out,UC type			[jwl_http_head_is_request(this)?1:0])	;jbl_stream_push_char(out,'\n');
	if(jwl_http_head_is_response(this))
	{
		for(jbl_int32 j=0;j<tabs;jbl_stream_push_char(out,'\t'),++j);	jbl_stream_push_chars(out,UC"status       :");jbl_stream_push_uint(out,thi->status)								;jbl_stream_push_char(out,'\n');
		for(jbl_int32 j=0;j<tabs;jbl_stream_push_char(out,'\t'),++j);	jbl_stream_push_chars(out,UC"charset      :");jbl_stream_push_chars(out,UC charset		[thi->charset])			;jbl_stream_push_char(out,'\n');
	}
	if(jwl_http_head_is_request(this))
	{
		for(jbl_int32 j=0;j<tabs;jbl_stream_push_char(out,'\t'),++j);	jbl_stream_push_chars(out,UC"method       :");jbl_stream_push_chars(out,UC method		[thi->method])			;jbl_stream_push_char(out,'\n');	
		for(jbl_int32 j=0;j<tabs;jbl_stream_push_char(out,'\t'),++j);	jbl_stream_push_chars(out,UC"protocol     :");jbl_stream_push_chars(out,UC protocol		[thi->protocol])		;jbl_stream_push_char(out,'\n');	
		for(jbl_int32 j=0;j<tabs;jbl_stream_push_char(out,'\t'),++j);	jbl_stream_push_chars(out,UC"upgrade      :");jbl_stream_push_chars(out,UC upgrade		[thi->upgrade])			;jbl_stream_push_char(out,'\n');	
	}
	if(1)
	{
		for(jbl_int32 j=0;j<tabs;jbl_stream_push_char(out,'\t'),++j);	jbl_stream_push_chars(out,UC"connection   :");jbl_stream_push_chars(out,UC connection	[thi->connection])		;jbl_stream_push_char(out,'\n');	
		for(jbl_int32 j=0;j<tabs;jbl_stream_push_char(out,'\t'),++j);	jbl_stream_push_chars(out,UC"cache        :");jbl_stream_push_chars(out,UC cache		[thi->cache])			;if(thi->cache==JWL_HTTP_CACHE_MAX_AGE){jbl_stream_push_uint(out,thi->cache_max_age);}	;jbl_stream_push_char(out,'\n');	
		for(jbl_int32 j=0;j<tabs;jbl_stream_push_char(out,'\t'),++j);	jbl_stream_push_chars(out,UC"range        :");jbl_stream_push_uint(out,thi->range.start)						;jbl_stream_push_char(out,'-' );	jbl_stream_push_uint(out,thi->range.end)			;jbl_stream_push_char(out,'\n');	
		for(jbl_int32 j=0;j<tabs;jbl_stream_push_char(out,'\t'),++j);	jbl_stream_push_chars(out,UC"etag         :");jbl_stream_push_string(out,thi->etag)								;jbl_stream_push_char(out,'\n');
	}
	if(jwl_http_head_is_response(this))
	{
		for(jbl_int32 j=0;j<tabs;jbl_stream_push_char(out,'\t'),++j);	jbl_stream_push_chars(out,UC"content type :");jbl_stream_push_string(out,thi->content_type)						;jbl_stream_push_char(out,'\n');
		for(jbl_int32 j=0;j<tabs;jbl_stream_push_char(out,'\t'),++j);	jbl_stream_push_chars(out,UC"filename     :");jbl_stream_push_string(out,thi->filename)							;jbl_stream_push_char(out,'\n');
	}
	if(jwl_http_head_is_request(this))
	{
		for(jbl_int32 j=0;j<tabs;jbl_stream_push_char(out,'\t'),++j);	jbl_stream_push_chars(out,UC"url          :");jbl_stream_push_string(out,thi->url)								;jbl_stream_push_char(out,'\n');	
		for(jbl_int32 j=0;j<tabs;jbl_stream_push_char(out,'\t'),++j);	jbl_stream_push_chars(out,UC"host         :");jbl_stream_push_string(out,thi->host)								;jbl_stream_push_char(out,'\n');	
		for(jbl_int32 j=0;j<tabs;jbl_stream_push_char(out,'\t'),++j);	jbl_stream_push_chars(out,UC"user agent   :");jbl_stream_push_string(out,thi->ua)								;jbl_stream_push_char(out,'\n');	
		for(jbl_int32 j=0;j<tabs;jbl_stream_push_char(out,'\t'),++j);	jbl_stream_push_chars(out,UC"referer      :");jbl_stream_push_string(out,thi->referer)							;jbl_stream_push_char(out,'\n');
	}	
	if(thi->v)
		jbl_ht_foreach(thi->v,i)
		{
			for(jbl_int32 j=0;j<tabs;jbl_stream_push_char(out,'\t'),++j);//格式化的\t
			jbl_stream_push_string(out,i->k);
			for(jbl_int32 j=jbl_string_get_length(i->k);j<13;jbl_stream_push_char(out,' '),++j);//格式化的\t
			jbl_stream_push_char(out,':');
			if(Vis_jbl_string(i->v))jbl_stream_push_string(out,jbl_Vstring(i->v)),jbl_stream_push_char(out,'\n');	
			else					jbl_var_view_put(i->v,out,0,tabs,0,NULL,NULL,NULL);
		}
	return this;
/*
	if(format){for(jbl_int32 i=0;i<tabs;jbl_stream_push_char(out,'\t'),++i);}
	jbl_stream_push_chars(out,UC"cache        :"),jbl_stream_push_uint(out,this->cache),jbl_stream_push_char(out,'\t');
	if(this->cache==JWL_HTTP_CACHE_MAX_AGE)
		jbl_stream_push_chars(out,UC"(max-age,"),jbl_stream_push_uint(out,this->cache_max_age),jbl_stream_push_chars(out,UC")\n");
	else
		jbl_stream_push_chars(out,UC"(no-cache)\n");
	jbl_stream_push_chars(out,UC"content type :"),jbl_stream_push_string(out,this->content_type),jbl_stream_push_char(out,'\n');
*/	
}
#endif




#endif
